!> Write e_extnct.dat
!!
!! This file is needed for Gerris.
subroutine write_e_extnct(cpfad1)
   implicit none
   
   character(255), intent(in) :: cpfad1
   
   real, dimension(31)        :: eta, aw, ack, acg, acb, ah, as, al
   integer                    :: i, unit_extnct
   
   
   ! --- define values ---
   ! wavelength
   eta = (/                                                                 &
      400.0, 410.0, 420.0, 430.0, 440.0, 450.0, 460.0, 470.0, 480.0, 490.0, &
      500.0, 510.0, 520.0, 530.0, 540.0, 550.0, 560.0, 570.0, 580.0, 590.0, &
      600.0, 610.0, 620.0, 630.0, 640.0, 650.0, 660.0, 670.0, 680.0, 690.0, &
      700.0 /)

   ! water
   aw = (/                                                                                                &
      0.017100, 0.016200, 0.015300, 0.014400, 0.014500, 0.014500, 0.015600, 0.015600, 0.017600, 0.019600, &
      0.027100, 0.035332, 0.044577, 0.052120, 0.057960, 0.063800, 0.075880, 0.087960, 0.137543, 0.187125, &
      0.230824, 0.272000, 0.296500, 0.321000, 0.340170, 0.359338, 0.384915, 0.428985, 0.508593, 0.588200, &
      0.750600 /)

   ! Kieselalgen
   ack = (/                                                                                               &
      0.016259, 0.017662, 0.017785, 0.017470, 0.016986, 0.015959, 0.015067, 0.014476, 0.013497, 0.013075, &
      0.012286, 0.011330, 0.010460, 0.009436, 0.008743, 0.007753, 0.006892, 0.006297, 0.006447, 0.006527, &
      0.005655, 0.004544, 0.003709, 0.003735, 0.003914, 0.003709, 0.004779, 0.006466, 0.006188, 0.003754, &
      0.001658 /)

   ! Gr√ºnalgen
   acg = (/                                                                                               &
      0.022522, 0.024806, 0.026901, 0.028683, 0.029422, 0.025761, 0.022843, 0.022385, 0.022321, 0.021109, &
      0.017056, 0.012124, 0.008730, 0.007150, 0.006617, 0.006346, 0.006266, 0.006760, 0.007131, 0.007482, &
      0.007461, 0.008087, 0.008508, 0.008456, 0.008785, 0.011195, 0.012671, 0.017925, 0.019085, 0.011486, &
      0.004034 /)

   ! Blaualgen
   acb = (/                                                                                               &
      0.022757, 0.026183, 0.029520, 0.031340, 0.033496, 0.026530, 0.021057, 0.018799, 0.016515, 0.016304, &
      0.015190, 0.011830, 0.008882, 0.007226, 0.007130, 0.007527, 0.008424, 0.010117, 0.011737, 0.012968, &
      0.014482, 0.017201, 0.019886, 0.020040, 0.016982, 0.012478, 0.011802, 0.016136, 0.018470, 0.011029, &
      0.003540 /)

   ! humin
   ah = (/                                                                                                &
      1.796340, 1.473920, 1.197560, 0.967260, 0.783020, 0.644840, 0.506660, 0.368480, 0.368480, 0.276360, &
      0.184240, 0.138180, 0.138180, 0.092120, 0.046060, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
      0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, &
      0.000000 /)

   ! suspended matter
   as = (/                                                                                                &
      0.179000, 0.174900, 0.170800, 0.166700, 0.162600, 0.158500, 0.154400, 0.150300, 0.146200, 0.142100, &
      0.138000, 0.135608, 0.133203, 0.130800, 0.128400, 0.126000, 0.123600, 0.121200, 0.118800, 0.116400, &
      0.114577, 0.113000, 0.112000, 0.111000, 0.110000, 0.109000, 0.108013, 0.107036, 0.106018, 0.105000, &
      0.104000 /)

   ! sunlight
   al = (/                                                                                                &
      0.022380, 0.026640, 0.028140, 0.026450, 0.031410, 0.035180, 0.036260, 0.035670, 0.036650, 0.034610, &
      0.035020, 0.035580, 0.034040, 0.035260, 0.035540, 0.035540, 0.035010, 0.034480, 0.033970, 0.033470, &
      0.033310, 0.033300, 0.032900, 0.032490, 0.031690, 0.030900, 0.030540, 0.030420, 0.028570, 0.026730, &
      0.027870 /)
   
   
   
   
   ! --- write to disk ---
   open(newunit = unit_extnct, file = trim(adjustl(cpfad1)) // 'e_extnct.dat' , action = 'write')
   
   ! description
   write(unit_extnct, "(a)") "Absorptionsspektren sigma(Lambda) fuer Wasser  Kiesel-, Gruen- und &
                             &Blaualgen, Humin, suspendierter Schwebstoff, Sonnenlicht"
   ! number of datapoints
   write(unit_extnct, "(i0)") size(eta)
   
   ! data
   do i = 1, size(eta)
      write(unit_extnct, "(f0.1,*(2x,f8.6))") eta(i), aw(i), ack(i), acg(i), acb(i), ah(i), as(i), al(i)
   enddo
   
   close(unit_extnct)
   
end subroutine write_e_extnct