      Program qsim  
!                                                                       
!                                                                       
!                                                                       
!      izdt Einheiten min oder Stunden Beruecksichtigung bei itime      
!      Bei Tracerrechnung wird für die Variable tempw mit der Tracermeng
!.....testen: WEHRO2                                                    
!....es fehlt noch: Bei Fliessumkehr auch Buhnen drehen!!!              
!...Umspeichern einzelner 2D-Parameter bei Buhnesimulation              
!...2D-Modellierung bei Fliessumkehr                                    
!                                                                       
!                                                                       
      character*1 ckenn,cpoint 
      character*2 cerrts,ctest1,chcon 
      character*7 cmin,cmax 
      character*50 versio,Modell,cEreig 
      character*200 ctext 
      character*100 cpfad,cpfad1 
      character*120 cfehlr 
      integer anze,hanze(50),azstrs,anzej,Stunde 
      integer ianze(50),flag(1000),STRiz(50) 
      integer typ(100),nstrs(100),ior1(50,1000),iorLah(50,100) 
      integer ior2(50,1000),iorLeh(50,100),iorLa(100),iorle(100) 
      integer jiein(1000),anzema,ischif(1000) 
      integer typh(50,100),ieinsh(50),ieinLs(50),tdj 
      integer ischig(50,1000),ischic(1000),iWSta(20),mwetts(20) 
      integer ikanz(2) 
      integer iiorn(1000),iorn(1000),strNr(100),mstra(50) 
      integer itagw(20,10000),monatw(20,10000),jahrw(20,10000),nbuhn(50) 
      integer ISWEHR(50),io2Ws(50),iFlRi(50),ikWSta(50,20) 
      integer idWe(50,1000),isegs(50),nkzsSt(50,1000),STRID(50) 
      integer janzWt(50),janzWs(50) 
!                                                                       
      integer itagr(50,13000),monatr(50,13000),jahrr(50,13000) 
      integer itrein(50,100,100) 
!                                                                       
      real akiiv(1000),agriv(1000),abliv(1000) 
!                                                                       
      real yWlage(50,20),Wlage(50,1000) 
      real Integra,MStern,krumm 
      real ymax(50,250),Ymin(50,250),test(1000) 
      real uhrzr(50,13000),wertwe(50,13000,4) 
      real wertw(20,7,10000),uhrzw(20,10000) 
      real elen(1000),vmitt(1000),tiefe(1000),flae(1000),breite(1000) 
      real rau(1000),rhyd(1000),vabfl(1000),stind(1000),STRdt(50) 
      real vmq(50,1000),Hmq(50,1000),boeamq(50,1000),FZeit(50) 
      real segkm(50,1000) 
      real hClado(50,5,1000),bclado(50,5,1000),clado(10,1000) 
!      real CU(100,50,1000),CUz(20,50,50,1000)                          
!                                                                       
!......Prozessraten                                                     
!                                                                       
      real hsusn(50,1000),hbettN(50,1000),hdon(50,1000) 
      real hagnh4(50,1000),haknh4(50,1000),habnh4(50,1000) 
      real halNO3(50,1000),hsedx0(50,1000),hsusno(50,1000) 
      real hsedag(50,1000),hsedak(50,1000) 
      real hsedab(50,1000),halgzg(50,1000),halgzk(50,1000) 
      real halgzb(50,1000),halgdg(50,1000),halgdk(50,1000) 
      real halgdb(50,1000),halgcg(50,1000),halgck(50,1000) 
      real halgcb(50,1000),habowg(50,1000),habowk(50,1000) 
      real hvolfd(50,1000),hdrpfe(50,1000) 
      real haborg(50,1000),habork(50,1000),hdalgg(50,1000) 
      real hdalgk(50,1000),hdalgb(50,1000),hdalag(50,1000) 
      real hdalak(50,1000),hdalab(50,1000),hdgmor(50,1000) 
      real hdkmor(50,1000),hdbmor(50,1000),hsgo2n(50,1000) 
      real hsdbsb(50,1000),hsoein(50,1000),hsalgo(50,1000) 
      real hbsbt(50,1000),hdalgo(50,1000),hdalao(50,1000) 
      real hSedOM(50,1000),hw2(50,1000),hdKorn(50,1000) 
      real dkorn(50,1000) 
      real hbsbbe(50,1000),hoein1(50,1000) 
      real hro2dr(50,1000),hzoro2(50,1000),hpo2p(50,1000) 
      real hpo2r(50,1000),hiras(50,1000),hrmuas(50,1000) 
      real hrakr(50,1000),hrbar(50,1000),hkmuea(50,1000) 
      real hgmuea(50,1000),hbmuea(50,1000),hftaau(50,1000) 
      real hfiaus(50,1000),hfigau(50,1000),hfibau(50,1000) 
      real hfheau(50,1000),hfhega(50,1000),hfheba(50,1000) 
      real hakrau(50,1000),hagrau(50,1000),habrau(50,1000) 
      real hHNFmu(50,1000),hHNFre(50,1000),hHNFup(50,1000) 
      real hHNFmo(50,1000),hHNFex(50,1000),hHNFdr(50,1000) 
      real hHNFza(50,1000),hBAmua(50,1000) 
      real hidras(50,1000,2),hdrmas(50,1000,2) 
      real hdrakr(50,1000,2),hdrbar(50,1000,2) 
      real hRzuwd(50,1000,2),hdrmor(50,1000,2),hDz2D(50,1000) 
      real hschlr(50,1000) 
!                                                                       
      real fkm6n(1000),fkmn(1000) 
      real nzoo,mues,lgh,nl0(1000),pl0(1000) 
      real Q_NK(1000),Q_PK(1000),Q_SK(1000) 
      real Q_NG(1000),Q_PG(1000),Q_NB(1000),Q_PB(1000) 
      real up_NKz(50,1000),up_PKz(50,1000),up_Siz(50,1000) 
      real up_N2z(50,1000) 
      real up_NGz(50,1000),up_PGz(50,1000),up_NBz(50,1000) 
      real up_PBz(50,1000) 
      real akmuea(1000),ftaaus(1000),fiaus(1000) 
      real fheaus(1000),fhegas(1000),fhegy(1000) 
      real agmuea(1000),agmuey(1000) 
      real akraus(1000),rmuas(1000),rmuasy(1000) 
      real agreau(1000),agrey(1000),rakr(1000),rakry(1000) 
      real figaus(1000),figy(1000) 
      real rbar(1000),rbary(1000),dorgSS(1000) 
      real HNFmua(1000),BACmua(1000),HNFmuy(1000),BACmuy(1000) 
      real HNFBAy(1000) 
      real HNFrey(1000),HNFupy(1000),HNFmoy(1000),HNFexy(1000) 
      real HNFdry(1000),HNFzy(1000) 
      real HNFrea(1000),HNFupa(1000),HNFmoa(1000),HNFexa(1000) 
      real HNFdra(1000),HNFza(1000) 
      real akmuey(1000),ftay(1000),fiy(1000),fhey(1000),akry(1000) 
      real sgefpm(1000) 
      real tauscg(50,1000,50),sedhg(50,1000),tausc(1000,50) 
      real sedh(1000),dl(1000) 
      real dlalph(50,1000),dlbeta(50,1000),dlgamm(50,1000) 
      real resdr(1000),exdrvg(1000),exdrvk(1000),dlarvd(1000) 
      real dlarvR(1000) 
      real dlarvn(1000),hdlarn(50,1000),midlan(50,1000) 
      real mxdlan(50,1000),dlarny(1000),adlarn(100,20) 
      real pflmin(1000),pflmax(1000),po2p(1000),po2r(1000) 
      real zdrei(1000,4),pfl(1000),hpfl(50,1000) 
      real zdrel(1000,4),zdresl(1000,4) 
      real gewdr(1000,4),hgewdr(1000,4) 
      real gwdre(4),zdreie(4),zdrese(4) 
      real VTYP(1000,14),VALTBL(1000),EDUFBL(1000) 
      real VALTBR(1000),EDUFBR(1000) 
      real Rzuwdr(1000,4),Rzuwdy(1000,4) 
      real drpfey(1000) 
      real xdrbio(4),xdbios(4),xgewdr(4),drpfec(1000) 
      real ssdr(1000),drfaek(1000) 
      real drfaeg(1000),drfaes(1000) 
      real zdreis(1000,4),volfdr(1000),Tsed(1000) 
      real tempw(1000),glob(20),tlmax(20),tlmin(20),cloud(20) 
      real typw(20),zexki(1000),templ(1000) 
      real ro(20),wge(20),zexgr(1000),dzres1(1000),dzres2(1000) 
      real obsb(1000),vcsb(1000),vbsb(1000),bl01(1000),bl02(1000) 
      real CD(2,2000),CP(2,2000),CM(1000),BAC(1000),O2BSB(1000) 
      real ocsb(1000),vnh4(1000),vno3(1000),vno2(1000),si(1000) 
      real chla(1000),ssalg(1000),zooind(1000),gelp(1000),vco2(1000) 
      real migsP(50,1000),mxgsP(50,1000),migsN(50,1000) 
      real mxgsN(50,1000) 
      real aki(1000),agr(1000),ro2dr(1000),zooro2(1000) 
      real akitbr(1000),agrtbr(1000) 
      real miaki(50,1000),mxaki(50,1000),miagr(50,1000) 
      real mxagr(50,1000) 
      real dalggr(1000),dalgki(1000),dalgag(1000),dalgak(1000) 
      real albewg(1000),alberg(1000),albewk(1000),alberk(1000) 
      real vx0(1000),go2n(1000),vo2(1000),sgo2n(1000) 
      real vx02(1000),gesN(1000),gesP(1000) 
      real sdbsb(1000),abszo(1000),bsbt(1000),bsbct(1000) 
      real bsbctP(1000),bsbctN(1000),dlmax(1000),dlmaxs(1000) 
      real tracer(1000) 
      real svhemk(1000),svhemg(1000),DOSCF(1000),extk(1000),SiRuek(1000) 
      real svkh1(1000),sised(1000),hsised(50,1000) 
      real SKmor(1000),hSKmor(50,1000) 
      real schwi(1000),Dz2D(1000) 
!                                                                       
! MAX/MIN Hauptstrom                                                    
!                                                                       
      real mxtemp(50,1000),mitemp(50,1000),mxb5(50,1000) 
      real mib5(50,1000),mxcs(50,1000),mics(50,1000) 
      real mxnh4(50,1000),minh4(50,1000),mxchla(50,1000) 
      real michla(50,1000),mxo2(50,1000),mio2(50,1000) 
      real mizo(50,1000),mxzo(50,1000),misi(50,1000) 
      real mxsi(50,1000),mivph(50,1000),mxvph(50,1000) 
      real micoli(50,1000),mxcoli(50,1000) 
      real mica(50,1000),mxca(50,1000),mimw(50,1000) 
      real mxmw(50,1000),mivno3(50,1000),mxvno3(50,1000) 
      real migp(50,1000),mxgp(50,1000) 
      real mxvno2(50,1000),mivno2(50,1000) 
      real milf(50,1000),mxlf(50,1000) 
      real miabl(50,1000),mxabl(50,1000) 
      real miSS(50,1000),mxSS(50,1000) 
!                                                                       
! SUM Hauptstrom                                                        
!                                                                       
      real sumte(50,1000),sumb5(50,1000),sumcs(50,1000) 
      real sumn4(50,1000),sumsi(50,1000) 
      real sCD(100,2,2000),sCP(100,2,2000) 
      real sCM(50,1000),sBAC(50,1000),sCHNF(50,1000) 
      real sBVHNF(50,1000),sumcak(50,1000),sumcag(50,1000) 
      real sumcab(50,1000),summw(50,1000),sumlf(50,1000) 
      real sumca(50,1000),sumo2(50,1000),fkm(1000),sumzo(50,1000) 
      real sumss(50,1000),sumpfl(50,1000),sumbal(50,1000) 
      real sgsP(50,1000),sgsN(50,1000),scoli(50,1000) 
      real sumvph(50,1000),bbei2D(1000),salgo(1000) 
      real lboemR(1000),bsohlR(1000),flaeR(1000) 
      real tiefeR(1000),rauR(1000),vmittR(1000),vabflR(1000) 
      real tR(1000),akR(1000),agR1(1000),abR(1000) 
      real ssalR(1000),chlaR(1000),vn4R(1000),vn3R(1000) 
      real gPR(1000),siR1(1000) 
      real sedssR(1000),sedakR(1000),sedagR(1000) 
      real sedabR(1000) 
      real sumno3(50,1000),sumgp(50,1000),szooro(50,1000) 
      real sumno2(50,1000),svkigr(50,1000) 
      real santbl(50,1000),sumabl(50,1000),sabmua(50,1000) 
      real svx02(50,1000),sumaki(50,1000),sumagr(50,1000) 
      real summsl(50,1000),sumcal(50,1000),sumdln(50,1000) 
      real sidras(50,1000,2),sdrmas(50,1000,2) 
      real sdrakr(50,1000,2),sdrbar(50,1000,2) 
      real sdrmor(50,1000,2),szdrg(50,1000,2) 
      real szdrsg(50,1000,2),sgwdrg(50,1000,2) 
      real scorIg(50,1000),scoIsg(50,1000),ssedal(50,1000) 
      real ssedx0(50,1000),sdon(50,1000),sFluN3(50,1000) 
      real ssusn(50,1000),sbettn(50,1000),salgzo(50,1000) 
      real salgn(50,1000),salNO3(50,1000),ssusno(50,1000) 
      real salgdr(50,1000),salmor(50,1000),salgco(50,1000) 
      real svoldr(50,1000),sdrpfe(50,1000),sabeow(50,1000) 
      real sabeor(50,1000),sdalg(50,1000),sdalga(50,1000) 
      real sblmor(50,1000),ssgo2n(50,1000),ssdbsb(50,1000) 
      real ssoein(50,1000),ssalgo(50,1000),s2algo(50,1000) 
      real sbsbt(50,1000),sschlr(50,1000),sbsbbe(50,1000) 
      real s2algao(50,1000),so2phy(50,1000),sro2dr(50,1000) 
      real spo2p(50,1000),spo2r(50,1000),sir(50,1000) 
      real srmue(50,1000),srakr(50,1000),srbar(50,1000) 
      real sffood(50,1000),sfik(50,1000),sfig(50,1000) 
      real sfib(50,1000),sakmua(50,1000),sagmua(50,1000) 
      real sfheka(50,1000),sfhega(50,1000),sfheba(50,1000) 
      real sakrau(50,1000),sagrea(50,1000),sabrea(50,1000) 
      real sHNFmu(50,1000),sHNFre(50,1000),sHNFup(50,1000) 
      real sHNFmo(50,1000),sHNFex(50,1000),sHNFdr(50,1000) 
      REAL sHNFz(50,1000),sBACmu(50,1000),sHNFBA(50,1000) 
      real snl0(50,1000),spl0(50,1000) 
      real sJNO3(50,1000),sJNH4(50,1000),sJPO4(50,1000) 
      real sJO2(50,1000) 
!                                                                       
!                                                                       
      real CHNF(1000),HNFBAC(1000),BSBHNF(1000),drHNF(1000) 
      real BVHNF(1000),coli(1000),zHNF(1000),rO2HNF(1000) 
      real tpki(1000),tpgr(1000),snaehr(50,1000) 
      real fkm6(50,1000) 
      real einlk(100),qeinl(100),ebsb(100),ecsb(100),enh4(100) 
      real ex0(100),eo2(100),etemp(100),echla(100),ep(100) 
      real elf(100),eph(100),emw(100),eca(100),ex02(100),eno2(100) 
      real ess(100),ewaerm(100),esi(100),ezind(100),eno3(100) 
      real eCHNF(100),eBVHNF(100),egesN(100),egesP(100),ecoli(100) 
      real evkigr(100),eantbl(100),enl0(100),epl0(100) 
!                                                                       
!...Linieneinleiter                                                     
!                                                                       
      real qeinlL(100),bsbL(100),csbL(100),enh4L(100),x0L(100) 
      real x02L(100),o2L(100),etempL(100),gpL(100),siL(100) 
      real eno2L(100),eno3L(100),gesNL(100),gesPL(100),ssL(100) 
      real phL(100),elfL(100),caL(100),coliL(100),enl0L(100) 
      real pl0L(100) 
!                                                                       
      real ss(1000),vol(1000),so2ein(1000) 
      real wehrha(10,50),wehrba(10,50) 
      real wehhau(50),wehhaa(10,50) 
      real ir(1000),gwdmax(1000) 
      real sedx0(1000),don(1000),susn(1000),bettn(1000) 
      real agrnh4(1000),akinh4(1000),susno(1000) 
      real akino3(1000),agrno3(1000),iry(1000),iras(1000) 
      real sedalg(1000),sedalk(1000) 
      real algzog(1000),algzok(1000),abrzo1(1000) 
      real algdrg(1000),algdrk(1000) 
      real mw(1000),pw(1000),lf(1000),ca(1000) 
      real lfy(1000),akiy(1000),agry(1000) 
      real svx0(50,1000),lfs1,vph(1000) 
      real dgrmor(1000),dkimor(1000),dalgo(1000),dalgao(1000) 
      real bsbbet(1000),o2ein1(1000) 
      real vkigr(1000),chlagr(1000),chlaki(1000) 
      real abeowg(1000),abeorg(1000) 
      real abeowk(1000),abeork(1000) 
      real akbcm(1000),agbcm(1000),akbcmz(1000) 
      real lboem(1000),bsohlm(1000) 
      real cmatgr(1000),cmatki(1000),pfldalg(1000) 
      real drza(4) 
      real drsza(4),gwda(4) 
      real idras(1000,2),idrasy(1000,2),dreiy(1000,2),dreisy(1000,2) 
      real gwdrly(1000,2),drmas(1000,2),drmasy(1000,2) 
      real xidras(2),xdrmas(2),drakr(1000,2),drakry(1000,2) 
      real drbar(1000,2),drbary(1000,2),pfly(1000),alby(1000) 
      real coroy(1000),corosy(1000),drmor(1000,2),drmory(1000,2) 
      real xdrakr(2),xdrbar(2),xdrmor(2) 
      real ffood(1000),ffoody(1000) 
      real fssgr(1000),fbsgr(1000),frfgr(1000) 
      real sedss(1000),edhg(50,1000) 
      real r1(1000),r2(1000),r3(1000),r(1000),r6(1000) 
!Blaualgen                                                              
      real abl(1000),antbl(1000),abbcm(1000) 
      real abltbr(1000),svhemb(1000),nbiobl 
      real dalgbl(1000),dalgab(1000),sedalb(1000),algzob(1000) 
      real dblmor(1000),tpbl(1000) 
      real fibaus(1000),abmuea(1000),fhebas(1000),abreau(1000) 
      real algdrb(1000),algcob(1000),chlabl(1000),exdrvb(1000) 
      real zexbl(1000),ablnh4(1000),ablno3(1000),drfaeb(1000) 
!                                                                       
!                                                                       
!                                                                       
      real ably(1000),abln4y(1000),sedaby(1000),algzby(1000) 
      real algdby(1000),algcby(1000),dalgby(1000),dalaby(1000) 
      real dbmory(1000),abmuey(1000),fiby(1000),fheby(1000) 
      real abrey(1000),antbly(1000),tpbly(1000) 
!                                                                       
!...Buhnen                                                              
      real akmB(50,100),ekmB(50,100),DlB(50,100) 
      real tau2B(50,100),alphaB(50,100) 
!                                                                       
      real hctau1(1000),hctau2(1000),zwTsed(1000) 
      real zwtemp(1000),zwvm(1000),zwtief(1000),zwextk(1000) 
      real dift1(1000),dift2(1000) 
      real zwno3(1000),zwnh4(1000),zwgelp(1000) 
      real zwsvhk(1000),zwchla(1000),zwir(1000),zwssa(1000) 
      real zwsi(1000),zwdalk(1000),zwdaak(1000),zwsedk(1000) 
      real zwzok(1000),zwkmor(1000),zwkigr(1000),zwantb(1000) 
      real zwkbcm(1000),zwaki(1000),zwagr(1000),zwkiiv(1000) 
      real zwgriv(1000) 
      real zwsisd(1000),zwkmua(1000),zwfta(1000),zwfia(1000) 
      real zwfhea(1000),zwkrau(1000),zwbsct(1000),zwsvhb(1000) 
      real zwsvhg(1000),zwdalg(1000),zwdaag(1000),zwsedg(1000) 
      real zwzog(1000),zwgmor(1000),zwgbcm(1000) 
      real zwgmua(1000),zwfiga(1000),zwfhga(1000) 
      real zwgrau(1000),zwadrk(1000),zwadrg(1000),zwacok(1000) 
      real zwacog(1000),zwvo2(1000),zwzooi(1000),zwabsz(1000) 
      real zwdzr1(1000),zwdzr2(1000),zwzexk(1000),zwzexg(1000) 
      real zwrmue(1000),zwiras(1000),zwrakr(1000),zwrbar(1000) 
      real zwno2(1000),zwx0(1000),zwgo2n(1000),zwbsbt(1000) 
      real zwschr(1000),zwpfl(1000),zwsgon(1000),zwsdx0(1000) 
      real zwdon(1000),zwsusn(1000),zwbetn(1000),zwsuso(1000) 
      real zwagn4(1000),zwakn4(1000),zwagn3(1000) 
      real zwabn4(1000),zwabn3(1000) 
      real zwakn3(1000),zwph(1000),zwx02(1000),zwgesN(1000) 
      real zwgesP(1000),zwsedn(1000),zwexdb(1000) 
      real zwrdr(1000),zwexdk(1000),zwexdg(1000),zwzexb(1000) 
      real zwobsb(1000),zwocsb(1000),zwvbsb(1000),zwvcsb(1000) 
      real zwsbsb(1000),zwbsbe(1000),zwdfak(1000),zwdfab(1000) 
      real zwdfag(1000),zwdfas(1000),zwssdr(1000),zwCsed(1000) 
      real zwcd(2,2000),zwcp(2,2000),zwcm(1000),zwBAC(1000) 
      real zwo2bs(1000),zwHNFB(1000),zwBSBH(1000),zwHNF(1000) 
      real zwBL01(1000),zwBL02(1000),zwfbgr(1000),zwfrgr(1000) 
      real zwnl0(1000),zwpl0(1000),zwpo2p(1000) 
      real zwpo2r(1000),zwso2e(1000),zwsalo(1000),zwdalo(1000) 
      real zwdago(1000),zwo2ei(1000),zwabwg(1000),zwabwk(1000) 
      real zwabrg(1000),zwabrk(1000),zwrodr(1000),zwrzo(1000) 
      real zwrHNF(1000),zworgS(1000),zwss(1000),zwfssg(1000) 
      real zwsedS(1000),zwmw(1000),zwpw(1000),zwca(1000) 
      real zwlf(1000),zwstin(1000),zwtpki(1000),zwtpgr(1000) 
      real zwchlk(1000),zwchlg(1000),zwbsP(1000),zwbsN(1000) 
      real zwchlb(1000),zwtez(50,1000),zwo2z(50,1000) 
      real zwn4z(1000),zwn2z(1000),zwn3z(1000),zwPz(1000) 
      real zwgN4z(1000),zwkN4z(1000),zwbN4z(1000) 
      real zwbn3z(1000),zwgN3z(1000),zwkN3z(1000) 
      real zwsiz(1000),zwgPz(50,1000),zwakiz(50,1000) 
      real zwagrz(50,1000),zwablz(50,1000),zwchlz(50,1000) 
      integer zwnkzs(1000) 
      real zup_PK(1000),zup_NK(1000),zup_Si(1000) 
      real zQ_PK(1000),zQ_NK(1000),zQ_SK(1000),zaktbr(1000) 
      real zup_PG(1000),zup_NG(1000),zagtbr(1000) 
      real zQ_PG(1000),zQ_NG(1000),zwakz(1000),zwaakz(1000) 
      real zwagz(1000),zwaagz(1000),zwdalb(1000),zwdaab(1000) 
      real zwsedb(1000),zwzob(1000),zwbmor(1000),zwbbcm(1000) 
      real zwabl(1000),zwbmua(1000),zwfiba(1000),zwfhba(1000) 
      real zwbrau(1000),zwadrb(1000),zwacob(1000) 
      real zwtpbl(1000),zup_PB(1000),zup_NB(1000),zQ_PB(1000) 
      real zQ_NB(1000),zabtbr(1000),zwabz(1000),zwaabz(1000) 
      real zwCoIs(1000),zwCors(1000,5),zwcoro(1000,5) 
      real zwflae(1000),zwlboe(1000),zwSKmo(1000) 
      real zww2(1000),zwSdOM(1000),zwKorn(1000),zwFlN3(1000) 
      real zwJNO3(1000),zwJNH4(1000),zwJPO4(1000),zwJO2(1000) 
!                                                                       
!                                                                       
      real bh(50,1000),bf(50,1000),tau2(1000),vbm(50,1000) 
      real bvmq(50,1000),bHmq(50,1000),bw2(50,1000),w2b(50,1000) 
      real bSedOM(50,1000),bdKorn(50,1000),SedOMb(50,1000) 
      real dkornb(50,1000),btempw(50,1000),bTsed(50,1000) 
      real bso(50,1000),blb(50,1000),bleb(50,1000) 
      real bno3(50,1000),bnh4(50,1000),bgelp(50,1000) 
      real bsvhek(50,1000),bgesN(50,1000),bgesP(50,1000) 
      real bsvheg(50,1000),bagbcm(50,1000) 
      real bchla(50,1000),bir(50,1000),bssalg(50,1000) 
      real bsi(50,1000) 
      real bdaki(50,1000),bdaak(50,1000),bsedak(50,1000) 
      real bazok(50,1000) 
      real bdkmor(50,1000),bvkigr(50,1000) 
      real bakbcm(50,1000) 
      real baki(50,1000),bagr(50,1000) 
      real bsised(50,1000),bSKmor(50,1000) 
      real bakmua(50,1000),bftaau(50,1000),bfiaus(50,1000) 
      real bfheau(50,1000) 
      real bakrau(50,1000),bbsbt(50,1000),bschlr(50,1000) 
      real bpfl(50,1000) 
      real bbsb(50,1000),bcsb(50,1000),bbl01(50,1000) 
      real bbl02(50,1000),bo2(50,1000) 
      real bno2(50,1000),bx0(50,1000),bchlak(50,1000) 
      real bchlag(50,1000) 
      real babrz1(50,1000),bss(50,1000),bzooi(50,1000) 
      real bmw(50,1000),bpw(50,1000) 
      real bca(50,1000),blf(50,1000),bph(50,1000),bvbsb(50,1000) 
      real bvcsb(50,1000) 
      real bdlarn(50,1000),bx02(50,1000),bstind(50,1000) 
      real bdagr(50,1000),bdaag(50,1000),bsedag(50,1000) 
      real bazog(50,1000),bdgmor(50,1000),babewg(50,1000) 
      real babewk(50,1000) 
      real baberg(50,1000),baberk(50,1000),bresdr(50,1000) 
      real badrk(50,1000),badrg(50,1000),bacok(50,1000) 
      real bacog(50,1000),bacob(50,1000),badrb(50,1000) 
      real bagmua(50,1000),bfigas(50,1000),bfhgau(50,1000) 
      real bagrau(50,1000) 
      real babszo(50,1000),bzres1(50,1000),bzres2(50,1000) 
      real bzexki(50,1000),bzexgr(50,1000),brmuas(50,1000) 
      real bzexbl(50,1000),biras(50,1000) 
      real brakr(50,1000),brbar(50,1000),bfssgr(50,1000) 
      real bfbsgr(50,1000),bfrfgr(50,1000) 
      real bexdvk(50,1000),bexdvg(50,1000),bsgon(50,1000) 
      real bsedx0(50,1000),bexdvb(50,1000) 
      real bdon(50,1000),bsusn(50,1000),bbettn(50,1000) 
      real bsuso(50,1000) 
      real bagn4(50,1000),bakn4(50,1000) 
      real bagn3(50,1000),babn4(50,1000),babn3(50,1000) 
      real bakn3(50,1000),bsedn(50,1000) 
      real bBVHNF(50,1000) 
      real bsdbsb(50,1000),bbsbbe(50,1000),bdfaek(50,1000) 
      real bdfaeg(50,1000),bdfaeb(50,1000) 
      real bdfaes(50,1000),bssdr(50,1000),borgCs(50,1000) 
      real bcd(100,2,2000),bbsbct(50,1000) 
      real bbsbcP(50,1000),bbsbcN(50,1000) 
      real bcp(100,2,2000),bcm(50,1000),bBAC(50,1000) 
      real bo2bsb(50,1000),bHNFBS(50,1000),bBSBHN(50,1000) 
      real bCHNF(50,1000) 
      real bnl0(50,1000),bpl0(50,1000),bgo2n(50,1000) 
      real bpo2p(50,1000) 
      real bpo2r(50,1000),bro2dr(50,1000),bro2HF(50,1000) 
      real borgSS(50,1000),bJNO3(50,1000),bJNH4(50,1000) 
      real bJPO4(50,1000),bJO2(50,1000) 
      real bsedSS(50,1000),babbcm(50,1000) 
      real babl(50,1000),bchlab(50,1000),bantbl(50,1000) 
      real bsvheb(50,1000),btracer(1000) 
      real btpki(50,1000),btpgr(50,1000),bextk(50,1000) 
      real bQ_PK(50,1000),bQ_NK(50,1000),bQ_SK(50,1000) 
      real bQ_PG(50,1000),bQ_NG(50,1000) 
      real bQ_PB(50,1000),bQ_NB(50,1000),bFluN3(50,1000) 
      real bdabl(50,1000),bdaab(50,1000),bsedab(50,1000) 
      real bazob(50,1000),bdbmor(50,1000),babmua(50,1000) 
      real bfibas(50,1000),bfhbau(50,1000),babrau(50,1000) 
      real btpbl(50,1000),bup_PB(50,1000),bup_NB(50,1000) 
      real babtbr(50,1000),balgbz(50,1000),balabz(50,1000) 
      real bup_PK(50,1000),bup_NK(50,1000),bup_Si(50,1000) 
      real baktbr(50,1000),bup_PG(50,1000),bup_NG(50,1000) 
      real bagtbr(50,1000),balgkz(50,1000),balakz(50,1000) 
      real balggz(50,1000),balagz(50,1000) 
      real bkN4z(50,1000),bkN3z(50,1000),bgN4z(50,1000) 
      real bgN3z(50,1000),bbN4z(50,1000),bbN3z(50,1000) 
!                                                                       
      real dvhek1(1000),dvhek2(1000),dvheb1(1000),dvheb2(1000) 
      real dkbcm1(1000),dkbcm2(1000),dvheg1(1000),dgbcm1(1000) 
      real dkigr1(1000),dchlk1(1000),dchlg1(1000),dchla1(1000) 
      real daki1(1000),dagr1(1000) 
      real dvx01(1000),dvx021(1000),dvnh41(1000),dvno21(1000) 
      real dvno31(1000),dgelp1(1000) 
      real dobsb1(1000),docsb1(1000),dvbsb1(1000),dcd11(1000) 
      real dvcsb1(1000),dgesN1(1000),dgesP1(1000) 
      real dcd21(1000),dcp11(1000),dcp21(1000),dcm1(1000) 
      real dBAC1(1000),do2BS1(1000),dbl011(1000),dbl021(1000) 
      real dfbgr1(1000),dfrgr1(1000),dnl01(1000),dpl01(1000) 
      real dsi1(1000),do21(1000),dss1(1000),dssal1(1000) 
      real dfssg1(1000),dmw1(1000),dpw1(1000),dca1(1000) 
      real dlf1(1000),dvph1(1000),dstin1(1000) 
      real dQ_NK1(1000),dQ_NG1(1000),dQ_PK1(1000),dQ_PG1(1000) 
      real dQ_SK1(1000),dbbcm1(1000),dantb1(1000),dchlb1(1000) 
      real dQ_NB1(1000),dQ_PB1(1000),dabl1(1000),dSKmo1(1000) 
      real dFlN31(1000) 
!                                                                       
!                                                                       
      real dvheg2(1000),dgbcm2(1000) 
      real dkigr2(1000),dchlk2(1000),dchlg2(1000),dchla2(1000) 
      real daki2(1000),dagr2(1000),dzooi1(1000),dzooi2(1000) 
      real dvx02(1000),dvx022(1000),dvnh42(1000),dvno22(1000) 
      real dvno32(1000),dgelp2(1000),dgesN2(1000) 
      real dobsb2(1000),docsb2(1000),dvbsb2(1000),dcd12(1000) 
      real dvcsb2(1000),dfbgr2(1000),dfrgr2(1000),dgesP2(1000) 
      real dcd22(1000),dcp12(1000),dcp22(1000),dcm2(1000) 
      real dBAC2(1000),do2BS2(1000),dbl012(1000),dbl022(1000) 
      real dnl02(1000),dpl02(1000),dsi2(1000),do22(1000) 
      real dss2(1000),dssal2(1000),dfssg2(1000) 
      real dmw2(1000),dpw2(1000),dca2(1000),dlf2(1000) 
      real dvph2(1000),dstin2(1000) 
      real dQ_NK2(1000),dQ_NG2(1000),dQ_PK2(1000),dQ_PG2(1000) 
      real dQ_SK2(1000),dbbcm2(1000),dantb2(1000),dchlb2(1000) 
      real dQ_NB2(1000),dQ_PB2(1000),dabl2(1000),dSKmo2(1000) 
      real dFlN32(1000) 
!                                                                       
!  ...Y Buhnen                                                          
      real btempy(1000),bno3y(1000),bnh4y(1000),bgelpy(1000) 
      real bchlay(1000),bssaly(1000),bsiy(1000),bakiy(1000) 
      real bagry(1000),bno2y(1000),bvbsby(1000),bvcsby(1000) 
      real bo2y(1000),bphy(1000),bcay(1000),bmwy(1000),blfy(1000) 
      real bably(1000),bnl0y(1000),bpl0y(1000) 
      real bOBSBy(1000),bgsPy(1000),bgsNy(1000) 
      real bCDy(2,2000),bCPy(2,2000),bCMy(1000),bBACy(1000) 
      real bchlky(1000),bchlgy(1000) 
!                                                                       
      real bdakiy(1000),bdaaky(1000),bsedky(1000) 
      real bazoky(1000),bkmory(1000),bkigry(1000) 
      real bkbcmy(1000),biry(1000),bkiivy(1000),bsisdy(1000) 
!                                                                       
      real bkmuay(1000),bftkay(1000),bfikay(1000),bfhkay(1000) 
      real bkray(1000),btpkiy(1000),btpgry(1000),btpbly(1000) 
      real bdagry(1000),bdaagy(1000),bsedgy(1000),bazogy(1000) 
      real bgmory(1000),badrky(1000),badrgy(1000),bacoky(1000) 
      real bacogy(1000),bgmuay(1000),bfigay(1000),bfhgay(1000) 
      real bgray(1000),bzooiy(1000),bbl01y(1000),bbl02y(1000) 
      real bfibay(1000),bantby(1000),bextky(1000) 
      real bdably(1000),bdaaby(1000),bsedby(1000),bazoby(1000) 
      real bbmory(1000),badrby(1000),bacoby(1000),bbmuay(1000) 
      real bfhbay(1000),bbray(1000),bchlby(1000),bFlN3y(1000) 
      real bbetNy(1000),bJNO3y(1000),bJNH4y(1000),bJPO4y(1000) 
      real bJO2y(1000) 
                                                                        
!                                                                       
!                                                                       
!   SUM Buhnen                                                          
!                                                                       
      real bste(50,1000),bsno3(50,1000),bsn4(50,1000) 
      real bsgelp(50,1000),bsno2(50,1000),bschla(50,1000) 
      real bsssal(50,1000),bssi(50,1000),bszooi(50,1000) 
      real bsvbsb(50,1000),bsvcsb(50,1000),bsgsP(50,1000) 
      real bsgsN(50,1000),bsaki(50,1000),bsagr(50,1000) 
      real bsabl(50,1000),bsFlN3(50,1000) 
      real bso2(50,1000),bsmw(50,1000),bslf(50,1000) 
      real bsca(50,1000),bsph(50,1000),bsnl0(50,1000) 
      real bspl0(50,1000),bsdalg(50,1000),bsvkg(50,1000) 
      real bsdaa(50,1000),bsseda(50,1000),bsalgz(50,1000) 
      real bsamor(50,1000),bsadr(50,1000),bsalco(50,1000) 
      real bsfik(50,1000),bsfig(50,1000),bskmue(50,1000) 
      real bsgmue(50,1000),bshek(50,1000),bsheg(50,1000) 
      real bskre(50,1000),bsgre(50,1000),bschlk(50,1000) 
      real bschlg(50,1000),bsbmue(50,1000),bsheb(50,1000) 
      real bsbre(50,1000),bschlb(50,1000),bsantb(50,1000) 
      real bsbetN(50,1000),bsJNO3(50,1000),bsJNH4(50,1000) 
      real bsJPO4(50,1000),bsJO2(50,1000) 
!..min/max                                                              
!                                                                       
      real bmxtem(50,1000),bmitem(50,1000),bmxno3(50,1000) 
      real bmino3(50,1000),bmxnh4(50,1000),bminh4(50,1000) 
      real bmxglp(50,1000),bmiglp(50,1000),bmxchl(50,1000) 
      real bmichl(50,1000),bmxssa(50,1000),bmissa(50,1000) 
      real bmxsi(50,1000),bmisi(50,1000),bmxzoo(50,1000) 
      real bmizoo(50,1000),bmxno2(50,1000),bmino2(50,1000) 
      real bmibsb(50,1000),bmxbsb(50,1000),bmicsb(50,1000) 
      real bmxcsb(50,1000),bmxgsP(50,1000),bmigsP(50,1000) 
      real bmxgsN(50,1000),bmigsN(50,1000),bmxaki(50,1000) 
      real bmiaki(50,1000),bmxagr(50,1000),bmiagr(50,1000) 
      real bmio2(50,1000),bmxo2(50,1000),bmxmw(50,1000) 
      real bmimw(50,1000),bmxlf(50,1000),bmilf(50,1000) 
      real bmxca(50,1000),bmica(50,1000),bmxph(50,1000) 
      real bmiph(50,1000),bnaehr(50,1000) 
!                                                                       
!................................................................       
!     coroph                                                            
      real coro(1000,5),coros(1000,5),coroI(1000),coroIs(1000) 
      real corol(1000),corosl(1000) 
      real hcoro(1000,5),hcoros(1000,5),coro2(1000,5),coros2(1000,5) 
      real volfco(1000),algcok(1000),algcog(1000),algcky(1000) 
      real algcgy(1000) 
!                                                                       
!                                                                       
!     Eingabegenerator                                                  
      real wstand(20,50,27),astand(24) 
!                                                                       
      real hfkm(50,1000),hqaus(50,1000),hsvhk(50,1000) 
      real hsvhg(50,1000),hDOSCF(50,1000) 
      real hsvhb(50,1000),habbcm(50,1000) 
      real habl(50,1000),hchlab(50,1000),hantbl(50,1000) 
      real htempw(50,1000),hTsed(50,1000) 
      real hbsb(50,1000),hcsb(50,1000),hbl01(50,1000) 
      real hbl02(50,1000),hnh4(50,1000) 
      real hCD(50,2,1000),hCP(50,2,1000),hCM(50,1000) 
      real hBAC(50,1000),hO2BSB(50,1000),ho2_z(50) 
      real hte_z(50) 
      real ho2(50,1000),hno3(50,1000),hno2(50,1000) 
      real hx0(50,1000),hsi(50,1000),hx02(50,1000) 
      real hcoli(50,1000) 
      real hchla(50,1000),hchlak(50,1000),hchlag(50,1000) 
      real hvkigr(50,1000),htpki(50,1000),htpgr(50,1000) 
      real htpbl(50,1000) 
      real habrz1(50,1000),hssalg(50,1000),hss(50,1000) 
      real hzooi(50,1000) 
      real hgelp(50,1000),hmw(50,1000),hpw(50,1000) 
      real hca(50,1000),hlf(50,1000),hph_z(50) 
      real hph(50,1000),hvbsb(50,1000),hvcsb(50,1000) 
      real hstind(50,1000),haki(50,1000),hagr(50,1000) 
      real hakbcm(50,1000),hagbcm(50,1000) 
      real hdrei(1000,4),hdreis(1000,4) 
      real hCHNF(50,1000),hBVHNF(50,1000),hHNFBA(50,1000) 
      real hfssgr(50,1000),hfbsgr(50,1000),hnl0(50,1000) 
      real hQ_NK(50,1000),hQ_PK(50,1000),hQ_SK(50,1000) 
      real hQ_NG(50,1000),hQ_PG(50,1000),hQ_NB(50,1000) 
      real hQ_PB(50,1000) 
      real hpl0(50,1000),hfrfgr(50,1000),hffood(50,1000) 
      real hdl(50,1000),htau2(50,1000) 
      real hgesP(50,1000),hgesN(50,1000),hCD1(50,1000) 
      real hCD2(50,1000),hCP1(50,1000),hCP2(50,1000) 
      real hvo2(50,1000),hextk(50,1000) 
      real hJNO3(50,1000),hJNH4(50,1000),hJPO4(50,1000) 
      real hJO2(50,1000),hFluN3(50,1000) 
!                                                                       
      real abegm2(1000),abekm2(1000) 
!                                                                       
      real irmaxe,nbiogr 
!                                                                       
! strang                                                                
      integer mPfs(50),mSs(50),mDs(50),mCs(50),mBs(50) 
      integer mUs(50),i2Ds(50),mWes(50),mVs(50) 
      integer SCHRNR,ESTRNR(100,100) 
      integer istund(50,100) 
!                                                                       
      integer itsts(50),msts(50),itmaxs(50),mmaxs(50) 
      integer itends(50),mends(50),zabfr 
      integer laits(50),laims(50),laids(50) 
      integer RBNR,RBtyp(50,100),mStas(50),mWO2(100) 
      integer Weinl1(50,100) 
      integer Weinl(50,100),abfr(50),mwehr(50) 
      integer mRBs(50),NRSchr(50,100) 
      integer itagl(5000),monatl(5000) 
      integer hflag(50,1000),hjiein(50,1000) 
      integer hischf(50,1000) 
      real uhrl(5000),werts(30,5000) 
      real apfl(50,20),epfl(50,20),pflmxs(50,20),pflmis(50,20) 
      real aschif(50,20),eschif(50,20),awett(50,20),ewett(50,20) 
      real abal(50,20),ebal(50,20),ggbal(50,20),gkbal(50,20) 
      real akdrei(50,20),ekdrei(50,20),zdrs(50,20,4) 
      real zdrss(50,20,4),gwdrs(50,20,4) 
      real acoro(50,20),ecoro(50,20),coro1s(50,20) 
      real coross(50,20) 
      real aVEG(50,20),eVEG(50,20),VTYPA(50,20,18),VALTAL(50,20) 
      real EDUFAL(50,20),VALTAR(50,20),EDUFAR(50,20) 
      real SedOM(50,1000),w2(50,1000),Stakmz(1000) 
      real Stakm(50,1000),Raua(50,1000),bsohla(50,1000) 
      real hlboea(50,1000),hflaea(50,1000),htiefa(50,1000) 
      real hvF(50,1000),hWS(50,1000),wehrts(50) 
      real wehrh(50),wehrb(50),startkm(100),endkm(100),RBkm(50,100) 
      real RBkmLe(50,100),RBkm1(50,100),WirkLL(50,100) 
!                                                                       
      real abfls(50,100),obsbs(50,100),ocsbs(50,100) 
      real vnh4s(50,100),vno2s(50,100),vno3s(50,100) 
      real gesNs(50,100),vx0s(50,100),vx02s(50,100) 
      real gelps(50,100),gesPs(50,100),sis(50,100) 
      real chlas(50,100),vkigrs(50,100),antbls(50,100) 
      real zooins(50,100),vphs(50,100),mws(50,100),pws(50,100) 
      real cas(50,100),lfs(50,100),ssalgs(50,100) 
      real tempws(50,100),vo2s(50,100),CHNFs(50,100) 
      real BVHNFs(50,100),colis(50,100),waers(50,100) 
      real akis(50,100),agrs(50,100),abls(50,100) 
      real agbcms(50,100),akbcms(50,100),abbcms(50,100) 
      real CD1s(50,100),CD2s(50,100) 
      real CP1s(50,100),CP2s(50,100),CMS(50,100),BACs(50,100) 
      real O2bsbs(50,100),Bl01s(50,100),BL02s(50,100) 
      real nl0s(50,100),pl0s(50,100),sss(50,100),Chlaks(50,100) 
      real chlabs(50,100),chlags(50,100),vbsbs(50,100),vcsbs(50,100) 
      real Q_NKs(50,100),Q_PKs(50,100),Q_SKs(50,100) 
      real Q_NGs(50,100),Q_PGs(50,100),Q_NBs(50,100),Q_PBs(50,100) 
!                                                                       
      real helen(50,1000),hvmitt(50,1000) 
      real htiefe(50,1000),hrau(50,1000),hrhyd(50,1000) 
      real hflae(50,1000),hpfmnl(50,1000) 
      real hpfmxl(50,1000),hzdrel(50,1000,4),hzdrsl(50,1000,4) 
      real hgwdrl(50,1000,4),habgml(50,1000),habkml(50,1000) 
      real hlboem(50,1000),hbsohl(50,1000),hvabfl(50,1000) 
      real hcoro2(50,1000,5),hcos2(50,1000,5) 
      real VTYPH(50,1000,14),VALTLH(50,1000),EDUFLH(50,1000) 
      real VALTRH(50,1000),EDUFRH(50,1000) 
!                                                                       
!.......................................                                
!                                                                       
      real einlkh(50,100),qeinlh(50,100),ebsbh(50,100) 
      real ecsbh(50,100),enh4h(50,100) 
      real ex0h(50,100),eo2h(50,100),etemph(50,100) 
      real echlah(50,100),ezindh(50,100) 
      real egph(50,100),esih(50,100),eno3h(50,100) 
      real essh(50,100),ewaerh(50,100),enl0h(50,100),epl0h(50,100) 
      real ephh(50,100),emwh(50,100),elfh(50,100),ecah(50,100) 
      real ex02h(50,100),eno2h(50,100),eCHNFh(50,100) 
      real eBVHNh(50,100),egesNh(50,100),egesPh(50,100) 
      real ecolih(50,100),evkgh(50,100),eantbh(50,100) 
!                                                                       
!....Linieneinleitung                                                   
!                                                                       
      real qLh(50,100),bsbLh(50,100),csbLh(50,100),enh4Lh(50,100) 
      real eno2Lh(50,100),eno3Lh(50,100),gesNLh(50,100) 
      real x0Lh(50,100),x02Lh(50,100),gpLh(50,100),gesPLh(50,100) 
      real siLh(50,100),phLh(50,100),caLh(50,100),elfLh(50,100) 
      real ssLh(50,100),tempLh(50,100),o2Lh(50,100),coliLh(50,100) 
      real enl0Lh(50,100),pl0Lh(50,100) 
!                                                                       
      real tempwy(1000),vbsby(1000),vcsby(1000),vnh4y(1000) 
      real vo2y(1000),vno3y(1000),vno2y(1000),vx0y(1000),siy(1000) 
      real tiefey(1000),vx02y(1000) 
      real chlay(1000),chlaky(1000),chlagy(1000),chlaby(1000) 
      real ssalgy(1000),zooiny(1000),gelpy(1000),coliy(1000) 
      real mwy(1000),cay(1000),vphy(1000),tpkiy(1000),tpgry(1000) 
      real vkigry(1000),bl01y(1000),bl02y(1000),CDy(2,2000),CPy(2,2000) 
      real CMy(1000),BACy(1000),CHNFy(1000),BVHNFy(1000),dly(1000) 
      real tau2y(1000),O2BSBy(1000),gsPy(1000),gsNy(1000) 
      real sedn(1000),orgCsd(1000) 
!                                                                       
!  Y-Hauptstrom                                                         
      real susny(1000),bettny(1000),dony(1000),agrn4y(1000) 
      real akin4y(1000),FluN3y(1000),sedx0y(1000),susnoy(1000) 
      real sedagy(1000),sedaky(1000),algzgy(1000),alNO3y(1000) 
      real algzky(1000),algdgy(1000),algdky(1000),volfdy(1000) 
      real abowgy(1000),abowky(1000),aborgy(1000),aborky(1000) 
      real dalggy(1000),dalgky(1000),dalagy(1000),dalaky(1000) 
      real dgmory(1000),dkmory(1000),sgo2ny(1000),sdbsby(1000) 
      real so2eiy(1000),salgoy(1000),bsbty(1000),dalgoy(1000) 
      real dalaoy(1000),schlry(1000),bsbbey(1000),o2ei1y(1000) 
      real ro2dry(1000),zoro2y(1000),po2py(1000),po2ry(1000) 
      real nl0y(1000),pl0y(1000),extky(1000),JNO3y(1000) 
      real JNH4y(1000),JPO4y(1000),JO2y(1000) 
      real Q_NKy(1000),Q_PKy(1000),Q_SKy(1000) 
      real Q_NGy(1000),Q_PGy(1000),Q_NBy(1000),Q_PBy(1000) 
      real sedhy(50,1000) 
!                                                                       
      real dfkma(1000),dfkme(1000) 
!                                                                       
!....Gitter fuer ortsfeste Organismen                                   
!                                                                       
      real hdlmx(50,1000),hdlmxs(50,1000),hgwdmx(50,1000) 
      real sgwmue(1000),hsgwmu(50,1000) 
!                                                                       
!                                                                       
!   2D-Modellierung                                                     
!                                                                       
      integer nkzs(1000),nkzsy(1000),hnkzs(50,1000) 
      integer nkzmx(50,1000),hnkzsz(1000) 
      integer znkzs(50,1000),inkzs(50,2) 
      real afkm2D(100,100),efkm2D(100,100) 
      real akm2Dz(100),ekm2Dz(100) 
      real tempwz(50,1000),htempz(50,50,1000),tempzy(50,1000) 
      real vnh4zy(50,1000),vno2zy(50,1000),vno3zy(50,1000) 
      real vo2zy(50,1000),gelPzy(50,1000),sizy(50,1000) 
      real akizy(50,1000),agrzy(50,1000),ablzy(50,1000) 
      real chlazy(50,1000) 
      real dtemp(50,1000),dH2De(1000),hdH2De(50,1000),H2DeSt(50,1000) 
      real Hmax2D(50,1000),hdh2ez(1000),FluxT1(1000) 
      real vnh4z(50,1000),vno2z(50,1000),vno3z(50,1000),Dz(50,1000) 
      real vo2z(50,1000),gelPz(50,1000),siz(50,1000),ho2z_z(50,50) 
      real htez_z(50,50) 
      real hnh4z(50,50,1000),hno2z(50,50,1000),hno3z(50,50,1000) 
      real ho2z(50,50,1000),hgelPz(50,50,1000),hsiz(50,50,1000) 
      real vz1(50,1000),saett(1000) 
      real akiz(50,1000),agrz(50,1000),ablz(50,1000),chlaz(50,1000) 
      real hakiz(50,50,1000),hagrz(50,50,1000),hablz(50,50,1000) 
      real hchlaz(50,50,1000) 
      real Tzt(50,50,2),o2zt(50,50,2),NH4zt(50,50,2) 
      real NO2zt(50,50,2),NO3zt(50,50,2),Pzt(50,50,2),gSizt(50,50,2) 
      real akizt(50,50,2),agrzt(50,50,2),ablzt(50,50,2),chlazt(50,50,2) 
      real hcs67(50),hcs68(50),hcs69(50),hcs70(50),hcs71(50) 
      real hcs72(50),hcs73(50),hcs74(50),hcs75(50),hcs76(50),hcs84(50) 
      real agrbrz(50,1000),akibrz(50,1000),ablbrz(50,1000) 
      real algakz(50,1000),algagz(50,1000),algabz(50,1000) 
      real algzkz(50,1000),algzgz(50,1000),algzbz(50,1000) 
      real Uvert(50,1000) 
!                                                                       
!                                                                       
      real xt(50) 
      real xn4t(50),xno2t(50),xno3t(50),xo2t(50),xgelPt(50) 
      real xSit(50) 
!                                                                       
      real susO2N(1000) 
      real dalgkz(50,1000),dalgbz(50,1000),dalggz(50,1000) 
      real akNH4z(50,1000),abNH4z(50,1000),agNH4z(50,1000) 
      real akNO3z(50,1000),abNO3z(50,1000),agNO3z(50,1000) 
!                                                                       
      real fakTe(50),fakO(50),fakN4(50),fakN2(50) 
      real fakN3(50),fakP(50),fakSi(50) 
      real deln4(1000),deln2(1000),deln3(1000),delT(1000) 
      real delO(1000),delP(1000),delSi(1000) 
!                                                                       
!     **Ke-Werte**                                                      
      real KsD1e,KsD2e,KsMe,IKge,IKke,IKbe,KapN3e,KNH4e 
!                                                                       
!.....Schalter für "Regeln bei Kraftwerksbetrieb"                       
!               iRHKW = 1 > Betrieb der HKW's unterliegt gewissen Regeln
      iRHKW = 0 
!                                                                       
!...Dicke der vertikalen Schichten                                      
!                                                                       
      iwied = 0 
      ilang = 0 
      ilbuhn = 0 
      jlauf = 0 
      jtag = 0 
      dH2D = 0.25 
!                                                                       
!......Vorbelegungen                                                    
      n1 = 1 
      n2 = 2 
      iergeb = 0 
      Versio = 'QSim-Version  12.41' 
!                                                                       
!...Setzen der Ymax/Ymin-Werte zur grafischen Darstellung unter Gerris  
      do 290 j = 1,50 
      do 390 jj = 1,250 
      Ymax(j,jj) = 0.0 
      Ymin(j,jj) = 999999.99 
  390 continue 
  290 continue 
      cmin = 'Minimum' 
      cmax = 'Maximum' 
      cpoint ='.' 
!                                                                       
!                                                                       
!                                                                       
      call GETARG(n1,cpfad) 
      call GETARG(n2,cpfad1) 
      if(cpfad1.eq.' ')cpfad1 = cpfad 
!                                                                       
!      open(unit=222, DEFAULTFILE='D:\gerris\Qsim', file='pfad.txt')    
!      rewind (222)                                                     
!      read(222,'(100a)')cpfad                                          
!                                                                       
      ifhStr = 0 
      fhProf = 0.0 
      cerrts = 'OK' 
      open(unit=199, DEFAULTFILE=cpfad, file='file1.err') 
      rewind (199) 
      write(199,'(a2)')cerrts 
      rewind (199) 
!                                                                       
!...Ausgabe von Bemerkungen                                             
      open(unit=299, DEFAULTFILE=cpfad, file='file2.err') 
      rewind (299) 
!                                                                       
      open(unit=89,DEFAULTFILE=cpfad, file='qsim.tst') 
!                                                                       
      if(iRHKW.eq.1)                                                    &
     &open(unit=177,DEFAULTFILE=cpfad, file='Red_HKW.txt')              
!                                                                       
      iMAC = 1 
!                                                                       
!.....nndr : Anzahl der Kohorten                                        
      nndr = 2 
!                                                                       
!                                                                       
!.....Einlesen aus ModellA                                              
      open(unit=10, DEFAULTFILE=cpfad, file='MODELLA.txt') 
      rewind (10) 
      jStr = 0 
      read(10,'(a2)')chcon 
      read(10,'(f5.2,2x,f5.2)')GeoB,GeoL 
      read(10,'(I5)')azStrs 
      do 385 azStr = 1,azStrs 
      ieinL = 0 
      read(10,'(I5,2x,I5,2x,I5,2x,I5,2x,I5)')                           &
     &mstr,mStas(mstr),mRBs(mstr),mwehr(mstr),STRID(mstr)               
      mstra(azStr) = mstr 
      do 382 mSta = 1,mStas(mstr) 
      read(10,1001)Stakm(mstr,mSta),Raua(mstr,mSta)                     &
     &,bsohla(mstr,mSta),boeamq(mstr,mSta),vmq(mstr,mSta)               &
     &,Hmq(mstr,mSta),bvmq(mstr,mSta),bHmq(mstr,mSta)                   
  382 continue 
!                                                                       
      if(mwehr(mstr).eq.0)goto 383 
      read(10,1002)wehrh(mstr),wehrb(mstr) 
      wehrts(mstr) = wehrh(mstr) 
!                                                                       
  383 startkm(mstr) = Stakm(mstr,1) 
      endkm(mstr) = Stakm(mstr,mStas(mstr)) 
      do 384 mRB = 1,mRBs(mstr) 
      read(10,1003)RBNR,RBkm(mstr,mRB),RBtyp(mstr,mRB)                  &
     &,Weinl(mstr,mRB),mstrLe,RBkmLe(mstr,mRB)                          
      if(mRB.eq.1.and.RBkm(mstr,mRB).eq.Stakm(mstr,1).and.               &
     &RBkmLe(mstr,mRB).lt.0.0)then                                     
        RBtyp(mstr,mRB) = 0 
      endif 
!                                                                       
!......Bestimmung der Wirklänge der Diffusen Einleitung                 
!                                                                       
      if(mstrLe.lt.0)goto 384 
      ieinL = ieinL+1 
      WirkLL(mstr,ieinL) = abs(RBkm(mstr,mRB)-RBkmLe(mstr,mRB))         &
     &*1000.                                                            
!                                                                       
  384 continue 
      if(startkm(mstr).gt.endkm(mstr))abfr(mstr) = 0 
      if(startkm(mstr).lt.endkm(mstr))abfr(mstr) = 1 
      if(abfr(mstr).eq.0)goto 385 
!                                                                       
!Umdrehen der Zuflüsse bei abfr = 1 (kann vielleicht wieder gelöscht wer
!      jRBe = 1                                                         
!      if(RBtyp(mstr,1).eq.0)jRBe = 2                                   
!      jRB = jRBe                                                       
!      do 387 mRB = mRBs(mstr),jRBe,-1                                  
!      RBkm1(mstr,jRB) = RBkm(mstr,mRB)                                 
!      RBtyp1(mstr,jRB) = RBtyp(mstr,mRB)                               
!      Weinl1(mstr,jRB) = Weinl(mstr,mRB)                               
!      jRB = jRB+1                                                      
!  387 continue                                                         
!      do 388 mRB = 1,mRBs(mstr)                                        
!      RBkm(mstr,mRB) = RBkm1(mstr,mRB)                                 
!      RBtyp(mstr,mRB) = RBtyp1(mstr,mRB)                               
!      Weinl(mstr,mRB) = Weinl1(mstr,mRB)                               
!  388 continue                                                         
!                                                                       
!                                                                       
  385 continue 
!                                                                       
 1001 format(f8.3,2x,f5.2,2x,f7.2,2x,f6.2,2x,f8.5,2x,f7.4               &
     &,2x,f8.5,2x,f7.4)                                                 
 1002 format(f7.2,2x,f7.2) 
 1003 format(I5,2x,f8.3,2x,i1,2x,i1,2x,I5,2x,F8.3) 
!.................................                                      
  381 continue 
      close (10) 
!                                                                       
!                                                                       
!...Ermittlung der Berechnungsgitterpunkte                              
                                                                        
      call km_sys(azStrs,mstra,StaKm,RBkm,RBkmLe,RBtyp,mRBs             &
     &,mWehr,mStas,ior1,ior2,iorLah,iorLeh,abfr,cpfad)                  
!                                                                       
      open(unit=391, DEFAULTFILE=cpfad, file='km_sys.dat') 
      rewind (391) 
      do 611 azStr = 1,azStrs 
      mstr = mstra(azStr) 
      read(391,'(I5,2x,I5)')mstr,isegs(mstr) 
      do 612 iseg = 1,isegs(mstr) 
      read(391,'(f9.4,2x,i1)')segkm(mstr,iseg),hflag(mstr,iseg) 
  612 continue 
  611 continue 
      close (391) 
!                                                                       
!.....Einlesen aus EREIGG                                               
      open(unit=92, DEFAULTFILE=cpfad, file='EREIGG.txt') 
      rewind (92) 
!                                                                       
      read(92,'(a50)')modell 
      read(92,'(a50)')cEreig 
      read(92,9200)itags,monats,jahrs,uhrs 
      read(92,9210)itage,monate,jahre,uhren,izdt 
      read(92,9220)imitt,ipH,idl,itemp,itracer,ieros                    &
     &,ischwa                                                           
      if(itemp.eq.0.and.itracer.eq.0)iwsim = 3 
      if(itemp.eq.1)iwsim = 2 
      if(itracer.eq.1)iwsim = 4 
!                                                                       
      uhren = int(uhren)+((uhren-int(uhren))/0.6) 
!                                                                       
      close (92) 
!                                                                       
 9200 Format(I2,2x,I2,2x,I4,2x,f5.2) 
 9210 format(I2,2x,I2,2x,I4,2x,f5.2,2x,I3) 
 9220 format(I1,2x,I1,2x,I1,2x,I1,2x,I1,2x,i1,2x,I1) 
!                                                                       
!                                                                       
      if(iwsim.eq.2.or.iwsim.eq.4)goto 329 
!                                                                       
!    Einlesen der Konstanten                                            
!                                                                       
!....APARAM.txt                                                         
      open(unit=55, DEFAULTFILE=cpfad, file='APARAM.txt') 
                                                                        
                                                                        
      read(55,5500,err=198)agchl,aggmax,IKge,agksn,agksp 
      read(55,5502,err=198)agremi,frmuge,bsbgr,csbgr,Qmx_NG 
      read(55,5504,err=198)Qmx_PG,Qmn_NG,Qmn_PG,upmxNG,upmxPG 
      read(55,5506,err=198)opgrmi,opgrma,asgre,akchl,akgmax 
      read(55,5508,err=198)IKke,akksn,akksp,akkssi,akremi 
      read(55,5510,err=198)frmuke,bsbki,csbki,Qmx_NK,Qmx_PK 
      read(55,5512,err=198)Qmx_SK,Qmn_NK,Qmn_PK,Qmn_SK,upmxNK 
      read(55,5514,err=198)upmxPK,upmxSK,opkimi,opkima,askie 
      read(55,5516,err=198)abchl,abgmax,IKbe,abksn,abksp 
      read(55,5518,err=198)abremi,frmube,bsbbl,csbbl,Qmx_NB 
      read(55,5520,err=198)Qmx_PB,Qmn_NB,Qmn_PB,upmxNB,upmxPB 
      read(55,5522,err=198)opblmi,opblma,asble,irmaxe,FopIRe 
      read(55,5524,err=198)GRote,zresge,zakie,zagre,zable 
      read(55,5526,err=198)ynmx1e,stks1e,anitrie,bnmx1e,bnks1e 
      read(55,5530,err=198)ynmx2e,stks2e,anitrie,bnmx2e,bnks2e 
      read(55,5528,err=198)KNH4e,KapN3e,hyPe,hymxDe,KsD1e 
      read(55,5533,err=198)KsD2e,KsMe,upBACe,YBACe,rsGBACe 
      read(55,5535,err=198)FoptDe,upHNFe,BACkse,alamda 
!                                                                       
      close (55) 
      if(IKge.lt.0.0.or.IKke.lt.0.0.or.KNH4e.lt.0.0.or.                  &
     &  KapN3e.lt.0.0.or.hyPe.lt.0.0)then                                
         ifehl = 3 
         goto 989 
         endif 
      goto 197 
!....Fehlermeldung falls APARAM.txt fehlt oder unvollstaendig           
  198 continue 
      ifehl = 3 
      goto 989 
!                                                                       
  197 continue 
!  197 if(Qmn_PK.eq.Qmx_PK)Qmn_PK = Qmn_PK-Qmn_PK*0.000001              
!      if(Qmn_NK.eq.Qmx_NK)Qmn_NK = Qmn_NK-Qmn_NK*0.000001              
!      if(Qmn_SK.eq.Qmx_SK)Qmn_SK = Qmn_SK-Qmn_SK*0.000001              
!      if(Qmn_PG.eq.Qmx_PG)Qmn_PG = Qmn_PG-Qmn_PG*0.000001              
!      if(Qmn_NG.eq.Qmx_NG)Qmn_NG = Qmn_NG-Qmn_NG*0.000001              
!      if(Qmn_PB.eq.Qmx_PB)Qmn_PB = Qmn_PB-Qmn_PB*0.000001              
!      if(Qmn_NB.eq.Qmx_NB)Qmn_NB = Qmn_NB-Qmn_NB*0.000001              
!                                                                       
      nZoo = 0.09 
      pZoo = 0.01 
!                                                                       
!.....Umrechnung der maximalen Wachstumsraten bei 25°C auf optimalTemper
!                                                                       
!      aggmax = aggmax*1.13                                             
!      akgmax = akgmax*1.31                                             
!      abgmax = abgmax*1.01                                             
!                                                                       
 5500 format(f4.1,2x,f5.2,2x,f6.2,2x,f5.3,2x,f6.4) 
 5502 format(f5.3,2x,f5.2,2x,f6.4,2x,f6.4,2x,f7.5) 
 5504 format(f7.5,2x,f7.5,2x,f7.5,2x,f5.3,2x,f5.3) 
 5506 format(f4.2,2x,f4.2,2x,f5.2,2x,f4.1,2x,f5.2) 
 5508 format(f6.2,2x,f5.3,2x,f6.4,2x,f5.3,2x,f5.3) 
 5510 format(f5.2,2x,f6.4,2x,f6.4,2x,f7.5,2x,f7.5) 
 5512 format(f7.5,2x,f7.5,2x,f7.5,2x,f7.5,2x,f5.3) 
 5514 format(f5.3,2x,f5.3,2x,f4.2,2x,f4.2,2x,f5.2) 
 5516 format(f4.1,2x,f5.2,2x,f6.2,2x,f5.3,2x,f6.4) 
 5518 format(f5.3,2x,f5.2,2x,f6.4,2x,f6.4,2x,f7.5) 
 5520 format(f7.5,2x,f7.5,2x,f7.5,2x,f5.3,2x,f5.3) 
 5522 format(f4.2,2x,f4.2,2x,f5.2,2x,f5.2,2x,f5.2) 
 5524 format(f5.2,2x,f5.3,2x,f5.2,2x,f5.2,2x,f5.2) 
 5526 format(f4.2,2x,f5.2,2x,f4.2,2x,f5.2,2x,f5.2) 
 5530 format(f4.2,2x,f5.2,2x,f4.2,2x,f5.2,2x,f5.2) 
 5528 format(f5.2,2x,f5.2,2x,f6.3,2x,f6.3,2x,f6.3) 
 5533 format(f6.3,2x,f6.3,2x,f6.3,2x,f6.3,2x,f6.3) 
 5535 format(f5.2,2x,f5.2,2x,f6.4,2x,f5.3) 
!                                                                       
!                                                                       
  329 tflie = izdt/1440. 
      if(uhrs.le.0.0)uhrz = 0.0 
      if(uhrs.gt.0.0)uhrz = Uhrs 
!                                                                       
!... Umrechnen der Uhrzeit in Dezimalschreibweise hcUhrz                
      hcmin = (Uhrz-int(Uhrz))*100./60. 
      hcUhrz = int(uhrz)+hcmin 
      Uhrz = hcUhrz 
      ij = 1 
!.....Tracer                                                            
      if(iwsim.eq.4)goto 681 
!                                                                       
!......Einlesen aus der Datei EREIGG2.txt, falls ischwa = 1             
      if(ischwa.eq.0)goto 740 
!                                                                       
      open(unit=421, DEFAULTFILE=cpfad, file='eingenhr.dat') 
      rewind(421) 
      read(421,'(A40)')MODNAME 
      read(421,'(A40)')ERENAME 
  643 read(421,'(I5,2x,I5)',end=455)mstr,RBNR 
      read(421,4212)RBNR,(wstand(mstr,RBNR,nstpa),nstpa=1,27) 
      goto 643 
 4212 format(f4.1,26(2x,f4.1)) 
  455 close (421) 
!                                                                       
!     Eingangsgenerator-Stundenwerte                                    
                                                                        
!     Einlesen der Werte der Standard-Normalverteilung                  
!                                                                       
      astand(1) = 0.0 
      astand(2) = -0.2 
      astand(3) = -0.5 
      astand(4) = -0.7 
      astand(5) = -1.1 
      astand(6) = -1.6 
      astand(7) = -2.0 
      astand(8) = -1.3 
      astand(9) = -0.9 
      astand(10)= -0.6 
      astand(11) = -0.3 
      astand(12) = -0.1 
      astand(13) = 0.1 
      astand(14) = 0.3 
      astand(15) = 0.6 
      astand(16) = 0.9 
      astand(17) = 1.3 
      astand(18) = 2.0 
      astand(19) = 1.6 
      astand(20) = 1.1 
      astand(21) = 0.7 
      astand(22) = 0.5 
      astand(23) = 0.2 
      astand(24) = 0.0 
!                                                                       
!                                                                       
! Einlesen der Wetterdaten aus WETTER.TXT                               
!                                                                       
!                                                                       
  740 open(unit=86, DEFAULTFILE=cpfad, file='WETTER.txt') 
      rewind (86) 
      read(86,'(A40)')MODNAME 
      read(86,'(A40)')ERENAME 
      read(86,'(I1,2x,I1)')IWETTs,IMET 
!                                                                       
      do 227 iWETT = 1,iWETTs 
      read(86,'(I8,2x,I5)',end=161)IWSta(iwett),mWetts(iwett) 
!                                                                       
      if(mWetts(iwett).eq.0)then 
      write(199,1996) 
 1996 format(2x,'Wetterdaten nicht oder unvollständig eingegeben') 
      endif 
!                                                                       
      if(IMET.eq.1)goto 129 
      hcTmx2 = -999. 
      do 123 mWett = 1,mWetts(iwett) 
      read(86,2013)itagw(iWSta(iwett),mwett),monatw(iWSta(iwett),mwett) &
     &,jahrw(iWSta(iwett),mwett),(wertw(iWSta(iwett),ixw,mwett),ixw=1,7)
!                                                                       
      if(wertw(iWSta(iwett),3,mwett).gt.hcTmx2)hcTmx2 =                 &
     &wertw(iWSta(iwett),3,mwett)                                       
!                                                                       
  123 continue 
!                                                                       
!...Fehlermeldung keine Minimumtemperaturen an einer oder mehrer Wetters
      if(hcTmx2.eq.(-1.))then 
      ifehl = 4 
      ifhStr = IWETT 
            goto 989 
            endif 
!                                                                       
      goto 227 
!                                                                       
  129 do 124 mWett = 1,mWetts(iwett) 
      read(86,2023)itagw(iWSta(iwett),mwett),monatw(iWSta(iwett),mwett) &
     &,jahrw(iWSta(iwett),mwett),uhrzw(iWSta(iwett),mwett)              &
     &,(wertw(iWSta(iwett),ixw,mwett),ixw=1,7)                          
  124 continue 
!                                                                       
  227 continue 
!                                                                       
      close (86) 
!                                                                       
 2013 format(i2,2x,i2,2x,I4,9x,f7.2,2x,f6.2,2x,f6.2,2x,f6.2,2x,f6.2     &
     &,2x,f4.1,2x,f4.1)                                                 
 2023 format(i2,2x,i2,2x,I4,2x,f5.2,2x,f7.2,2x,f6.2,2x,f6.2,2x,f6.2     &
     &,2x,f6.2,2x,f4.1,2x,f4.1)                                         
!                                                                       
!....Dateneingabe zur Berechnung der Wehrbelüftung                      
!....jlWO2 = 1	Vorgabe der OW und UW Werte und Bestimmung der entspr. We
!....jlWO2 = 2	Vorgabe der gezogenen Wehrsegmente                       
!....janzWs	Anzahl der Wehrsegmente                                     
  161 open(unit=301, DEFAULTFILE=cpfad, file='wehro2.txt') 
      rewind (301) 
      read(301,'(A40)',end=681)MODNAME 
      read(301,'(A40)')ERENAME 
!                                                                       
  223 read(301,'(I5,2x,I1,2x,I5,2x,I1,2x,I1)',end=681)mstr,ISWEHR(mstr) &
     &,io2Ws(mstr),jlWO2,janzWS(mstr)                                   
!                                                                       
      if(jlWO2.eq.2)goto 240 
      if(ISWEHR(mstr).eq.1)goto 236 
      do 235 io2W = 1,io2Ws(mstr) 
      read(301,3010)itagr(mstr,io2W),monatr(mstr,io2W),jahrr(mstr,io2W) &
     &,(wertwe(mstr,io2W,jw),jw=1,4)                                    
  235 continue 
      goto 223 
!                                                                       
  236 do 237 io2W = 1,io2Ws(mstr) 
      read(301,3011)itagr(mstr,io2W),monatr(mstr,io2W),jahrr(mstr,io2W) &
     &,uhrzr(mstr,io2W),(wertwe(mstr,io2W,jw),jw=1,4)                   
  237 continue 
      goto 223 
!                                                                       
 3010 format(i2,2x,i2,2x,I4,2x,f8.3,2x,f5.2,2x,f5.2,2x,f5.2) 
 3011 format(i2,2x,i2,2x,I4,2x,f5.2,2x,f8.3,2x,f5.2,2x,f5.2,2x,f5.2) 
!                                                                       
!                                                                       
                                                                        
!....Vorgabe der gezogenen Segmentanzahl                                
  240 continue 
!                                                                       
      if(ISWEHR(mstr).eq.1)goto 243 
      do 242 io2W = 1,io2Ws(mstr) 
      read(301,3012)itagr(mstr,io2W),monatr(mstr,io2W),jahrr(mstr,io2W) &
     &,iwertw                                                           
      wertwe(mstr,io2W,1) = iwertw 
  242 continue 
      goto 223 
!                                                                       
  243 do 244 io2W = 1,io2Ws(mstr) 
      read(301,3013)itagr(mstr,io2W),monatr(mstr,io2W),jahrr(mstr,io2W) &
     &,uhrzr(mstr,io2W),iwertw                                          
      wertwe(mstr,io2W,1) = iwertw 
  244 continue 
      goto 223 
!                                                                       
  681 continue 
      close (301) 
!                                                                       
 3012 format(i2,2x,i2,2x,I4,2x,I1) 
 3013 format(i2,2x,i2,2x,I4,2x,f5.2,2x,I1) 
!                                                                       
!****************************************************************       
!                                                                       
!**** Erstellung des Gitters fr Sessile Organismen****                 
!*****Lesen aus der Datei MODELLG.txt                                   
!                                                                       
      dlmax1 = 0.0 
      dlmax2 = 0.0 
      dlmax3 = 0.0 
      dlmax4 = 0.0 
      coro1 = 0.0 
      i2Daus = 0 
!                                                                       
      open(unit=103, DEFAULTFILE=cpfad, file='MODELLG.txt') 
      open(unit=77, DEFAULTFILE=cpfad, file= 'temp.dat') 
      rewind(77) 
      read(103,'(2x)',end=339) 
      mstr = 0 
      read(103,2305,err=232)lait1,laim1,laid1 
!                                                                       
      read(103,'(I5)')ihcStr 
      read(103,'(2x)') 
  232 if(mstr.eq.0)goto 6 
!                                                                       
      mPfs(mstr) = mPf 
      mSs(mstr) = mS 
      mDs(mstr) = mD 
      mCs(mstr) = mC 
      mBs(mstr) = mB 
      mUs(mstr) = mU 
      i2Ds(mstr) = mD2 
      mWes(mstr) = mWe 
      mVs(mstr) = mV 
!...i2Daus steuert die Ausgabe in ERGEB2D.txt                           
!...nur wenn mindestens in einem Strang 2D gerechnet wird,              
!...wird ERGEB2D.txt erzeugt                                            
!                                                                       
      if(i2Ds(mstr).gt.0)i2Daus = 1 
!                                                                       
    6 continue 
      mPf = 0 
      mS = 0 
      mD = 0 
      mC = 0 
      mB = 0 
      mD2 = 0 
      mU = 0 
      mWe = 0 
      mV = 0 
      read(103,'(a1,2x,I5)',end=339)ckenn,mstr 
  231 read(103,1030,end=232)ckenn,ctext 
      if(ckenn.eq.' ')goto 232 
      write(77,1030)ckenn,ctext 
      rewind (77) 
!                                                                       
      if(ckenn.eq.'L')then 
      read(77,2306)laits(mstr),laims(mstr),laids(mstr) 
      rewind (77) 
      goto 231 
      endif 
!                                                                       
      if(ckenn.eq.'M')then 
      read(77,1031)itsts(mstr),msts(mstr)                               &
     &,itmaxs(mstr),mmaxs(mstr),itends(mstr),mends(mstr)                
      rewind (77) 
      goto 231 
      endif 
!                                                                       
      if(ckenn.eq.'P')then 
      mPf = mPf+1 
      read(77,1032)apfl(mstr,mPf),epfl(mstr,mPf)                        &
     &,Pflmis(mstr,mPf),Pflmxs(mstr,mPf)                                
      rewind (77) 
      goto 231 
      endif 
!                                                                       
      if(ckenn.eq.'F')then 
      mS = mS+1 
      read(77,1033)aschif(mstr,mS),eschif(mstr,mS) 
      rewind (77) 
      goto 231 
      endif 
!                                                                       
      if(ckenn.eq.'D')then 
      mD = mD+1 
      read(77,1034)akdrei(mstr,mD),ekdrei(mstr,mD)                      &
     &,(zdrs(mstr,mD,ndr),zdrss(mstr,mD,ndr)                            &
     &,gwdrs(mstr,mD,ndr),ndr=1,nndr)                                   
      rewind (77) 
      goto 231 
      endif 
!                                                                       
      if(ckenn.eq.'C')then 
      mC = mC+1 
      read(77,1035)acoro(mstr,mC),ecoro(mstr,mC)                        &
     &,coro1s(mstr,mC),coross(mstr,mC)                                  
      rewind (77) 
      goto 231 
      endif 
!                                                                       
      if(ckenn.eq.'B')then 
      mB = mB+1 
      read(77,1036)abal(mstr,mB),ebal(mstr,mB)                          &
     &,ggbal(mstr,mB),gkbal(mstr,mB)                                    
      rewind (77) 
      goto 231 
      endif 
!                                                                       
      if(ckenn.eq.'V')then 
      mD2 = mD2+1 
      read(77,1037)afkm2D(mstr,mD2),efkm2D(mstr,mD2) 
      rewind (77) 
      goto 231 
      endif 
!                                                                       
      if(ckenn.eq.'U')then 
      mU = mU+1 
      read(77,1038)akmB(mstr,mU),ekmB(mstr,mU),DlB(mstr,mU)             &
     &,tau2B(mstr,mU),alphaB(mstr,mU)                                   
      nbuhn(mstr) = 1 
      rewind (77) 
      goto 231 
      endif 
!                                                                       
      if(ckenn.eq.'T')then 
      mWe = mWe+1 
      read(77,1033)aWett(mstr,mWe),eWett(mstr,mWe),ikWSta(mstr,mWe)     &
     &,YWlage(mstr,mWe)                                                 
      rewind (77) 
      goto 231 
      endif 
!                                                                       
      if(ckenn.eq.'O')then 
      mV = mV+1 
      read(77,1040)aVeg(mstr,mV),eVeg(mstr,mV),(VTYPA(mstr,mV,iV)       &
     &,iV=1,6),VALTAL(mstr,mV),EDUFAL(mstr,mV)                          &
     &,(VTYPA(mstr,mV,iV),iV=7,12),VALTAR(mstr,mV),EDUFAR(mstr,mV)      &
     &,(VTYPA(mstr,mV,iV),iV=13,14)                                     
      rewind (77) 
      goto 231 
      endif 
!                                                                       
  339 continue 
      close (77) 
!                                                                       
 1030 format(a1,a200) 
 1031 format(1x,6(2x,i2)) 
 1032 format(3x,f8.3,2x,f8.3,2x,f7.2,2x,f7.2) 
 1033 format(3x,f8.3,2x,f8.3,2x,I4,2x,F6.2,2x,F7.1) 
 1034 format(3x,f8.3,2x,f8.3,2(2x,f7.2,2x,f7.2,2x,f7.3)) 
 1035 format(3x,f8.3,2x,f8.3,2x,f8.1,2x,f8.1) 
 1036 format(3x,f8.3,2x,f8.3,2x,f7.1,2x,f7.1) 
 1037 format(3x,f8.3,2x,f8.3) 
 1038 format(3x,f8.3,2x,f8.3,2x,f7.2,2x,f7.2,2x,f6.2,2x,f6.2,2x,f6.2) 
 2305 format(i2,2x,i2,2x,i3) 
 2306 format(3xi2,2x,i2,2x,i3) 
 1040 format(3x,f8.3,2x,f8.3,18(2x,f6.2)) 
!                                                                       
!                                                                       
      do 335 azStr = 1,azStrs 
      mstr = mstra(azStr) 
!                                                                       
      mSta = 1 
      fkmgit = Stakm(mstr,mSta) 
      mPf = 1 
      mS = 1 
      mD = 1 
      mC = 1 
      mB = 1 
      mWe = 1 
      mV = 1 
!                                                                       
      do 337 kSta = 0,isegs(mstr) 
      if(kSta.eq.0)goto 343 
!                                                                       
      fkmgit = segkm(mstr,kSta) 
      mSta = mSta+1 
  343 trpmin = 0.0 
      trpmax = 0.0 
      if(mPfs(mstr).eq.0.or.mPf.gt.mPfs(mstr))goto 140 
      if(abfr(mstr).eq.1)goto 761 
!                                                                       
      if(fkmgit.le.apfl(mstr,mPf).and.fkmgit.ge.epfl(mstr,mPf))then 
      trpmin = pflmis(mstr,mPf) 
      trpmax = pflmxs(mstr,mPf) 
      goto 140 
      endif 
!                                                                       
      if(fkmgit.le.epfl(mstr,mPf).and.fkmgit.le.apfl(mstr,mPf+1))then 
  567 mPf = mPf+1 
      if(mPf.gt.mPfs(mstr))goto 140 
      if(epfl(mstr,mPf).gt.fkmgit.and.mPf.lt.mPfs(mstr))goto 567 
      trpmin = pflmis(mstr,mPf) 
      trpmax = pflmxs(mstr,mPf) 
      goto 140 
      endif 
      goto 140 
  761 continue 
      if(fkmgit.ge.apfl(mstr,mPf).and.fkmgit.le.epfl(mstr,mPf))then 
      trpmin = pflmis(mstr,mPf) 
      trpmax = pflmxs(mstr,mPf) 
      goto 140 
      endif 
!                                                                       
      if(fkmgit.ge.epfl(mstr,mPf).and.fkmgit.ge.apfl(mstr,mPf+1))then 
  568 mPf = mPf+1 
      if(mPf.gt.mPfs(mstr))goto 140 
      if(epfl(mstr,mPf).lt.fkmgit.and.mPf.lt.mPfs(mstr))goto 568 
      trpmin = pflmis(mstr,mPf) 
      trpmax = pflmxs(mstr,mPf) 
      goto 140 
      endif 
      goto 140 
!                                                                       
!     Elemente mit benth. Algen                                         
!                                                                       
  140 continue 
!                                                                       
      tggbal = 0.0 
      tgkbal = 0.0 
      if(mBs(mstr).eq.0.or.mB.gt.mBs(mstr))goto 58 
      if(abfr(mstr).eq.1)goto 573 
      if(fkmgit.le.abal(mstr,mB).and.fkmgit.ge.ebal(mstr,mB))then 
      tggbal = ggbal(mstr,mB) 
      tgkbal = gkbal(mstr,mB) 
      goto 58 
      endif 
      if(fkmgit.le.ebal(mstr,mB).and.fkmgit.le.abal(mstr,mB+1))then 
   97 mB = mB+1 
      if(mB.gt.mBs(mstr))goto 58 
      if(ebal(mstr,mB).gt.fkmgit.and.mB.lt.mBs(mstr))goto 97 
      tggbal = ggbal(mstr,mB) 
      tgkbal = gkbal(mstr,mB) 
      goto 58 
      endif 
      goto 58 
!                                                                       
  573 continue 
      if(fkmgit.ge.abal(mstr,mB).and.fkmgit.le.ebal(mstr,mB))then 
      tggbal = ggbal(mstr,mB) 
      tgkbal = gkbal(mstr,mB) 
      goto 58 
      endif 
      if(fkmgit.ge.ebal(mstr,mB).and.fkmgit.ge.abal(mstr,mB+1))then 
   98 mB = mB+1 
      if(mB.gt.mBs(mstr))goto 58 
      if(ebal(mstr,mB).lt.fkmgit.and.mB.lt.mBs(mstr))goto 98 
      tggbal = ggbal(mstr,mB) 
      tgkbal = gkbal(mstr,mB) 
      goto 58 
      endif 
!                                                                       
!     Elemente mit Dreissena                                            
!                                                                       
   58 continue 
!                                                                       
      do 71 ndr=1,nndr 
      zdreie(ndr) = 0.0 
      zdrese(ndr) = 0.0 
   71 gwdre(ndr) = 0.0 
      if(mDs(mstr).eq.0.or.mD.gt.mDs(mstr))goto 59 
      if(abfr(mstr).eq.1)goto 663 
!                                                                       
      if(fkmgit.le.akdrei(mstr,mD).and.fkmgit.ge.ekdrei(mstr,mD))then 
      do 72 ndr=1,nndr 
      zdreie(ndr) = zdrs(mstr,mD,ndr) 
      zdrese(ndr) = zdrss(mstr,mD,ndr) 
   72 gwdre(ndr) = gwdrs(mstr,mD,ndr) 
      goto 59 
      endif 
!                                                                       
      if(fkmgit.le.ekdrei(mstr,mD).and.fkmgit.le.akdrei(mstr,mD+1))then 
  196 mD = mD+1 
      if(mD.gt.mDs(mstr))goto 59 
      if(ekdrei(mstr,mD).gt.fkmgit.and.mD.lt.mDs(mstr))goto 196 
      do 171 ndr=1,nndr 
      zdreie(ndr) = zdrs(mstr,mD,ndr) 
      zdrese(ndr) = zdrss(mstr,mD,ndr) 
  171 gwdre(ndr) = gwdrs(mstr,mD,ndr) 
      goto 59 
      endif 
      goto 59 
!                                                                       
!                                                                       
  663 continue 
      if(fkmgit.ge.akdrei(mstr,mD).and.fkmgit.le.ekdrei(mstr,mD))then 
      do 172 ndr=1,nndr 
      zdreie(ndr) = zdrs(mstr,mD,ndr) 
      zdrese(ndr) = zdrss(mstr,mD,ndr) 
  172 gwdre(ndr) = gwdrs(mstr,mD,ndr) 
      goto 59 
      endif 
!                                                                       
      if(fkmgit.ge.ekdrei(mstr,mD).and.fkmgit.ge.akdrei(mstr,mD+1))then 
  199 mD = mD+1 
      if(mD.gt.mDs(mstr))goto 59 
      if(ekdrei(mstr,mD).lt.fkmgit.and.mD.lt.mDs(mstr))goto 199 
      do 180 ndr=1,nndr 
      zdreie(ndr) = zdrs(mstr,mD,ndr) 
      zdrese(ndr) = zdrss(mstr,mD,ndr) 
  180 gwdre(ndr) = gwdrs(mstr,mD,ndr) 
      endif 
                                                                        
!     Elemente mit Chorophium                                           
!                                                                       
   59 continue 
!                                                                       
      coroe = 0.0 
      corose = 0.0 
      if(mCs(mstr).eq.0.or.mC.gt.mCs(mstr))goto 143 
      if(abfr(mstr).eq.1)goto 763 
!                                                                       
      if(fkmgit.le.acoro(mstr,mC).and.fkmgit.ge.ecoro(mstr,mC))then 
      coroe = coro1s(mstr,mC) 
      corose = coross(mstr,mC) 
      if(coroe.lt.0.0)coroe = 0.0 
      if(corose.lt.0.0)corose = 0.0 
      goto 143 
      endif 
!                                                                       
      if(fkmgit.le.ecoro(mstr,mC).and.fkmgit.le.acoro(mstr,mC+1))then 
  296 mC = mC+1 
      if(mC.gt.mCs(mstr))goto 143 
      if(ecoro(mstr,mC).gt.fkmgit.and.mC.lt.mCs(mstr))goto 296 
      coroe = coro1s(mstr,mC) 
      corose = coross(mstr,mC) 
      if(coroe.lt.0.0)coroe = 0.0 
      if(corose.lt.0.0)corose = 0.0 
      goto 143 
      endif 
      goto 143 
!                                                                       
!                                                                       
  763 continue 
      if(fkmgit.ge.acoro(mstr,mC).and.fkmgit.le.ecoro(mstr,mC))then 
      coroe = coro1s(mstr,mC) 
      corose = coross(mstr,mC) 
      if(coroe.lt.0.0)coroe = 0.0 
      if(corose.lt.0.0)corose = 0.0 
      goto 143 
      endif 
!                                                                       
      if(fkmgit.ge.ecoro(mstr,mC).and.fkmgit.ge.acoro(mstr,mC+1))then 
  299 mC = mC+1 
      if(mC.gt.mCs(mstr))goto 143 
      if(ecoro(mstr,mC).lt.fkmgit.and.mC.lt.mCs(mstr))goto 299 
      coroe = coro1s(mstr,mC) 
      corose = coross(mstr,mC) 
      if(coroe.lt.0.0)coroe = 0.0 
      if(corose.lt.0.0)corose = 0.0 
      endif 
!                                                                       
!                                                                       
  143 continue 
!                                                                       
!     Elemente mit Uferbewuchs                                          
!                                                                       
!                                                                       
      if(mVs(mstr).eq.0.or.mV.gt.mVs(mstr))goto 848 
      if(abfr(mstr).eq.1)goto 840 
!                                                                       
      if(fkmgit.le.aVEG(mstr,mV).and.fkmgit.ge.eVEG(mstr,mV))then 
      Do 841 iV = 1,14 
  841 VTYPH(mstr,mSta,iV) = VTYPA(mstr,mV,iV) 
      VALTLH(mstr,mSta) = VALTAL(mstr,mV) 
      EDUFLH(mstr,mSta) = EDUFAL(mstr,mV) 
      VALTRH(mstr,mSta) = VALTAR(mstr,mV) 
      EDUFRH(mstr,mSta) = EDUFAR(mstr,mV) 
      goto 848 
      endif 
!                                                                       
      if(fkmgit.le.eVEG(mstr,mV).and.fkmgit.le.aVEG(mstr,mV+1))then 
  842 mV = mV+1 
      if(mV.gt.mVs(mstr))goto 848 
      if(eVEG(mstr,mV).gt.fkmgit.and.mV.lt.mVs(mstr))goto 842 
      Do 843 iV = 1,14 
  843 VTYPH(mstr,mSta,iV) = VTYPA(mstr,mV,iV) 
      VALTLH(mstr,mSta) = VALTAL(mstr,mV) 
      EDUFLH(mstr,mSta) = EDUFAL(mstr,mV) 
      VALTRH(mstr,mSta) = VALTAR(mstr,mV) 
      EDUFRH(mstr,mSta) = EDUFAR(mstr,mV) 
      goto 848 
      endif 
      goto 848 
!                                                                       
!                                                                       
  840 continue 
      if(fkmgit.ge.aVEG(mstr,mV).and.fkmgit.le.eVEG(mstr,mV))then 
      Do 844 iV = 1,14 
  844 VTYPH(mstr,mSta,iV) = VTYPA(mstr,mV,iV) 
      VALTLH(mstr,mSta) = VALTAL(mstr,mV) 
      EDUFLH(mstr,mSta) = EDUFAL(mstr,mV) 
      VALTRH(mstr,mSta) = VALTAR(mstr,mV) 
      EDUFRH(mstr,mSta) = EDUFAR(mstr,mV) 
      goto 848 
      endif 
!                                                                       
      if(fkmgit.ge.eVEG(mstr,mV).and.fkmgit.ge.aVEG(mstr,mV+1))then 
  845 mV = mV+1 
      if(mV.gt.mVs(mstr))goto 848 
      if(eVEG(mstr,mV).lt.fkmgit.and.mV.lt.mVs(mstr))goto 845 
      Do 846 iV = 1,14 
  846 VTYPH(mstr,mSta,iV) = VTYPA(mstr,mV,iV) 
      VALTLH(mstr,mSta) = VALTAL(mstr,mV) 
      EDUFLH(mstr,mSta) = EDUFAL(mstr,mV) 
      VALTRH(mstr,mSta) = VALTAR(mstr,mV) 
      EDUFRH(mstr,mSta) = EDUFAR(mstr,mV) 
      endif 
!                                                                       
  848 continue 
!                                                                       
!...Abschnittsweise Zuordnung der Wetterstationen                       
!                                                                       
      if(mWe.gt.mWes(mstr))goto 940 
      if(abfr(mstr).eq.1)goto 941 
!                                                                       
      if(fkmgit.le.aWett(mstr,mWe).and.fkmgit.ge.eWett(mstr,mWe))then 
      idWe(mstr,mSta) = ikWSta(mstr,mWe) 
      Wlage(mstr,mSta) = yWlage(mstr,mWe) 
      goto 940 
      endif 
!                                                                       
      if(fkmgit.le.eWett(mstr,mWe).and.fkmgit.le.aWett(mstr,mWe+1))then 
  942 mWe = mWe+1 
      if(mWe.gt.mWes(mstr))goto 940 
      if(eWett(mstr,mWe).gt.fkmgit.and.mWe.lt.mWes(mstr))goto 942 
      idWe(mstr,mSta) = ikWSta(mstr,mWe) 
      Wlage(mstr,mSta) = yWlage(mstr,mWe) 
      goto 940 
      endif 
      goto 940 
!                                                                       
!                                                                       
  941 continue 
      if(fkmgit.ge.aWett(mstr,mWe).and.fkmgit.le.eWett(mstr,mWe))then 
      idWe(mstr,mSta) = ikWSta(mstr,mWe) 
      Wlage(mstr,mSta) = yWlage(mstr,mWe) 
      goto 940 
      endif 
!                                                                       
      if(fkmgit.ge.eWett(mstr,mWe).and.fkmgit.ge.aWett(mstr,mWe+1))then 
  943 mWe = mWe+1 
      if(mWe.gt.mWes(mstr))goto 940 
      if(eWett(mstr,mWe).lt.fkmgit.and.mWe.lt.mWes(mstr))goto 943 
      idWe(mstr,mSta) = ikWSta(mstr,mWe) 
      Wlage(mstr,mSta) = yWlage(mstr,mWe) 
      endif 
!                                                                       
!                                                                       
  940 continue 
!      fkmgn = segkm(mstr,msta+1)                                       
!                                                                       
!                                                                       
      do 688 ndr = 1,nndr 
      hzdrel(mstr,mSta,ndr) = zdreie(ndr) 
      hzdrsl(mstr,mSta,ndr) = zdrese(ndr) 
  688 hgwdrl(mstr,mSta,ndr) = gwdre(ndr) 
      hdlmx(mstr,mSta) = dlmax1 
      hdlmxs(mstr,mSta) = dlmax2 
      hgwdmx(mstr,mSta) = dlmax3 
      hsgwmu(mstr,mSta) = dlmax4 
      habgml(mstr,mSta) = tggbal 
      habkml(mstr,mSta) = tgkbal 
      if(trpmin.lt.0.0)trpmin = 0.0 
      if(trpmax.lt.0.0)trpmax = 0.0 
      hpfmnl(mstr,mSta) = trpmin 
      hpfmxl(mstr,mSta) = trpmax 
      hcoro2(mstr,mSta,1) = coroe 
      hcos2(mstr,mSta,1) = corose 
      do 689 ico = 2,5 
      hcoro2(mstr,mSta,ico) = coro1 
  689 hcos2(mstr,mSta,ico) = coro1 
!                                                                       
      if(kSta.eq.0)goto 337 
      if(kSta.gt.0.and.hflag(mstr,kSta).eq.4)then 
      mSta = mSta+1 
      idWe(mstr,mSta) = ikWSta(mstr,mWe) 
      Wlage(mstr,mSta) = yWlage(mstr,mWe) 
      Do 946 iV = 1,14 
  946 VTYPH(mstr,mSta,iV) = VTYPA(mstr,mV,iV) 
      VALTLH(mstr,mSta) = VALTAL(mstr,mV) 
      EDUFLH(mstr,mSta) = EDUFAL(mstr,mV) 
      VALTRH(mstr,mSta) = VALTAR(mstr,mV) 
      EDUFRH(mstr,mSta) = EDUFAR(mstr,mV) 
!                                                                       
      do 988 ndr = 1,nndr 
      hzdrel(mstr,mSta,ndr) = zdreie(ndr) 
      hzdrsl(mstr,mSta,ndr) = zdrese(ndr) 
  988 hgwdrl(mstr,mSta,ndr) = gwdre(ndr) 
      hdlmx(mstr,mSta) = dlmax1 
      hdlmxs(mstr,mSta) = dlmax2 
      hgwdmx(mstr,mSta) = dlmax3 
      hsgwmu(mstr,mSta) = dlmax4 
      habgml(mstr,mSta) = tggbal 
      habkml(mstr,mSta) = tgkbal 
      if(trpmin.lt.0.0)trpmin = 0.0 
      if(trpmax.lt.0.0)trpmax = 0.0 
      hpfmnl(mstr,mSta) = trpmin 
      hpfmxl(mstr,mSta) = trpmax 
      hcoro2(mstr,mSta,1) = coroe 
      hcos2(mstr,mSta,1) = corose 
      do 789 ico = 2,5 
      hcoro2(mstr,mSta,ico) = coro1 
  789 hcos2(mstr,mSta,ico) = coro1 
!                                                                       
      endif 
                                                                        
                                                                        
                                                                        
!      fkmgit = fkmgn                                                   
!                                                                       
  337 continue 
  335 continue 
!                                                                       
!***********************************************************************
!                                                                       
      if(iwsim.eq.4.or.iwsim.eq.2)goto 712 
!                                                                       
!     ****************************************                          
!     Berechnung der SedimentKenngroessen                               
!     ****************************************                          
!                                                                       
      call Sediment(abfr,azStrs,mStra,Stakm,mStas,mSs                   &
     &,aschif,eschif,SedOM,w2,SedOMb,w2b,dKorn,dKornb                   &
     &,raua,vmq,Hmq,nbuhn,bvmq,bHmq)                                    
!                                                                       
  712 continue 
!...EREIGH.txt                                                          
      open(unit=110, DEFAULTFILE=cpfad1, file='EREIGH.txt') 
      rewind (110) 
      read(110,'(A40)')MODNAME 
      read(110,'(A40)')ERENAME 
!                                                                       
!...Festlegung der max. Tiefenschichtenanzahl für jeden Ortspunkt bei 2D
!                                                                       
      if(I2Daus.eq.0.or.ilang.eq.1)goto 706 
!                                                                       
      write(*,6166) 
 6166 format(2x,'Berechnung der maximalen vertikalen Schichtenanzahl'   &
     &,' kann etwas dauern!')                                           
!                                                                       
  700 read(110,'(2x)',end=707) 
      do 735 azStr = 1,azStrs 
      mstr = mstra(azStr) 
      i2D = 1 
      do 936 mSta = 1,mStas(mstr) 
      nkzmx(mstr,mSta) = 1 
      read(110,'(7x,f8.3,57x,f7.4)')Stakmh,Tief2D 
      if(abfr(mstr).eq.1)goto 835 
!                                                                       
      if(Stakmh.lt.efkm2D(mstr,i2D).and.i2Ds(mstr).ge.i2D)              &
     &i2D = i2D+1                                                       
      if(i2D.gt.i2Ds(mstr))goto 936 
      if(Stakmh.le.afkm2D(mstr,i2D)                                     &
     &.and.Stakmh.ge.efkm2D(mstr,i2D))goto 538                          
      goto 936 
  835 continue 
      if(Stakmh.gt.efkm2D(mstr,i2D).and.i2Ds(mstr).ge.i2D)              &
     &i2D = i2D+1                                                       
      if(i2D.gt.i2Ds(mstr))goto 936 
      if(Stakmh.ge.afkm2D(mstr,i2D)                                     &
     &.and.Stakmh.le.efkm2D(mstr,i2D))goto 538                          
      goto 936 
!                                                                       
  538 if(Tief2D.gt.Hmax2D(mstr,mSta))Hmax2D(mstr,mSta) = Tief2D 
      nkzmx(mstr,mSta) = int(Hmax2D(mstr,mSta)/dH2D)+2 
  936 continue 
  735 continue 
      goto 700 
!                                                                       
  707 rewind (110) 
      read(110,'(A40)')MODNAME 
      read(110,'(A40)')ERENAME 
!                                                                       
!.....ABLAUF.txt                                                        
  706 continue 
      open(unit=97, DEFAULTFILE=cpfad1, file='ABLAUF.txt') 
      rewind (97) 
      read(97,'(A40)')MODNAME 
      read(97,'(A40)')ERENAME 
!..                                                                     
!....Beginn eines neuen Zeitschritts                                    
 9999 CONTINUE 
!                                                                       
!.....Lesen der Strangreihenfolge                                       
      istr = 0 
      read(97,'(I5)',end=927)SCHRNR 
      do 919 azStr = 1,azStrs 
      istr = istr+1 
      read(97,9700,end=919)STRNR(istr),iFlRi(STRNR(istr)),              &
     &(ESTRNR(istr,nstr),nstr=1,100)
!      if(iFlRi(STRNR(istr))<0)iFlRi(STRNR(istr))=1  !wieder loeschen                                    
      do 913 nstr = 1,100 
      if(ESTRNR(istr,nstr).eq.0)then 
      nstrs(istr) = nstr-1 
      goto 919 
      endif 
  913 continue 
  919 continue 
 9700 format(I5,2x,I2,100(2x,I5)) 
!                                                                       
  927 continue 
!                                                                       
      istrs = istr 
!                                                                       
!                                                                       
!     ***************************************                           
!     Einteilung der Flussstrecke in Segmente                           
!     ***************************************                           
!                                                                       
!...Bildschirmausgabe                                                   
      write(*,6109) 
 6109 format(2x,'SYSTEMGENERIERUNG') 
!                                                                       
!                                                                       
      dt = tflie*86400. 
!                                                                       
      call sysgen(ilang,dt,iwsim                                        &
     &,nbuhn,akmB,ekmB,DLB,tau2B,alphaB,mUs                             &
     &,ifehl,aschif,eschif,mSs,azStrs,mStra                             &
     &,raua,bsohla,boeamq,hlboea,hflaea,htiefa                          &
     &,hvF,hQaus,SedOM,w2,dKorn,abfr,mStas,Startkm,endkm                &
     &,mRBs,RBtyp,RBkm,ij,mwehr,tflie,FZeit                             &
     &,STRdt,STRiz,iFlRi,cpfad,ior1,ior2,i2Ds,afkm2D                    &
     &,efkm2D,nkzsSt,H2DeSt,dH2D,SedOMb,w2b,dKornb,itags,monats         &
     &,ifhStr,fhprof)                                                   
!                                                                       
      if(ifehl.gt.0)goto 989 
!                                                                       
      open(unit=11, DEFAULTFILE=cpfad, file='sysgenou') 
      rewind (11) 
!                                                                       
      if(iwied.eq.1)goto 719 
      if(iwsim.eq.2.or.ieros.eq.0)goto 719 
!                                                                       
!     Vorbelegung fuer Errosionsberechnung                              
!                                                                       
      tauscs = 1.25 
      do 485 azStr = 1,azStrs 
      mstr = mstra(azStr) 
!                                                                       
      read(11,1000)hanze(mstr) 
      do 482 ior = 1,hanze(mstr)+1 
      sedhg(mstr,ior) = 0.000001 
      ischig(mstr,ior) = 1 
      tauscg(mstr,ior,1) = tauscs 
  482 continue 
  485 continue 
!                                                                       
!                                                                       
  719 rewind (11) 
!                                                                       
      anzema = 0 
      do 783 azStr = 1,azStrs 
      mstr = mstra(azStr) 
!                                                                       
      read(11,1000)hanze(mstr) 
!                                                                       
      do 135 istr = 1,istrs 
  135 if(STRNR(istr).eq.mstr)anzema = anzema+int(FZeit(mstr)) 
!                                                                       
      do 130 ior=1,hanze(mstr) 
!                                                                       
      read(11,1010)hfkm(mstr,ior),hflag(mstr,ior) 
  130 continue 
  783 continue 
      close (11) 
!                                                                       
                                                                        
!... Berechnung der Anzahl der Zeitschritte                             
      if(ilang.eq.1)then 
        else 
      hcon = izdt/60. 
      hcontm = 24./hcon 
      itimeh = nint(hcontm) 
      itimeb = itimeh-1 
!                                                                       
!...Anzahl der Zeitschritte für ersten Simulationstag (itimea)          
!..und letzen Simulationstag (itimee)                                   
!... Umrechnen der End-Uhrzeit in Dezimalschreibweise Uhren in hcUhre   
!                                                                       
!      hcmin = (Uhren-int(Uhren))/0.6                                   
!      hcUhre = int(uhren)+hcmin                                        
                                                                        
      hcontm = (24.-Uhrz)/hcon 
      itimea = nint(hcontm) 
!                                                                       
      hcontm = (Uhren)/hcon 
      itimee = nint(hcontm)+1 
!      if(itimee.eq.0)itimee = 1                                        
                                                                        
      if(itags.eq.itage.and.monats.eq.monate.and.jahrs.eq.jahre)then 
      itimea = itimee 
      itimeh = itimee 
      endif 
                                                                        
      itime = itimeb 
      endif 
                                                                        
!                                                                       
!     Berechnen der Startwerte                                          
!                                                                       
      istr = 0 
!                                                                       
      call funkstar(abfls,vbsbs,vcsbs,vnh4s,vno2s,vno3s,gesNs           &
     &,vx0s,vx02s,gelps,gesPs,sis,chlas,vkigrs,antbls,zooins            &
     &,vphs,mws,cas,lfs,ssalgs,tempws,vo2s                              &
     &,CHNFs,BVHNFs,colis,waers,istund,uhrz,RBtyp,NRSCHr                &
     &,itags,monats,jahrs,cpfad,iwsim,ilang,iwied,mstrRB)               
!                                                                       
! ......Nur Tracer                                                      
      if(iwsim.eq.4)goto 344 
      if(iwsim.eq.2.or.iwied.eq.1)goto 347 
!                                                                       
!.....Abfrage ob allen benoetigten Eingaben gemacht                     
!....nur beim Modellstart                                               
      do 931 azStr = 1,azStrs 
      mstr = mstra(azStr) 
      do 932 mRB = 1,mRBs(mstr) 
      if(RBtyp(mstr,mRB).eq.1)goto 932 
!...Nitrosomonas                                                        
      if(vnh4s(mstr,mRB).gt.0.0                                         &
     &.and.vx0s(mstr,mRB).lt.0.0)then                                   
       ifehl = 6 
      goto 989 
      endif 
!                                                                       
!...Nitrobacter                                                         
      if(vnh4s(mstr,mRB).gt.0.0.and.vno2s(mstr,mRB).gt.0.0              &
     &.and.vx02s(mstr,mRB).lt.0.0)then                                  
       ifehl = 7 
      goto 989 
      endif 
!                                                                       
!                                                                       
!.....Anteil der Kieselalgen                                            
!                                                                       
      if(chlas(mstr,mRB).gt.0.0.and.vkigrs(mstr,mRB).lt.0.0)            &
     &then                                                              
         ifehl = 8 
         goto 989 
      endif 
!                                                                       
!.....Anteil der Blaualgen                                              
!                                                                       
      if(chlas(mstr,mRB).gt.0.0.and.antbls(mstr,mRB).lt.0.0)            &
     &then                                                              
         ifehl = 9 
         goto 989 
      endif 
!                                                                       
!                                                                       
!...Silikat                                                             
      if(chlas(mstr,mRB).gt.0.0.and.vkigrs(mstr,mRB).gt.0.0             &
     &.and.Sis(mstr,mRB).lt.0.0)then                                    
         ifehl = 10 
         goto 989 
      endif 
!                                                                       
!                                                                       
  932 continue 
  931 continue 
!                                                                       
!                                                                       
!                                                                       
  347 do 731 azStr = 1,azStrs 
      mstr = mstra(azStr) 
      do 732 mRB = 1,mRBs(mstr) 
!                                                                       
      ista = ij 
      if(ista.eq.0)ista = 1 
      if(ista.gt.24)ista = 1 
      if(istund(mstr,mRB).eq.1.or.ischwa.eq.0)goto 1335 
      if(vbsbs(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,1).le.0.0)goto 1310                              
      vbsbs(mstr,mRB) = vbsbs(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,1)*vbsbs(mstr,mRB)/100.                          
 1310 if(vcsbs(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,2).le.0.0)goto 1311                              
      vcsbs(mstr,mRB) = vcsbs(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,2)*vcsbs(mstr,mRB)/100.                          
 1311 if(vnh4s(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,3).le.0.0)goto 1312                              
      vnh4s(mstr,mRB) = vnh4s(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,3)*vnh4s(mstr,mRB)/100.                          
 1312 if(vno2s(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,4).le.0.0)goto 1313                              
      vno2s(mstr,mRB) = vno2s(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,4)*vno2s(mstr,mRB)/100.                          
 1313 if(vno3s(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,5).le.0.0)goto 1314                              
      vno3s(mstr,mRB) = vno3s(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,5)*vno3s(mstr,mRB)/100.                          
 1314 if(gesNs(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,6).le.0.0)goto 1315                              
      gesNs(mstr,mRB) = gesNs(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,6)*gesNs(mstr,mRB)/100.                          
 1315 if(vx0s(mstr,mRB).lt.0.0.or.                                       &
     &wstand(mstr,mRB,7).le.0.0)goto 1316                              
      vx0s(mstr,mRB) = vx0s(mstr,mRB)+astand(ista)                      &
     &*wstand(mstr,mRB,7)*vx0s(mstr,mRB)/100.                           
 1316 if(vx02s(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,8).le.0.0)goto 1317                              
      vx02s(mstr,mRB) = vx02s(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,8)*vx02s(mstr,mRB)/100.                          
 1317 if(gelPs(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,9).le.0.0)goto 1318                              
      gelPs(mstr,mRB) = gelPs(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,9)*gelPs(mstr,mRB)/100.                          
 1318 if(gesPs(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,10).le.0.0)goto 1319                             
      gesPs(mstr,mRB) = gesPs(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,10)*gesPs(mstr,mRB)/100.                         
 1319 if(sis(mstr,mRB).lt.0.0.or.                                        &
     &wstand(mstr,mRB,11).le.0.0)goto 1320                             
      sis(mstr,mRB) = sis(mstr,mRB)+astand(ista)                        &
     &*wstand(mstr,mRB,11)*sis(mstr,mRB)/100.                           
 1320 if(chlas(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,12).le.0.0)goto 1321                             
      chlas(mstr,mRB) = chlas(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,12)*chlas(mstr,mRB)/100.                         
 1321 if(vkigrs(mstr,mRB).lt.0.0.or.                                     &
     &wstand(mstr,mRB,13).le.0.0)goto 1322                             
      vkigrs(mstr,mRB) = vkigrs(mstr,mRB)+astand(ista)                  &
     &*wstand(mstr,mRB,13)*vkigrs(mstr,mRB)/100.                        
 1322 if(antbls(mstr,mRB).lt.0.0.or.                                     &
     &wstand(mstr,mRB,14).le.0.0)goto 1323                             
      antbls(mstr,mRB) = antbls(mstr,mRB)+astand(ista)                  &
     &*wstand(mstr,mRB,14)*antbls(mstr,mRB)/100.                        
 1323 if(zooins(mstr,mRB).lt.0.0.or.                                     &
     &wstand(mstr,mRB,15).le.0.0)goto 1324                             
      zooins(mstr,mRB) = zooins(mstr,mRB)+astand(ista)                  &
     &*wstand(mstr,mRB,15)*zooins(mstr,mRB)/100.                        
 1324 if(lfs(mstr,mRB).lt.0.0.or.                                        &
     &wstand(mstr,mRB,19).le.0.0)goto 1325                             
      lfs(mstr,mRB) = lfs(mstr,mRB)+astand(ista)                        &
     &*wstand(mstr,mRB,19)*lfs(mstr,mRB)/100.                           
!                                                                       
 1325 if(vphs(mstr,mRB).lt.0.0.or.                                       &
     &wstand(mstr,mRB,16).le.0.0)goto 1326                             
      if(lfs(mstr,mRB).lt.0.0)lfs(mstr,mRB) = 0.0 
      mues = 1.7e-5*lfs(mstr,mRB) 
      hk = (0.5*sqrt(mues))/(1.+1.4*sqrt(mues)) 
      lgh = vphs(mstr,mRB)-hk 
      hs = 10**(-lgh) 
      hs = hs+astand(ista)*wstand(mstr,mRB,16)*hs/100. 
      vphs(mstr,mRB) = -1.*alog10(hs)+hk 
!                                                                       
 1326 if(mws(mstr,mRB).lt.0.0.or.                                        &
     &wstand(mstr,mRB,17).le.0.0)goto 1327                             
      mws(mstr,mRB) = mws(mstr,mRB)+astand(ista)                        &
     &*wstand(mstr,mRB,17)*mws(mstr,mRB)/100.                           
 1327 if(cas(mstr,mRB).lt.0.0.or.                                        &
     &wstand(mstr,mRB,18).le.0.0)goto 1328                             
      cas(mstr,mRB) = cas(mstr,mRB)+astand(ista)                        &
     &*wstand(mstr,mRB,18)*cas(mstr,mRB)/100.                           
 1328 if(ssalgs(mstr,mRB).lt.0.0.or.                                     &
     &wstand(mstr,mRB,20).le.0.0)goto 1329                             
      ssalgs(mstr,mRB) = ssalgs(mstr,mRB)+astand(ista)                  &
     &*wstand(mstr,mRB,20)*ssalgs(mstr,mRB)/100.                        
 1329 if(tempws(mstr,mRB).lt.0.0.or.                                     &
     &wstand(mstr,mRB,21).le.0.0)goto 1330                             
      tempws(mstr,mRB) = tempws(mstr,mRB)+astand(ista)                  &
     &*wstand(mstr,mRB,21)*tempws(mstr,mRB)/100.                        
 1330 if(vo2s(mstr,mRB).lt.0.0.or.                                       &
     &wstand(mstr,mRB,22).le.0.0)goto 1331                             
      vo2s(mstr,mRB) = vo2s(mstr,mRB)+astand(ista)                      &
     &*wstand(mstr,mRB,22)*vo2s(mstr,mRB)/100.                          
 1331 if(CHNFs(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,23).le.0.0)goto 1332                             
      CHNFs(mstr,mRB) = CHNFs(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,23)*CHNFs(mstr,mRB)/100.                         
 1332 if(BVHNFs(mstr,mRB).lt.0.0.or.                                     &
     &wstand(mstr,mRB,24).le.0.0)goto 1333                             
      BVHNFs(mstr,mRB) = BVHNFs(mstr,mRB)+astand(ista)                  &
     &*wstand(mstr,mRB,24)*BVHNFs(mstr,mRB)/100.                        
 1333 if(colis(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,25).le.0.0)goto 1334                             
      colis(mstr,mRB) = colis(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,25)*colis(mstr,mRB)/100.                         
 1334 if(waers(mstr,mRB).lt.0.0.or.                                      &
     &wstand(mstr,mRB,26).le.0.0)goto 1335                             
      waers(mstr,mRB) = waers(mstr,mRB)+astand(ista)                    &
     &*wstand(mstr,mRB,26)*waers(mstr,mRB)/100.                         
!                                                                       
!                                                                       
!.....Umrechnung der Zellzahlen von HNF in mgC                          
!                                                                       
 1335 if(CHNFs(mstr,mRB).lt.0.0)then 
      CHNFs(mstr,mRB) = 0.0 
      BVHNFs(mstr,mRB) = 0.0 
      goto 732 
      endif 
      CHNFs(mstr,mRB) = CHNFs(mstr,mRB)*BVHNFs(mstr,mRB)*0.22 
!.......Umrechnung von pg in mg /1.e9; Angabe CHNFs pro ml ergibt /1.e6 
!       bezogen auf ein Liter                                           
      CHNFs(mstr,mRB) = CHNFs(mstr,mRB)/1.e6 
!                                                                       
  732 continue 
  731 continue 
      if(iwsim.eq.2)goto 396 
!                                                                       
!     Setzen von Werten am Startprofil                                  
!                                                                       
      fssgrs = 1.0 
      fbsgrs = 0.21 
      frfgrs = 0.13 
!                                                                       
!                                                                       
      do 720 azStr = 1,azStrs 
      mstr = mstra(azStr) 
      do 721 mRB = 1,mRBs(mstr) 
!                                                                       
      if(NRSchr(mstr,mRB).eq.0)goto 721 
      if(iwsim.eq.2)goto 721 
!                                                                       
      hcchla = chlas(mstr,mRB) 
      hczoos = zooins(mstr,mRB) 
      hcnh4s = vnh4s(mstr,mRB) 
      hcno2s = vno2s(mstr,mRB) 
      hcno3s = vno3s(mstr,mRB) 
      hcgePs = gelPs(mstr,mRB) 
      hcbsb = vbsbs(mstr,mRB) 
      hccsb = vcsbs(mstr,mRB) 
      hcchla = chlas(mstr,mRB) 
      hcvkg = vkigrs(mstr,mRB) 
      hcantb = antbls(mstr,mRB) 
!                                                                       
      if(zooins(mstr,mRB).lt.0.0)zooins(mstr,mRB) = 0.0 
      if(vnh4s(mstr,mRB).lt.0.0)vnh4s(mstr,mRB) = 0.0 
      if(vno2s(mstr,mRB).lt.0.0)vno2s(mstr,mRB) = 0.0 
      if(vno3s(mstr,mRB).lt.0.0)vno3s(mstr,mRB) = 0.0 
      if(gelPs(mstr,mRB).lt.0.0)gelPs(mstr,mRB) = 0.0 
      if(vbsbs(mstr,mRB).lt.0.0)vbsbs(mstr,mRB) = 0.0 
      if(vcsbs(mstr,mRB).lt.0.0)vcsbs(mstr,mRB) = 0.0 
      if(chlas(mstr,mRB).lt.0.0)chlas(mstr,mRB) = 0.0 
!                                                                       
      if(vkigrs(mstr,mRB).lt.0.0)vkigrs(mstr,mRB) = 0.0 
      if(antbls(mstr,mRB).lt.0.0)antbls(mstr,mRB) = 0.0 
!...Fehlerausgabe falls AnteilGR+AnteilKI+AnteilBL >1                   
      hconFe = 1.-vkigrs(mstr,mRB)-antbls(mstr,mRB) 
      if(hconFe.lt.0.0)then 
      ifehl = 5 
         ifhStr = mstr 
         goto 989 
         endif 
!                                                                       
      algb5 = chlas(mstr,mRB)*vkigrs(mstr,mRB)*bsbki                    &
     &+(1.-vkigrs(mstr,mRB)-antbls(mstr,mRB))*chlas(mstr,mRB)*bsbgr     &
     &+antbls(mstr,mRB)*chlas(mstr,mRB)*bsbbl                           
      algcs = chlas(mstr,mRB)*vkigrs(mstr,mRB)*csbki                    &
     &+(1.-vkigrs(mstr,mRB)-antbls(mstr,mRB))*chlas(mstr,mRB)*csbgr     &
     &+antbls(mstr,mRB)*chlas(mstr,mRB)*csbbl                           
!                                                                       
      if(zooins(mstr,mRB).lt.0.0)zooins(mstr,mRB) = 0.0 
      zoobsb = (zooins(mstr,mRB)*GRote/1000.)*1.35 
      zoocsb = zooins(mstr,mRB)*(GRote/1000.)*1.5*1.08 
!                                                                       
      obsbs(mstr,mRB) = vbsbs(mstr,mRB)-algb5-zoobsb 
      if(obsbs(mstr,mRB).lt.0.5)obsbs(mstr,mRB) = 0.5 
!                                                                       
      ocsbs(mstr,mRB) = vcsbs(mstr,mRB)-algcs-zoocsb 
      if(ocsbs(mstr,mRB).lt.5.)ocsbs(mstr,mRB) = 5. 
!                                                                       
!.....Test ob OBSB und/oder OCSB falsch eingegeben wurde                
      vcbts = obsbs(mstr,mRB)/ocsbs(mstr,mRB) 
      if(vcbts.gt.0.25.and.obsbs(mstr,mRB).gt.2.)                       &
     &obsbs(mstr,mRB) = ocsbs(mstr,mRB)*0.25                            
      if(vcbts.gt.0.25.and.obsbs(mstr,mRB).lt.2.)                       &
     &ocsbs(mstr,mRB) = obsbs(mstr,mRB)/0.25                            
!                                                                       
      vbsbs(mstr,mRB) = obsbs(mstr,mRB)+algb5+zoobsb 
      vcsbs(mstr,mRB) = ocsbs(mstr,mRB)+algcs+zoocsb 
!                                                                       
!     Berechnung des Chlorophyll-a/Kohlenstoff-Verhaeltnisses           
!                                                                       
!     Angabe in mgChla/mgC                                              
!                                                                       
      Cagr = 0.48 
      Caki = 0.48 
      Cabl = 0.48 
!...Temperaturabhängigkeit des Chla:C-Verhältnisses                     
!....ag(k,b)chl gilt für 20°C                                           
      fTChlC = 0.3986*exp(0.0464*tempws(mstr,mRB)) 
      F5 = Sis(mstr,mRB)/(Sis(mstr,mRB)+akksSi) 
      akbcmn = 0.003 
      akbcmm = akchl/(1000.*Caki) 
      akbc = akbcmn+(akbcmm-akbcmn)*F5 
      agbcms(mstr,mRB) = (agchl/(1000.*Cagr))*fTChlC 
!      akbcms(mstr,mRB) = akbc*fTChlC                                   
      akbcms(mstr,mRB) = (akchl/(1000.*Caki))*fTChlC 
      abbcms(mstr,mRB) = (abchl/(1000.*Cabl))*fTChlC 
!                                                                       
      akis(mstr,mRB) = (chlas(mstr,mRB)*vkigrs(mstr,mRB))               &
     &/(1000.*akbcms(mstr,mRB)*Caki)                                    
      abls(mstr,mRB) = (chlas(mstr,mRB)*antbls(mstr,mRB))               &
     &/(1000.*abbcms(mstr,mRB)*Cabl)                                    
      agrs(mstr,mRB) = chlas(mstr,mRB)*(1.-vkigrs(mstr,mRB)             &
     &-antbls(mstr,mRB))/(1000.*agbcms(mstr,mRB)*Cagr)                  
!                                                                       
!....zelluläre Nährstoffgehalte                                         
      Q_NKs(mstr,mRB) = Qmn_NK+(Qmx_NK-Qmn_NK)/1. 
      Q_PKs(mstr,mRB) = Qmn_PK+(Qmx_PK-Qmn_PK)/1. 
      Q_SKs(mstr,mRB) = Qmx_SK 
      Q_NGs(mstr,mRB) = Qmn_NG+(Qmx_NG-Qmn_NG)/1. 
      Q_PGs(mstr,mRB) = Qmn_PG+(Qmx_PG-Qmn_PG)/1. 
      Q_NBs(mstr,mRB) = Qmn_NB+(Qmx_NB-Qmn_NB)/1. 
      Q_PBs(mstr,mRB) = Qmn_PB+(Qmx_PB-Qmn_PB)/1. 
!                                                                       
!                                                                       
!....Berechnung der "BSB-Komponenten" am oberen Rand                    
!     (auch bei Stundenwert-Generierung)!!!!!                           
      bk1 = 0.51 
      bk2 = 0.02 
!                                                                       
      vcb = obsbs(mstr,mRB)/ocsbs(mstr,mRB) 
      antBAC = 0.0462*vcb 
      CMs(mstr,mRB) = 0.03 
!...Berechnung des BTOC                                                 
      BTOC5s = obsbs(mstr,mRB)/4. 
      BTOCs = BTOC5s*0.782*vcb**(-0.921) 
!....Berechnung des Anteils an gelsten org. C-Verbindungen             
      alphaD = 0.21*log(vcb)+0.6294 
      if(alphaD.gt.1.)alphaD = 0.95 
      if(alphaD.lt.0.0)alphaD = 0.0 
      CDges = BTOCs*alphaD-CMs(mstr,mRB) 
      if(CDges.lt.0.00001)CDges = 0.00001 
!.......Aufteilung der gelsten Fraktion in leicht und schwer abbaubar  
      alphlD = 0.218*log(vcb)+0.717 
      if(alphlD.lt.0.0)alphlD = 0.0 
      CD1s(mstr,mRB) = CDges*alphlD 
      CD2s(mstr,mRB) = CDges*(1.-alphlD) 
!.......Aufteilung der part. Fraktion in leicht und schwer abbaubar     
      CPges = BTOCs*(1.-alphaD) 
      BACs(mstr,mRB) = CPges*antBAC 
      CPges = CPges-BACs(mstr,mRB) 
      alphlP = 0.4258*log(vcb)+1.114 
      if(alphlP.lt.0.0)alphlP = 0.0 
      CP1s(mstr,mRB) = CPges*alphlP 
      CP2s(mstr,mRB) = CPges*(1.-alphlP) 
!....Verringerung der einzelnen Fraktionen aufrund von HNF              
      CD1s(mstr,mRB) = CD1s(mstr,mRB)-0.2*CHNFs(mstr,mRB) 
      CD2s(mstr,mRB) = CD2s(mstr,mRB)-0.2*CHNFs(mstr,mRB) 
      CP1s(mstr,mRB) = CP1s(mstr,mRB)-0.2*CHNFs(mstr,mRB) 
      CP2s(mstr,mRB) = CP2s(mstr,mRB)-0.2*CHNFs(mstr,mRB) 
      if(CD1s(mstr,mRB).le.0.0)CD1s(mstr,mRB) = 0.000001 
      if(CD2s(mstr,mRB).le.0.0)CD2s(mstr,mRB) = 0.000001 
      if(CP1s(mstr,mRB).le.0.0)CP1s(mstr,mRB) = 0.000001 
      if(CP2s(mstr,mRB).le.0.0)CP2s(mstr,mRB) = 0.000001 
!                                                                       
!                                                                       
!....Berechnung der Komponenten fuer BSB5                               
      bx1 = alphaD*alphlD+(1.-antBAC)*(1-alphaD)*alphlP                 &
     &+antBAC*(1.-alphaD)*0.4                                           
      if(bx1.gt.1.)bx1 = 1. 
      bx2 = (1.-bx1) 
      hcon = 1.-(bx1*exp(-bk1*5.)+bx2*exp(-bk2*5.)) 
      BL0s = obsbs(mstr,mRB)/hcon 
      O2BSBs(mstr,mRB) = BL0s/BTOCs 
      bl01s(mstr,mRB) = bl0s*bx1 
      bl02s(mstr,mRB) = bl0s*bx2 
!....Berechnung von nL0 und pL0 (N und P Gehalt der Abwasserbuertigen   
!    org Substanz)                                                      
!                                                                       
      hcsum = agrs(mstr,mRB)+akis(mstr,mRB)+abls(mstr,mRB)              &
     &+zooins(mstr,mRB)+vnh4s(mstr,mRB)+vno2s(mstr,mRB)                 &
     &+vno3s(mstr,mRB)                                                  
      hcsumP = agrs(mstr,mRB)+akis(mstr,mRB)+abls(mstr,mRB)             &
     &+zooins(mstr,mRB)+gelPs(mstr,mRB)                                 
!                                                                       
      if(gesNs(mstr,mRB).lt.0.0)goto 831 
      orgN = gesNs(mstr,mRB)-(agrs(mstr,mRB)*Q_NGs(mstr,mRB)            &
     &+abls(mstr,mRB)*Q_NBs(mstr,mRB)+akis(mstr,mRB)*Q_NKs(mstr,mRB)    &
     &+(zooins(mstr,mRB)*GRote/1000.)*nZoo                              &
     &+vnh4s(mstr,mRB)+vno2s(mstr,mRB)+vno3s(mstr,mRB))                 
      nl0s(mstr,mRB) = orgN/(ocsbs(mstr,mRB)/2.8) 
      if(nl0s(mstr,mRB).gt.0.04)goto 833 
!                                                                       
      nl0s(mstr,mRB) = 0.04 
      orgN = nl0s(mstr,mRB)*(ocsbs(mstr,mRB)/2.8) 
      akiNmx = akis(mstr,mRB)*Q_NKs(mstr,mRB) 
      agrNmx = agrs(mstr,mRB)*Q_NGs(mstr,mRB) 
      ablNmx = abls(mstr,mRB)*Q_NBs(mstr,mRB) 
      algNmx = akiNmx+agrNmx+ablNmx 
      gsN = algNmx+orgN+(zooins(mstr,mRB)*GRote/1000.)*nZoo             &
     &+vnh4s(mstr,mRB)+vno2s(mstr,mRB)+vno3s(mstr,mRB)                  
      dgsN = gsN-gesNs(mstr,mRB) 
      dalgN = algNmx-dgsN 
      if(algNmx.gt.0.0)faNneu = dalgN/algNmx 
      if(algNmx.eq.0.0)faNneu = 0.0 
!                                                                       
      Q_NKs(mstr,mRB) = Q_NKs(mstr,mRB)*faNneu 
      Q_NGs(mstr,mRB) = Q_NGs(mstr,mRB)*faNneu 
      Q_NBs(mstr,mRB) = Q_NBs(mstr,mRB)*faNneu 
!                                                                       
      if(Q_NKs(mstr,mRB).lt.Qmn_NK)Q_NKs(mstr,mRB) = Qmn_NK 
      if(Q_NGs(mstr,mRB).lt.Qmn_NG)Q_NGs(mstr,mRB) = Qmn_NG 
      if(Q_NBs(mstr,mRB).lt.Qmn_NB)Q_NBs(mstr,mRB) = Qmn_NB 
      goto 833 
!                                                                       
  831 continue 
!....kein gesN am oberen Profil vorhanden wird errechnet!!              
!                                                                       
      nl0s(mstr,mRB) = 0.04 
      orgN1 = (ocsbs(mstr,mRB)/2.8)*nl0s(mstr,mRB) 
      orgN2 = agrs(mstr,mRB)*Q_NGs(mstr,mRB)                            &
     &+abls(mstr,mRB)*Q_NBs(mstr,mRB)+akis(mstr,mRB)*Q_NKs(mstr,mRB)    &
     &+(zooins(mstr,mRB)*GRote/1000.)*nZoo                              
      gesNs(mstr,mRB) = orgN1+orgN2+vnh4s(mstr,mRB)+vno2s(mstr,mRB)     &
     &+vno3s(mstr,mRB)                                                  
!                                                                       
      if(hcsum.eq.0.0)then 
      nl0s(mstr,mRB) = -1. 
      gesNs(mstr,mRB) = -1. 
      endif 
!                                                                       
  833 if(gesPs(mstr,mRB).lt.0.0)goto 832 
      orgP = gesPs(mstr,mRB)-(agrs(mstr,mRB)*Q_PGs(mstr,mRB)            &
     &+abls(mstr,mRB)*Q_PBs(mstr,mRB)+akis(mstr,mRB)*Q_PKs(mstr,mRB)    &
     &+(zooins(mstr,mRB)*GRote/1000.)*pZoo+gelps(mstr,mRB))             
      pl0s(mstr,mRB) = orgP/(ocsbs(mstr,mRB)/2.8) 
      if(pl0s(mstr,mRB).gt.0.005)goto 834 
!                                                                       
      pl0s(mstr,mRB) = 0.005 
      orgP = pl0s(mstr,mRB)*(ocsbs(mstr,mRB)/2.8) 
      akiPmx = akis(mstr,mRB)*Q_PKs(mstr,mRB) 
      agrPmx = agrs(mstr,mRB)*Q_PGs(mstr,mRB) 
      ablPmx = abls(mstr,mRB)*Q_PBs(mstr,mRB) 
      algPmx = akiPmx+agrPmx+ablPmx 
      gsP = algPmx+orgP+(zooins(mstr,mRB)*GRote/1000.)*pZoo             &
     &+gelps(mstr,mRB)                                                  
      dgsP = gsP-gesPs(mstr,mRB) 
      dalgP = algPmx-dgsP 
      if(algPmx.gt.0.0)faPneu = dalgP/algPmx 
      if(algPmx.eq.0.0)faPneu = 0.0 
      Q_PKs(mstr,mRB) = Q_PKs(mstr,mRB)*faPneu 
      Q_PGs(mstr,mRB) = Q_PGs(mstr,mRB)*faPneu 
      Q_PBs(mstr,mRB) = Q_PBs(mstr,mRB)*faPneu 
!                                                                       
      if(Q_PKs(mstr,mRB).lt.Qmn_PK)Q_PKs(mstr,mRB) = Qmn_PK 
      if(Q_PGs(mstr,mRB).lt.Qmn_PG)Q_PGs(mstr,mRB) = Qmn_PG 
      if(Q_PBs(mstr,mRB).lt.Qmn_PB)Q_PBs(mstr,mRB) = Qmn_PB 
!                                                                       
      goto 834 
!                                                                       
  832 continue 
!....kein gesP am oberen Profil vorhanden wird errechnet!!              
!                                                                       
      pl0s(mstr,mRB) = 0.01 
      orgP1 = (ocsbs(mstr,mRB)/2.8)*pl0s(mstr,mRB) 
      orgP2 = agrs(mstr,mRB)*Q_PGs(mstr,mRB)                            &
     &+abls(mstr,mRB)*Q_PBs(mstr,mRB)+akis(mstr,mRB)*Q_PKs(mstr,mRB)    &
     &+(zooins(mstr,mRB)*GRote/1000.)*pZoo                              
      gesPs(mstr,mRB) = orgP1+orgP2+gelps(mstr,mRB) 
!                                                                       
      if(hcsumP.eq.0.0)then 
      pl0s(mstr,mRB) = -1. 
      gesPs(mstr,mRB) = -1. 
      endif 
!                                                                       
  834 sss(mstr,mRB) = ssalgs(mstr,mRB)-akis(mstr,mRB)-agrs(mstr,mRB)    &
     &-abls(mstr,mRB)-(zooins(mstr,mRB)*GRote/1000.)                    
      if(sss(mstr,mRB).lt.1.0)sss(mstr,mRB) = 1. 
      chlaks(mstr,mRB) = chlas(mstr,mRB)*vkigrs(mstr,mRB) 
      chlabs(mstr,mRB) = chlas(mstr,mRB)*antbls(mstr,mRB) 
      chlags(mstr,mRB) = chlas(mstr,mRB)*(1.-vkigrs(mstr,mRB)           &
     &-antbls(mstr,mRB))                                                
!                                                                       
      zooins(mstr,mRB) = hczoos 
      vnh4s(mstr,mRB) = hcnh4s 
      vno2s(mstr,mRB) = hcno2s 
      vno3s(mstr,mRB) = hcno3s 
      gelPs(mstr,mRB) = hcgePs 
      vbsbs(mstr,mRB) = hcbsb 
      vcsbs(mstr,mRB) = hccsb 
      chlas(mstr,mRB) = hcchla 
      vkigrs(mstr,mRB) = hcvkg 
      antbls(mstr,mRB) = hcantb 
      if(RBTyp(mstr,mRB).eq.2.and.hcbsb.lt.0.0                          &
     &.and.hccsb.lt.0.0)then                                            
                                                                        
      CD1s(mstr,mRB) = -1. 
      CD2s(mstr,mRB) = -1. 
      CP1s(mstr,mRB) = -1. 
      CP2s(mstr,mRB) = -1. 
      O2BSBs(mstr,mRB) = -1. 
      bl01s(mstr,mRB) = -1. 
      bl02s(mstr,mRB) = -1. 
      obsbs(mstr,mRB) = -1. 
      ocsbs(mstr,mRB) = -1. 
      endif 
      if(RBTyp(mstr,mRB).eq.2.and.hcchla.lt.0.0)                        &
     &then                                                              
      akis(mstr,mRB) = -1. 
      abls(mstr,mRB) = -1. 
      agrs(mstr,mRB) = -1. 
      endif 
!                                                                       
      if(iph.eq.0)goto 721 
!                                                                       
      if(RBtyp(mstr,mRB).eq.1.or.NRschr(mstr,mRB).eq.0)goto 721 
                                                                        
!     Berechnung des p-Wertes am Start (ohne Algen)                     
!                                                                       
      call pwert(mws,vphs,lfs,tempws,pws,mRB,mstr) 
!                                                                       
!     Berechnung des pH-Wertes und p-Wertes am Start unter Algeneinfluss
!                                                                       
!      call phstart(mws,pws,lfs,chlas,vkigrs,agbcms,akbcms,vphs         
!     *,tempws,abbcms,antbls,mstr,mRB)                                  
!                                                                       
  721 continue 
  720 continue 
!                                                                       
  396 continue 
!.....2D-Modellierung                                                   
!.....Ermittlung der Anzahl der vertikalen Schichten fr jeden          
!.....Knotenpunkt in jedem Strang                                       
!                                                                       
!                                                                       
      open(unit=11, DEFAULTFILE=cpfad, file='sysgenou') 
      rewind (11) 
!                                                                       
      nkzsmx = 0 
      do 736 azStr = 1,azStrs 
      mstr = mstra(azStr) 
      i2D = 1 
!....Umdrehen bei Rueckstroemung                                        
!                                                                       
      if(iFlRi(mstr).ne.(-1))goto 803 
      if(i2Ds(mstr).eq.0)goto 803 
      jR = 0 
      do 806 i2D = i2Ds(mstr),1,-1 
      jR = jR+1 
      akm2Dz(jR) = afkm2D(mstr,i2D) 
      ekm2Dz(jR) = efkm2D(mstr,i2D) 
  806 continue 
!                                                                       
      do 805 i2D = 1,i2Ds(mstr) 
      afkm2D(mstr,i2D) = ekm2Dz(i2D) 
      efkm2D(mstr,i2D) = akm2Dz(i2D) 
  805 continue 
      i2D = 1 
!                                                                       
      zabfr = abfr(mstr) 
      if(abfr(mstr).eq.0)then 
      abfr(mstr) = 1 
      goto 803 
      endif 
      if(abfr(mstr).eq.1)abfr(mstr) = 0 
!                                                                       
!                                                                       
  803 read(11,1000)hanze(mstr) 
!                                                                       
      do 576 ior = 1,hanze(mstr) 
      read(11,1011)fkm(ior),tiefe(ior) 
!....Ruecksetzen                                                        
      hnkzs(mstr,ior) = 1 
      hdH2De(mstr,ior) = 0.0 
!                                                                       
!                                                                       
      if(i2Ds(mstr).eq.0.or.i2D.gt.i2Ds(mstr))then 
      hnkzs(mstr,ior) = 1 
      goto 576 
      endif 
!                                                                       
      if(abfr(mstr).eq.1)goto 577 
      hnkzs(mstr,ior) = 1 
      if(fkm(ior).lt.efkm2D(mstr,i2D))i2D = i2D+1 
      if(i2D.gt.i2Ds(mstr))goto 576 
      if(fkm(ior).le.afkm2D(mstr,i2D)                                   &
     &.and.fkm(ior).ge.efkm2D(mstr,i2D))then                            
      hnkzs(mstr,ior) = int(tiefe(ior)/dH2D) 
      testH = tiefe(ior)-hnkzs(mstr,ior)*dH2D 
      hdH2De(mstr,ior) = 0.0 
!                                                                       
      if(testH.gt.0.02)then 
      hdH2De(mstr,ior) = testH 
      hnkzs(mstr,ior) = hnkzs(mstr,ior)+1 
      endif 
!                                                                       
      hnkzs(mstr,ior) = hnkzs(mstr,ior)+1 
      goto 576 
      endif 
      goto 576 
!                                                                       
  577 continue 
      hnkzs(mstr,ior) = 1 
      if(fkm(ior).gt.efkm2D(mstr,i2D))i2D = i2D+1 
      if(i2D.gt.i2Ds(mstr))goto 576 
      if(fkm(ior).ge.afkm2D(mstr,i2D)                                   &
     &.and.fkm(ior).le.efkm2D(mstr,i2D))then                            
      hnkzs(mstr,ior) = int(tiefe(ior)/dH2D) 
      testH = tiefe(ior)-hnkzs(mstr,ior)*dH2D 
      hdH2De(mstr,ior) = 0.0 
!                                                                       
      if(testH.gt.0.02)then 
      hnkzs(mstr,ior) = hnkzs(mstr,ior)+1 
      hdH2De(mstr,ior) = testH 
      endif 
!                                                                       
      hnkzs(mstr,ior) = hnkzs(mstr,ior)+1 
      goto 576 
      endif 
!                                                                       
  576 continue 
!                                                                       
      hnkzs(mstr,hanze(mstr)+1) = hnkzs(mstr,hanze(mstr)) 
      hdH2De(mstr,hanze(mstr)+1) = hdH2De(mstr,hanze(mstr)) 
!                                                                       
!...maximale Schichtenanzahl fuer den Anfang und das Ende der einzelnen 
      if(hnkzs(mstr,1).gt.nkzsmx)nkzsmx = hnkzs(mstr,1) 
      if(hnkzs(mstr,hanze(mstr)+1).gt.nkzsmx)                           &
     &nkzsmx = hnkzs(mstr,hanze(mstr)+1)                                
!                                                                       
!                                                                       
!   nur bei Rueckstroemung                                              
!                                                                       
      if(iFlRi(mstr).ne.(-1))goto 736 
      if(i2Ds(mstr).eq.0)goto 736 
      jR = 0 
      do 811 i2D = i2Ds(mstr),1,-1 
      jR = jR+1 
      akm2Dz(jR) = afkm2D(mstr,i2D) 
      ekm2Dz(jR) = efkm2D(mstr,i2D) 
  811 continue 
!                                                                       
      do 812 i2D = 1,i2Ds(mstr) 
      afkm2D(mstr,i2D) = ekm2Dz(i2D) 
      efkm2D(mstr,i2D) = akm2Dz(i2D) 
  812 continue 
!                                                                       
      jR = 0 
      do 824 ior = hanze(mstr)+1,1,-1 
      jR = jR+1 
      hnkzsz(jR) = hnkzs(mstr,ior) 
  824 hdh2ez(jR) = hdH2De(mstr,ior) 
!                                                                       
      do 825 ior = 1,hanze(mstr)+1 
      hnkzs(mstr,ior) = hnkzsz(ior) 
  825 hdH2De(mstr,ior) = hdh2ez(ior) 
!                                                                       
      abfr(mstr) = zabfr 
!                                                                       
!                                                                       
  736 continue 
!                                                                       
!                                                                       
 1011 format(f8.3,28x,f5.2) 
      close (11) 
!                                                                       
!....Ermittlung von SA und SU                                           
!                                                                       
      call sasu(itags,monats,geob,geol,sa,su,zg,zlk,dk,tdj) 
!                                                                       
!                                                                       
!...  Ermittlung der Wehrhoehen bei Vorgabe von O2OW und O2UW           
!                                                                       
      if(iwsim.eq.2)goto 876 
!                                                                       
      call WEHRLES(itags,monats,Jahrs,itagr,monatr                      &
     &,jahrr,uhrzr,wertwe,uhrz,wehrh,wehrb,azStrs,mStra                 &
     &,wehrts,io2Ws,ISWEHR,jlWO2,janzWt)                                
!                                                                       
  876 continue 
!                                                                       
! ..Ermittlung der Wetterdaten fr den Zeitschritt                      
                                                                        
 9191 continue 
      if(iwsim.eq.4)goto 344 
      hconuh = uhrz 
      uhrn = uhrz+tflie*24. 
      call wettles(itags,monats,jahrs,uhrz,uhrn,itagw,monatw,jahrw,uhrzw&
     &,wertw,glob,tlmax,tlmin,ro,wge,cloud,typw,mwetts                  &
     &,imet,iWSta,iwetts)                                               
!                                                                       
      uhrz = hconuh 
!                                                                       
  344 continue 
!                                                                       
!                                                                       
!...Strangschleife  fr Einlesen der Einleiterdaten und Randbedingungen 
!                                                                       
      istr = istr+1 
      if(istr.gt.istrs)goto 656 
!                                                                       
      mstr = STRNR(istr) 
      istep1 = 1 
!                                                                       
!     Einlesen der Einleitungsdaten                                     
!                                                                       
      iein = 0 
      ieinL = 0 
      jRB = 1 
      kk = 0 
      if(RBtyp(mstr,1).eq.0)kk = 1 
      jRBe = mRBs(mstr) 
      istep = 1 
!                                                                       
!      if(abfr(mstr).eq.1)then                                          
!      jRB = mRBs(mstr)                                                 
!      jRBe = 1                                                         
!      istep = -1                                                       
!      endif                                                            
!                                                                       
                                                                        
!                                                                       
      mRB_1 = 0 
      do 852 mRB = jRB,jRBe,istep 
      if(RBtyp(mstr,mRB).eq.2)mRB_1 = mRB 
      if(RBtyp(mstr,mRB).eq.0.or.RBtyp(mstr,mRB).eq.2)                  &
     &goto 852                                                          
!                                                                       
!Abfrage ob Diffuse Einleitung                                          
      if(RBkmLe(mstr,mRB).gt.0.0)goto 863 
      iein = iein+1 
      kk = kk+1 
      einlkh(mstr,iein) = RBkm(mstr,kk) 
      qeinlh(mstr,iein) = abfls(mstr,mRB) 
      ebsbh(mstr,iein) = vbsbs(mstr,mRB) 
      ecsbh(mstr,iein) = vcsbs(mstr,mRB) 
      enh4h(mstr,iein) = vnh4s(mstr,mRB) 
      eno2h(mstr,iein) = vno2s(mstr,mRB) 
      eno3h(mstr,iein) = vno3s(mstr,mRB) 
      egesNh(mstr,iein) = gesNs(mstr,mRB) 
      ex0h(mstr,iein) = vx0s(mstr,mRB) 
      ex02h(mstr,iein) = vx02s(mstr,mRB) 
      egph(mstr,iein) = gelps(mstr,mRB) 
      egesPh(mstr,iein) = gesPs(mstr,mRB) 
      esih(mstr,iein) = sis(mstr,mRB) 
      echlah(mstr,iein) = chlas(mstr,mRB) 
      evkgh(mstr,iein) = vkigrs(mstr,mRB) 
      eantbh(mstr,iein) = antbls(mstr,mRB) 
      ezindh(mstr,iein) = zooins(mstr,mRB) 
      ephh(mstr,iein) = vphs(mstr,mRB) 
      emwh(mstr,iein) = mws(mstr,mRB) 
      ecah(mstr,iein) = cas(mstr,mRB) 
      elfh(mstr,iein) = lfs(mstr,mRB) 
      essh(mstr,iein) = ssalgs(mstr,mRB) 
      etemph(mstr,iein) = tempws(mstr,mRB) 
      eo2h(mstr,iein) = vo2s(mstr,mRB) 
      eCHNFh(mstr,iein) = CHNFs(mstr,mRB) 
      eBVHNh(mstr,iein) = BVHNFs(mstr,mRB) 
      ecolih(mstr,iein) = colis(mstr,mRB) 
      ewaerh(mstr,iein) = waers(mstr,mRB) 
      typh(mstr,iein) = weinl(mstr,mRB) 
      enl0h(mstr,iein) = nl0s(mstr,mRB) 
      epl0h(mstr,iein) = pl0s(mstr,mRB) 
      goto 852 
!                                                                       
!....Diffuse Einleitung                                                 
  863 ieinL = ieinL+1 
      qLh(mstr,ieinL) = abfls(mstr,mRB)/WirkLL(mstr,ieinL) 
      bsbLh(mstr,ieinL) = vbsbs(mstr,mRB) 
      csbLh(mstr,ieinL) = vcsbs(mstr,mRB) 
      enh4Lh(mstr,ieinL) = vnh4s(mstr,mRB) 
      eno2Lh(mstr,ieinL) = vno2s(mstr,mRB) 
      eno3Lh(mstr,ieinL) = vno3s(mstr,mRB) 
      gesNLh(mstr,ieinL) = gesNs(mstr,mRB) 
      x0Lh(mstr,ieinL) = vx0s(mstr,mRB) 
      x02Lh(mstr,ieinL) = vx02s(mstr,mRB) 
      gpLh(mstr,ieinL) = gelps(mstr,mRB) 
      gesPLh(mstr,ieinL) = gesPs(mstr,mRB) 
      siLh(mstr,ieinL) = sis(mstr,mRB) 
      phLh(mstr,ieinL) = vphs(mstr,mRB) 
      caLh(mstr,ieinL) = cas(mstr,mRB) 
      elfLh(mstr,ieinL) = lfs(mstr,mRB) 
      ssLh(mstr,ieinL) = ssalgs(mstr,mRB) 
      tempLh(mstr,ieinL) = tempws(mstr,mRB) 
      o2Lh(mstr,ieinL) = vo2s(mstr,mRB) 
      coliLh(mstr,ieinL) = colis(mstr,mRB) 
      enl0Lh(mstr,ieinL) = nl0s(mstr,mRB) 
      pl0Lh(mstr,ieinL) = pl0s(mstr,mRB) 
  852 continue 
!                                                                       
      ieinsh(mstr) = iein 
      ieinLs(mstr)= ieinL 
!                                                                       
!hier loschen                                                           
!      if(iflRi(mstr).eq.0.and.iwied.eq.1.and.iwsim.ne.4)goto 158       
      iB = 1 
      if(iFlRi(mstr).ne.-1)goto 591 
!                                                                       
!..falls Fliessumkehr schon direkt zu Beginn der Simulation wird der ges
!..mit dem ersten Zeitschrittwert der oberen Randbedingung belegt.      
      iB = hanze(mstr)+1 
      anzej = hanze(mstr)+1 
      if(iwied.eq.0)then 
      anzej = 1 
      istep1 = -1 
      endif 
      goto 590 
!                                                                       
  591 anzej = hanze(mstr)+1 
      if(iwied.eq.1.or.iwsim.eq.4)anzej = 1 
!                                                                       
!      if(iwied.eq.0)goto 144                                           
  590 if(nstrs(istr).eq.0)goto 144 
      if(nstrs(istr).gt.0)goto 146 
!                                                                       
  144 continue 
!...mRand Schalter zur Überpüfung ob eine Headwater-Randbedingung       
!   am Strang vorhanden ist.                                            
      mRand = 0 
!                                                                       
      do 150 mRB = 1,mRBs(mstr) 
      if(RBtyp(mstr,mRB).eq.0.or.RBtyp(mstr,mRB).eq.2)then 
      mRand = 1 
      goto 153 
      endif 
  150 continue 
!                                                                       
  153 continue 
!....Fließumkehr;unteres Strangende wird mit dem Ergebnis des letzten Ze
!...belegt.Bei RBtyp(mstr,mRB)> 0 werden neue Randbedingungen aus der Da
!...RBtyp(mstr,mRB) = 2                                                 


      if(iflRi(mstr).eq.-1.and.iwied.eq.1                               &
     &.and.mRB_1.eq.0)goto 259                                          
!                                                                       
      do 5 ior=iB,anzej,istep1 
      mstr1 = mstr 
!.. ist keine Randbedingung am Strang vorhanden, wird beim ersten Zeitsc
!   die Werte der Randbedingung des letzten Strangs im Simulationsgebiet
!   benutzt. Für die weiteren Zeitschritte (iwied = 1) erfolgt keine neu
!   obern Rands (goto 5)                                                
      if(iwied.eq.0.and.mRand.eq.0)mstr1 = mstrRB 
      if(iwied.eq.1.and.mRand.eq.0)goto 5 
      if(iwied.eq.1.and.iflRi(mstr).eq.-1)mRB = mRB_1 
!                                                                       
      hsvhk(mstr,ior) = 0.0 
      hsvhg(mstr,ior) = 0.0 
      hsvhb(mstr,ior) = 0.0 
!      hDOSCF(mstr,ior) = 0.0                                           
      hfssgr(mstr,ior) = fssgrs 
      hfbsgr(mstr,ior) = fbsgrs 
      hfrfgr(mstr,ior) = frfgrs 
      hsised(mstr,ior) = 0.0 
!      hSKmor(mstr,ior) = 0.0                                           
      hdlarn(mstr,ior) = 0.0 
      hstind(mstr,ior) = 0.0 
!                                                                       
      hakbcm(mstr,ior) = akbcms(mstr1,mRB) 
      hagbcm(mstr,ior) = agbcms(mstr1,mRB) 
      habbcm(mstr,ior) = abbcms(mstr1,mRB) 
!                                                                       
                                                                        
      if(RBtyp(mstr,mRB).eq.0)then 
        Wtst = -1. 
        Wtst_T = -100. 
          else 
            Wtst = 0.0 
            Wtst_T = -99.99 
      endif 
                                                                        
      if(nl0s(mstr1,mRB).gt.0.0)hnl0(mstr,ior) = nl0s(mstr1,mRB) 
      if(pl0s(mstr1,mRB).gt.0.0)hpl0(mstr,ior) = pl0s(mstr1,mRB) 
      if(gesNs(mstr1,mRB).ge.0.0)hgesN(mstr,ior) = gesNs(mstr1,mRB) 
      if(gesPs(mstr1,mRB).ge.0.0)hgesP(mstr,ior) = gesPs(mstr1,mRB) 
      if(Q_NKs(mstr1,mRB).gt.0.0)hQ_NK(mstr,ior) = Q_NKs(mstr1,mRB) 
      if(Q_PKs(mstr1,mRB).gt.0.0)hQ_PK(mstr,ior) = Q_PKs(mstr1,mRB) 
      if(Q_SKs(mstr1,mRB).gt.0.0)hQ_SK(mstr,ior) = Q_SKs(mstr1,mRB) 
      if(Q_NGs(mstr1,mRB).gt.0.0)hQ_NG(mstr,ior) = Q_NGs(mstr1,mRB) 
      if(Q_PGs(mstr1,mRB).gt.0.0)hQ_PG(mstr,ior) = Q_PGs(mstr1,mRB) 
      if(Q_NBs(mstr1,mRB).gt.0.0)hQ_NB(mstr,ior) = Q_NBs(mstr1,mRB) 
      if(Q_PBs(mstr1,mRB).gt.0.0)hQ_PB(mstr,ior) = Q_PBs(mstr1,mRB) 
      if(tempws(mstr1,mRB).gt.Wtst_T)                                   &
     &htempw(mstr,ior) = tempws(mstr1,mRB)                              
!...Festlegung der Anfangs-Sedimenttemperatur Tsed = TWasser            
      if(iwied.eq.0)hTsed(mstr,ior) = htempw(mstr,ior) 
      if(obsbs(mstr1,mRB).ge.Wtst)hbsb(mstr,ior) = obsbs(mstr1,mRB) 
      if(ocsbs(mstr1,mRB).ge.Wtst)hcsb(mstr,ior) = ocsbs(mstr1,mRB) 
      if(CHNFs(mstr1,mRB).ge.Wtst)hCHNF(mstr,ior) = CHNFs(mstr1,mRB) 
      if(BVHNFs(mstr1,mRB).ge.Wtst)hBVHNF(mstr,ior) = BVHNFs(mstr1,mRB) 
      if(CD1s(mstr1,mRB).ge.Wtst)hCD(mstr,1,ior) = CD1s(mstr1,mRB) 
      if(CD2s(mstr1,mRB).ge.Wtst)hCD(mstr,2,ior) = CD2s(mstr1,mRB) 
      if(CP1s(mstr1,mRB).ge.Wtst)hCP(mstr,1,ior) = CP1s(mstr1,mRB) 
      if(CP2s(mstr1,mRB).ge.Wtst)hCP(mstr,2,ior) = CP2s(mstr1,mRB) 
      if(CMs(mstr1,mRB).ge.Wtst)hCM(mstr,ior) = CMs(mstr1,mRB) 
      if(BACs(mstr1,mRB).ge.Wtst)hBAC(mstr,ior) = BACs(mstr1,mRB) 
      if(O2BSBs(mstr1,mRB).ge.Wtst)hO2BSB(mstr,ior) = O2BSBs(mstr1,mRB) 
      if(bl01s(mstr1,mRB).ge.Wtst)hbl01(mstr,ior) = bl01s(mstr1,mRB) 
      if(bl02s(mstr1,mRB).ge.Wtst)hbl02(mstr,ior) = bl02s(mstr1,mRB) 
      if(vnh4s(mstr1,mRB).ge.Wtst)hnh4(mstr,ior) = vnh4s(mstr1,mRB) 
      if(vo2s(mstr1,mRB).ge.Wtst)ho2(mstr,ior) = vo2s(mstr1,mRB) 
      if(vno3s(mstr1,mRB).ge.Wtst)hno3(mstr,ior) = vno3s(mstr1,mRB) 
      if(vno2s(mstr1,mRB).ge.Wtst)hno2(mstr,ior) = vno2s(mstr1,mRB) 
      if(vx0s(mstr1,mRB).ge.Wtst)hx0(mstr,ior) = vx0s(mstr1,mRB) 
      if(vx02s(mstr1,mRB).ge.Wtst)hx02(mstr,ior) = vx02s(mstr1,mRB) 
      if(sis(mstr1,mRB).ge.Wtst)hsi(mstr,ior) = sis(mstr1,mRB) 
      if(chlas(mstr1,mRB).ge.Wtst)hchla(mstr,ior) = chlas(mstr1,mRB) 
      if(akis(mstr1,mRB).ge.Wtst)haki(mstr,ior) = akis(mstr1,mRB) 
      if(agrs(mstr1,mRB).ge.Wtst)hagr(mstr,ior) = agrs(mstr1,mRB) 
      if(abls(mstr1,mRB).ge.Wtst)habl(mstr,ior) = abls(mstr1,mRB) 
      if(chlaks(mstr1,mRB).ge.Wtst)hchlak(mstr,ior) = chlaks(mstr1,mRB) 
      if(chlags(mstr1,mRB).ge.Wtst)hchlag(mstr,ior) = chlags(mstr1,mRB) 
      if(chlabs(mstr1,mRB).ge.Wtst)hchlab(mstr,ior) = chlabs(mstr1,mRB) 
      if(vkigrs(mstr1,mRB).ge.Wtst)hvkigr(mstr,ior) = vkigrs(mstr1,mRB) 
      if(antbls(mstr1,mRB).ge.Wtst)hantbl(mstr,ior) = antbls(mstr1,mRB) 
      habrz1(mstr,ior) = 0.0 
      if(ssalgs(mstr1,mRB).ge.Wtst)hssalg(mstr,ior) = ssalgs(mstr1,mRB) 
      if(sss(mstr1,mRB).ge.Wtst)hss(mstr,ior) = sss(mstr1,mRB) 
      if(zooins(mstr1,mRB).ge.Wtst)hzooi(mstr,ior) = zooins(mstr1,mRB) 
      if(gelps(mstr1,mRB).ge.Wtst)hgelp(mstr,ior) = gelps(mstr1,mRB) 
      if(mws(mstr1,mRB).ge.Wtst)hmw(mstr,ior) = mws(mstr1,mRB) 
      if(mws(mstr1,mRB).ge.Wtst)hpw(mstr,ior) = pws(mstr1,mRB) 
      if(cas(mstr1,mRB).ge.Wtst)hca(mstr,ior) = cas(mstr1,mRB) 
      if(lfs(mstr1,mRB).ge.Wtst)hlf(mstr,ior) = lfs(mstr1,mRB) 
      if(vphs(mstr1,mRB).ge.Wtst)hph(mstr,ior) = vphs(mstr1,mRB) 
      if(colis(mstr1,mRB).ge.Wtst)hcoli(mstr,ior) = colis(mstr1,mRB) 
      if(gesPs(mstr1,mRB).ge.Wtst)hgesP(mstr,ior) = gesPs(mstr1,mRB) 
      if(gesNs(mstr1,mRB).ge.Wtst)hgesN(mstr,ior) = gesNs(mstr1,mRB) 
! ende                                                                  
!....nur Tracer                                                         
      if(iwsim.eq.4)goto 5 
      algb5 = hchla(mstr,ior)*hvkigr(mstr,ior)*bsbki                    &
     &+hchla(mstr,ior)*hantbl(mstr,ior)*bsbbl                           &
     &+hchla(mstr,ior)*(1.-hvkigr(mstr,ior)-hantbl(mstr,ior))*bsbgr     
      hvbsb(mstr,ior) = hbsb(mstr,ior)+algb5 
      zoobsb = (hzooi(mstr,ior)*GRote/1000.)*1.35 
      hvbsb(mstr,ior) = hvbsb(mstr,ior)+zoobsb 
!                                                                       
      algcs = hchla(mstr,ior)*hvkigr(mstr,ior)*csbki                    &
     &+hchla(mstr,ior)*hantbl(mstr,ior)*csbbl                           &
     &+hchla(mstr,ior)*(1.-hvkigr(mstr,ior)-hantbl(mstr,ior))*csbgr     
      hvcsb(mstr,ior) = hcsb(mstr,ior)+algcs 
      zoocsb = hzooi(mstr,ior)*(GRote/1000.)*1.5*1.08 
      hvcsb(mstr,ior) = hvcsb(mstr,ior)+zoocsb 
!                                                                       
!     Belegung des Gitters bei 2D-Modellierung                          
!                                                                       
      do 579 nkz = 1,hnkzs(mstr,ior) 
      if(tempws(mstr1,mRB).gt.(-99.99))                                 &
     &htempz(mstr,nkz,ior) = tempws(mstr1,mRB)                          
      if(vnh4s(mstr1,mRB).ge.Wtst)hnh4z(mstr,nkz,ior) = vnh4s(mstr1,mRB) 
      if(vno2s(mstr1,mRB).ge.Wtst)hno2z(mstr,nkz,ior) = vno2s(mstr1,mRB) 
      if(vno3s(mstr1,mRB).ge.Wtst)hno3z(mstr,nkz,ior) = vno3s(mstr1,mRB) 
      if(vo2s(mstr1,mRB).ge.Wtst)ho2z(mstr,nkz,ior) = vo2s(mstr1,mRB) 
      if(gelPs(mstr1,mRB).ge.Wtst)                                      &
     &hgelPz(mstr,nkz,ior) = gelPs(mstr1,mRB)                           
      if(Sis(mstr1,mRB).ge.Wtst)hsiz(mstr,nkz,ior) = Sis(mstr1,mRB) 
      if(akis(mstr1,mRB).ge.Wtst)hakiz(mstr,nkz,ior) = akis(mstr1,mRB) 
      if(agrs(mstr1,mRB).ge.Wtst)hagrz(mstr,nkz,ior) = agrs(mstr1,mRB) 
      if(abls(mstr1,mRB).ge.Wtst)hablz(mstr,nkz,ior) = abls(mstr1,mRB) 
      if(chlas(mstr1,mRB).ge.Wtst)                                      &
     &hchlaz(mstr,nkz,ior) = chlas(mstr1,mRB)                           
  579 continue 
!                                                                       
      if(nbuhn(mstr).eq.0.or.iwied.eq.1)goto 5 
!     Buhnenfelder                                                      
!                                                                       
      bsvhek(mstr,ior) = hsvhk(mstr,ior) 
      bsvheg(mstr,ior) = hsvhg(mstr,ior) 
      bakbcm(mstr,ior) = hakbcm(mstr,ior) 
      bagbcm(mstr,ior) = hagbcm(mstr,ior) 
      bnl0(mstr,ior) = hnl0(mstr,ior) 
      bpl0(mstr,ior) = hpl0(mstr,ior) 
      bgesN(mstr,ior) = hgesN(mstr,ior) 
      bgesP(mstr,ior) = hgesP(mstr,ior) 
      bstind(mstr,ior) = hstind(mstr,ior) 
      btempw(mstr,ior) = htempw(mstr,ior) 
!...Festlegung der Anfangs-Sedimenttemperatur Tsed = TWasser            
      if(iwied.eq.0)bTsed(mstr,ior) = htempw(mstr,ior) 
      bbsb(mstr,ior) = hbsb(mstr,ior) 
      bcsb(mstr,ior) = hcsb(mstr,ior) 
      bbl01(mstr,ior) = hbl01(mstr,ior) 
      bbl02(mstr,ior) = hbl02(mstr,ior) 
      bnh4(mstr,ior) = hnh4(mstr,ior) 
      bo2(mstr,ior) = ho2(mstr,ior) 
      bno3(mstr,ior) = hno3(mstr,ior) 
      bno2(mstr,ior) = hno2(mstr,ior) 
      bx0(mstr,ior) = hx0(mstr,ior) 
      bx02(mstr,ior) = hx02(mstr,ior) 
      bsi(mstr,ior) = hsi(mstr,ior) 
      bsised(mstr,ior) = hsised(mstr,ior) 
      bSKmor(mstr,ior) = hSKmor(mstr,ior) 
      bchla(mstr,ior) = hchla(mstr,ior) 
      baki(mstr,ior) = haki(mstr,ior) 
      bagr(mstr,ior) = hagr(mstr,ior) 
      babl(mstr,ior) = habl(mstr,ior) 
      bchlak(mstr,ior) = hchlak(mstr,ior) 
      bchlag(mstr,ior) = hchlag(mstr,ior) 
      bchlab(mstr,ior) = hchlab(mstr,ior) 
      bvkigr(mstr,ior) = hvkigr(mstr,ior) 
      bantbl(mstr,ior) = hantbl(mstr,ior) 
      babrz1(mstr,ior) = habrz1(mstr,ior) 
      bssalg(mstr,ior) = hssalg(mstr,ior) 
      bfssgr(mstr,ior) = hfssgr(mstr,ior) 
      bfbsgr(mstr,ior) = hfbsgr(mstr,ior) 
      bfrfgr(mstr,ior) = hfrfgr(mstr,ior) 
      bss(mstr,ior) = hss(mstr,ior) 
      bzooi(mstr,ior) = hzooi(mstr,ior) 
      bgelp(mstr,ior) = hgelp(mstr,ior) 
      bmw(mstr,ior) = hmw(mstr,ior) 
      bpw(mstr,ior) = hpw(mstr,ior) 
      bca(mstr,ior) = hca(mstr,ior) 
      blf(mstr,ior) =hlf(mstr,ior) 
      bdlarn(mstr,ior) = hdlarn(mstr,ior) 
      bph(mstr,ior) = hph(mstr,ior) 
      bvbsb(mstr,ior) = hvbsb(mstr,ior) 
      bvcsb(mstr,ior) = hvcsb(mstr,ior) 
      bCD(mstr,1,ior) = hCD(mstr,1,ior) 
      bCD(mstr,2,ior) = hCD(mstr,2,ior) 
      bCP(mstr,1,ior) = hCP(mstr,1,ior) 
      bCP(mstr,2,ior) = hCP(mstr,2,ior) 
      bCM(mstr,ior) = hCM(mstr,ior) 
      bBAC(mstr,ior) = hBAC(mstr,ior) 
      bO2BSB(mstr,ior) = hO2BSB(mstr,ior) 
      bQ_PK(mstr,ior) = hQ_PK(mstr,ior) 
      bQ_NK(mstr,ior) = hQ_NK(mstr,ior) 
      bQ_SK(mstr,ior) = hQ_SK(mstr,ior) 
      bQ_PG(mstr,ior) = hQ_PG(mstr,ior) 
      bQ_NG(mstr,ior) = hQ_NG(mstr,ior) 
      bQ_PB(mstr,ior) = hQ_PB(mstr,ior) 
      bQ_NB(mstr,ior) = hQ_NB(mstr,ior) 
                                                                        
!                                                                       
    5 continue 
  259 if(iwied.eq.0)then 
      ianze(mstr) = hanze(mstr)+1 
      endif 
      inkzmx = nkzsmx 
!                                                                       
!                                                                       
      goto 344 
!                                                                       
  146 hcs1 = 0.0 
      hcs2 = 0.0 
      hcs3 = 0.0 
      hcs6 = 0.0 
      hcs7 = 0.0 
      hcs8 = 0.0 
      hcs9 = 0.0 
      hcs10 = 0.0 
      hcs20 = 0.0 
      hcs21 = 0.0 
      hcs22 = 0.0 
      hcs23 = 0.0 
      hcs24 = 0.0 
      hcs25 = 0.0 
      hcs26 = 0.0 
      hcs27 = 0.0 
      hcs28 = 0.0 
      hcs29 = 0.0 
      hcs30 = 0.0 
      hcs31 = 0.0 
      hcs32 = 0.0 
      hcs33 = 0.0 
      hcs34 = 0.0 
      hcs35 = 0.0 
      hcs36 = 0.0 
      hcs37 = 0.0 
      hcs38 = 0.0 
      hcs39 = 0.0 
      hcs40 = 0.0 
      hcs41 = 0.0 
      hcs42 = 0.0 
      hcs43 = 0.0 
      hcs44 = 0.0 
      hcs45 = 0.0 
      hcs46 = 0.0 
      hcs47 = 0.0 
      hcs48 = 0.0 
      hcs49 = 0.0 
      hcs50 = 0.0 
      hcs51 = 0.0 
      hcs52 = 0.0 
      hcs53 = 0.0 
      hcs54 = 0.0 
      hcs55 = 0.0 
      hcs56 = 0.0 
      hcs57 = 0.0 
      hcs58 = 0.0 
      hcs59 = 0.0 
      hcs60 = 0.0 
      hcs61 = 0.0 
      hcs62 = 0.0 
      hcs63 = 0.0 
      hcs64 = 0.0 
      hcs65 = 0.0 
      hcs66 = 0.0 
!                                                                       
      do 525 nkz = 1,inkzmx 
!                                                                       
      hcs67(nkz) = 0.0 
      hcs68(nkz) = 0.0 
      hcs69(nkz) = 0.0 
      hcs70(nkz) = 0.0 
      hcs71(nkz) = 0.0 
      hcs72(nkz) = 0.0 
      hcs73(nkz) = 0.0 
      hcs74(nkz) = 0.0 
      hcs75(nkz) = 0.0 
      hcs76(nkz) = 0.0 
  525 hcs84(nkz) = 0.0 
!                                                                       
      hcs77 = 0.0 
      hcs78 = 0.0 
      hcs79 = 0.0 
      hcs80 = 0.0 
      hcs81 = 0.0 
      hcs82 = 0.0 
      hcs83 = 0.0 
      hcs85 = 0.0 
      hcs86 = 0.0 
!                                                                       
      hcq = 0.0 
!                                                                       
!                                                                       
      do 149 nstr = 1,nstrs(istr) 
!                                                                       
!                                                                       
!....jnkz = 1 > Werte am ersten Knoten im Strang                        
!....jnkz = 2 > Werte am letzten Knoten im Strang                       
      kanz = ianze(ESTRNR(istr,nstr)) 
      iSta = mStas(ESTRNR(istr,nstr)) 
      jnkz = 2 
!                                                                       
      if(iflRi(ESTRNR(istr,nstr)).eq.0)goto 149 
      if(iflRi(ESTRNR(istr,nstr)).eq.-1)then 
      kanz = 1 
      iSta = 1 
      jnkz = 1 
      endif 
!                                                                       
!....nur Tracer                                                         
      if(iwsim.eq.4)goto 747 
      if(iwied.eq.1)goto 746 
!                                                                       
!    2D-Modellierung (Gitterbelegung zu Beginn der Simulation)          
!......wird sonst übersprungen Zielpunkt: 746                           
!                                                                       
      do 640 nkz = 1,inkzmx 
      Tzt(ESTRNR(istr,nstr),nkz,jnkz) = htempz(ESTRNR(istr,nstr),1      &
     &,kanz)                                                            
      o2zt(ESTRNR(istr,nstr),nkz,jnkz) = ho2z(ESTRNR(istr,nstr),1       &
     &,kanz)                                                            
      NH4zt(ESTRNR(istr,nstr),nkz,jnkz) = hnh4z(ESTRNR(istr,nstr),1     &
     &,kanz)                                                            
      NO2zt(ESTRNR(istr,nstr),nkz,jnkz) = hno2z(ESTRNR(istr,nstr),1     &
     &,kanz)                                                            
      NO3zt(ESTRNR(istr,nstr),nkz,jnkz) = hno3z(ESTRNR(istr,nstr),1     &
     &,kanz)                                                            
      Pzt(ESTRNR(istr,nstr),nkz,jnkz) = hgelpz(ESTRNR(istr,nstr),1      &
     &,kanz)                                                            
      gSizt(ESTRNR(istr,nstr),nkz,jnkz) = hsiz(ESTRNR(istr,nstr),1      &
     &,kanz)                                                            
      akizt(ESTRNR(istr,nstr),nkz,jnkz) = hakiz(ESTRNR(istr,nstr),1     &
     &,kanz)                                                            
      agrzt(ESTRNR(istr,nstr),nkz,jnkz) = hagrz(ESTRNR(istr,nstr),1     &
     &,kanz)                                                            
      ablzt(ESTRNR(istr,nstr),nkz,jnkz) = hablz(ESTRNR(istr,nstr),1     &
     &,kanz)                                                            
      chlazt(ESTRNR(istr,nstr),nkz,jnkz) = hchlaz(ESTRNR(istr,nstr),1   &
     &,kanz)                                                            
  640 continue 
!                                                                       
  746 continue 
!      if(iwsim.eq.2)goto 747                                           
!                                                                       
! ....Einfluss der Wehre auf O2,pH und Temperatur                       
!                                                                       
      call WEHR(wehrh,wehrb,ho2,hQaus,O2zt,htempw                       &
     &,ho2_z,ho2z_z,hlf,hpw,hmw,hph,hph_z,iph                           &
     &,tzt,hte_z,htez_z,dH2D,ESTRNR,kanz,inkzmx,iSta                    &
     &,nstr,istr,jnkz,iflRi,jlWO2,janzWS,janzWt,hnkzs                   &
     &,mwehr)                                                           
!                                                                       
!hier den Randbedingungstyp für den Strang ESTRNR abfragen              
!                                                                       
!  747 do 749 mRB = 1,mRBs(ESTRNR(istr,nstr))                           
!      if(RBTyp(ESTRNR(istr,nstr).ne.0)goto 749                         
!      hcKE1 = hcKE1+tempws(ESTRNR(istr,nstr),mRB)                      
!     **abfls(ESTRNR(istr,nstr),mRB)                                    
!      hcKQ = hcKQ+abfls(ESTRNR(istr,nstr),mRB)                         
!  749 continue                                                         
!                                                                       
  747 continue 
      hcs1 = hcs1+abs(hQaus(ESTRNR(istr,nstr),iSta))                    &
     &*hsvhk(ESTRNR(istr,nstr),kanz)                                    
      hcs2 = hcs2+abs(hQaus(ESTRNR(istr,nstr),iSta))                    &
     &*hsvhg(ESTRNR(istr,nstr),kanz)                                    
      hcs3 = hcs3+abs(hQaus(ESTRNR(istr,nstr),iSta))                    &
     &*hsvhb(ESTRNR(istr,nstr),kanz)                                    
      hcs6 = hcs6+abs(hQaus(ESTRNR(istr,nstr),iSta))                    &
     &*hakbcm(ESTRNR(istr,nstr),kanz)                                   
      hcs7 = hcs7+abs(hQaus(ESTRNR(istr,nstr),iSta))                    &
     &*hagbcm(ESTRNR(istr,nstr),kanz)                                   
      hcs8 = hcs8+abs(hQaus(ESTRNR(istr,nstr),iSta))                    &
     &*habbcm(ESTRNR(istr,nstr),kanz)                                   
      hcs9 = hcs9+abs(hQaus(ESTRNR(istr,nstr),iSta))                    &
     &*hgesN(ESTRNR(istr,nstr),kanz)                                    
      hcs10 = hcs10+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hgesP(ESTRNR(istr,nstr),kanz)                                    
      hcs20 = hcs20+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hfssgr(ESTRNR(istr,nstr),kanz)                                   
      hcs21 = hcs21+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hfbsgr(ESTRNR(istr,nstr),kanz)                                   
      hcs22 = hcs22+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hfrfgr(ESTRNR(istr,nstr),kanz)                                   
      hcs23 = hcs23+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hnl0(ESTRNR(istr,nstr),kanz)                                     
      hcs24 = hcs24+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hpl0(ESTRNR(istr,nstr),kanz)                                     
!                                                                       
      hcs25 = hcs25+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*htempw(ESTRNR(istr,nstr),kanz)                                   
!                                                                       
!      hcs25 = hcs25+abs(hQaus(ESTRNR(istr,nstr),iSta))                 
!     **htempw(ESTRNR(istr,nstr),kanz)+hcKE1                            
!                                                                       
      hcs26 = hcs26+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hbsb(ESTRNR(istr,nstr),kanz)                                     
      hcs27 = hcs27+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hcsb(ESTRNR(istr,nstr),kanz)                                     
      hcs28 = hcs28+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hCHNF(ESTRNR(istr,nstr),kanz)                                    
      hcs29 = hcs29+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hBVHNF(ESTRNR(istr,nstr),kanz)                                   
      hcs30 = hcs30+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hCD(ESTRNR(istr,nstr),1,kanz)                                    
      hcs31 = hcs31+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hCD(ESTRNR(istr,nstr),2,kanz)                                    
      hcs32 = hcs32+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hCP(ESTRNR(istr,nstr),1,kanz)                                    
      hcs33 = hcs33+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hCP(ESTRNR(istr,nstr),2,kanz)                                    
      hcs34 = hcs34+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hCM(ESTRNR(istr,nstr),kanz)                                      
      hcs35 = hcs35+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hBAC(ESTRNR(istr,nstr),kanz)                                     
      hcs36 = hcs36+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hO2BSB(ESTRNR(istr,nstr),kanz)                                   
      hcs37 = hcs37+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hbl01(ESTRNR(istr,nstr),kanz)                                    
      hcs38 = hcs38+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hbl02(ESTRNR(istr,nstr),kanz)                                    
      hcs39 = hcs39+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hnh4(ESTRNR(istr,nstr),kanz)                                     
      hcs40 = hcs40+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*ho2(ESTRNR(istr,nstr),kanz)                                      
      hcs41 = hcs41+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hno3(ESTRNR(istr,nstr),kanz)                                     
      hcs42 = hcs42+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hno2(ESTRNR(istr,nstr),kanz)                                     
      hcs43 = hcs43+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hx0(ESTRNR(istr,nstr),kanz)                                      
      hcs44 = hcs44+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hx02(ESTRNR(istr,nstr),kanz)                                     
      hcs45 = hcs45+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hsi(ESTRNR(istr,nstr),kanz)                                      
      hcs46 = hcs46+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hchla(ESTRNR(istr,nstr),kanz)                                    
      hcs47 = hcs47+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*haki(ESTRNR(istr,nstr),kanz)                                     
      hcs48 = hcs48+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hagr(ESTRNR(istr,nstr),kanz)                                     
      hcs49 = hcs49+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*habl(ESTRNR(istr,nstr),kanz)                                     
      hcs50 = hcs50+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hchlak(ESTRNR(istr,nstr),kanz)                                   
      hcs51 = hcs51+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hchlag(ESTRNR(istr,nstr),kanz)                                   
      hcs52 = hcs52+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hchlab(ESTRNR(istr,nstr),kanz)                                   
      hcs53 = hcs53+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hvkigr(ESTRNR(istr,nstr),kanz)                                   
      hcs54 = hcs54+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hantbl(ESTRNR(istr,nstr),kanz)                                   
      hcs55 = hcs55+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hssalg(ESTRNR(istr,nstr),kanz)                                   
      hcs56 = hcs56+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hss(ESTRNR(istr,nstr),kanz)                                      
      hcs57 = hcs57+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hzooi(ESTRNR(istr,nstr),kanz)                                    
      hcs58 = hcs58+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hgelp(ESTRNR(istr,nstr),kanz)                                    
      hcs59 = hcs59+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hmw(ESTRNR(istr,nstr),kanz)                                      
      hcs60 = hcs60+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hpw(ESTRNR(istr,nstr),kanz)                                      
      hcs61 = hcs61+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hca(ESTRNR(istr,nstr),kanz)                                      
      hcs62 = hcs62+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hlf(ESTRNR(istr,nstr),kanz)                                      
!                                                                       
!..pH-Wert in H+-umrechnen!!!                                           
!                                                                       
      hmue = 1.7e-5*hlf(ESTRNR(istr,nstr),kanz) 
      if(hmue.lt.0.0)hmue = 0.0 
      hk = (0.5*sqrt(hmue))/(1.+1.4*sqrt(hmue)) 
      lgh = hph(ESTRNR(istr,nstr),kanz)-hk 
      vhplus = 10**(-lgh) 
!                                                                       
      hcs63 = hcs63+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*vhplus                                                           
      hcs64 = hcs64+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hcoli(ESTRNR(istr,nstr),kanz)                                    
      hcs65 = hcs65+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hvbsb(ESTRNR(istr,nstr),kanz)                                    
      hcs66 = hcs66+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hvcsb(ESTRNR(istr,nstr),kanz)                                    
      hcs77 = hcs77+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hQ_NK(ESTRNR(istr,nstr),kanz)                                    
      hcs78 = hcs78+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hQ_PK(ESTRNR(istr,nstr),kanz)                                    
      hcs79 = hcs79+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hQ_SK(ESTRNR(istr,nstr),kanz)                                    
      hcs80 = hcs80+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hQ_NG(ESTRNR(istr,nstr),kanz)                                    
      hcs81 = hcs81+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hQ_PG(ESTRNR(istr,nstr),kanz)                                    
      hcs82 = hcs82+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hQ_NB(ESTRNR(istr,nstr),kanz)                                    
      hcs83 = hcs83+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hQ_PB(ESTRNR(istr,nstr),kanz)                                    
      hcs85 = hcs85+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hSKmor(ESTRNR(istr,nstr),kanz)                                   
      hcs86 = hcs86+abs(hQaus(ESTRNR(istr,nstr),iSta))                  &
     &*hDOSCF(ESTRNR(istr,nstr),kanz)                                   
                                                                        
                                                                        
!......2D-Modellierung                                                  
      do 510 nkz = 1,inkzmx 
      hcs67(nkz) = hcs67(nkz)+abs(hQaus(ESTRNR(istr,nstr)               &
     &,iSta))*Tzt(ESTRNR(istr,nstr),nkz,jnkz)                           
      hcs68(nkz) = hcs68(nkz)+abs(hQaus(ESTRNR(istr,nstr)               &
     &,iSta))*O2zt(ESTRNR(istr,nstr),nkz,jnkz)                          
      hcs69(nkz) = hcs69(nkz)+abs(hQaus(ESTRNR(istr,nstr)               &
     &,iSta))*NH4zt(ESTRNR(istr,nstr),nkz,jnkz)                         
      hcs70(nkz) = hcs70(nkz)+abs(hQaus(ESTRNR(istr,nstr)               &
     &,iSta))*NO2zt(ESTRNR(istr,nstr),nkz,jnkz)                         
      hcs71(nkz) = hcs71(nkz)+abs(hQaus(ESTRNR(istr,nstr)               &
     &,iSta))*NO3zt(ESTRNR(istr,nstr),nkz,jnkz)                         
      hcs72(nkz) = hcs72(nkz)+abs(hQaus(ESTRNR(istr,nstr)               &
     &,iSta))*Pzt(ESTRNR(istr,nstr),nkz,jnkz)                           
      hcs73(nkz) = hcs73(nkz)+abs(hQaus(ESTRNR(istr,nstr)               &
     &,iSta))*gSizt(ESTRNR(istr,nstr),nkz,jnkz)                         
      hcs74(nkz) = hcs74(nkz)+abs(hQaus(ESTRNR(istr,nstr)               &
     &,iSta))*akizt(ESTRNR(istr,nstr),nkz,jnkz)                         
      hcs75(nkz) = hcs75(nkz)+abs(hQaus(ESTRNR(istr,nstr)               &
     &,iSta))*agrzt(ESTRNR(istr,nstr),nkz,jnkz)                         
      hcs76(nkz) = hcs76(nkz)+abs(hQaus(ESTRNR(istr,nstr)               &
     &,iSta))*ablzt(ESTRNR(istr,nstr),nkz,jnkz)                         
      hcs84(nkz) = hcs84(nkz)+abs(hQaus(ESTRNR(istr,nstr)               &
     &,iSta))*chlazt(ESTRNR(istr,nstr),nkz,jnkz)                        
  510 continue 
!                                                                       
       hcq = hcq+abs(hqaus(ESTRNR(istr,nstr),iSta)) 
!      hcq = hcq+hqaus(ESTRNR(istr,nstr),iSta)+hcKQ                     
!                                                                       
!...Umspeichern der Daten am Ende des Wehrstrangs                       
!....Wehrbelüftung wird am letzten Knoten des oberstromigen Strangs (OW)
!..(Berechnung erfolgt in der Subroutine <WEHR>                         
!... nach Übergabe an den unterstromigen Strang (UW) müssen die Werte oh
! ...Wehrüberfall wieder am letzten Knoten im oberstromigen Strang geset
!....ho2_z in hO2                                                       
!...                                                                    
!..Bei Tracer-Berechnung wirden die Wehre nicht berücksichtigt          
      if(iwsim.eq.4)goto 149 
      htempw(ESTRNR(istr,nstr),kanz) = hte_z(ESTRNR(istr,nstr)) 
      ho2(ESTRNR(istr,nstr),kanz) = ho2_z(ESTRNR(istr,nstr)) 
      hph(ESTRNR(istr,nstr),kanz) = hph_z(ESTRNR(istr,nstr)) 
!                                                                       
      do 543 nkz = 1,inkzmx 
      Tzt(ESTRNR(istr,nstr),nkz,jnkz) = htez_z(ESTRNR(istr,nstr),nkz) 
  543 o2zt(ESTRNR(istr,nstr),nkz,jnkz) = ho2z_z(ESTRNR(istr,nstr),nkz) 
!                                                                       
  149 continue 
!                                                                       
      if(hcq.eq.0.0)goto 158 
      hcs1 = hcs1/hcq 
      hcs2 = hcs2/hcq 
      hcs3 = hcs3/hcq 
      hcs6 = hcs6/hcq 
      hcs7 = hcs7/hcq 
      hcs8 = hcs8/hcq 
      hcs9 = hcs9/hcq 
      hcs10 = hcs10/hcq 
      hcs20 = hcs20/hcq 
      hcs21 = hcs21/hcq 
      hcs22 = hcs22/hcq 
      hcs23 = hcs23/hcq 
      hcs24 = hcs24/hcq 
      hcs25 = hcs25/hcq 
      hcs26 = hcs26/hcq 
      hcs27 = hcs27/hcq 
      hcs28 = hcs28/hcq 
      hcs29 = hcs29/hcq 
      hcs30 = hcs30/hcq 
      hcs31 = hcs31/hcq 
      hcs32 = hcs32/hcq 
      hcs33 = hcs33/hcq 
      hcs34 = hcs34/hcq 
      hcs35 = hcs35/hcq 
      hcs36 = hcs36/hcq 
      hcs37 = hcs37/hcq 
      hcs38 = hcs38/hcq 
      hcs39 = hcs39/hcq 
      hcs40 = hcs40/hcq 
      hcs41 = hcs41/hcq 
      hcs42 = hcs42/hcq 
      hcs43 = hcs43/hcq 
      hcs44 = hcs44/hcq 
      hcs45 = hcs45/hcq 
      hcs46 = hcs46/hcq 
      hcs47 = hcs47/hcq 
      hcs48 = hcs48/hcq 
      hcs49 = hcs49/hcq 
      hcs50 = hcs50/hcq 
      hcs51 = hcs51/hcq 
      hcs52 = hcs52/hcq 
      hcs53 = hcs53/hcq 
      hcs54 = hcs54/hcq 
      hcs55 = hcs55/hcq 
      hcs56 = hcs56/hcq 
      hcs57 = hcs57/hcq 
      hcs58 = hcs58/hcq 
      hcs59 = hcs59/hcq 
      hcs60 = hcs60/hcq 
      hcs61 = hcs61/hcq 
      hcs62 = hcs62/hcq 
      hcs63 = hcs63/hcq 
!....Umrechnung von H+ in pH-Wert                                       
      hmue = 1.7e-5*hcs62 
      if(hmue.lt.0.0)hmue = 0.0 
      hk = (0.5*sqrt(hmue))/(1.+1.4*sqrt(hmue)) 
      hcs63 = log10(hcs63) 
      hcs63 = (-1.*hcs63)+hk 
!                                                                       
      hcs64 = hcs64/hcq 
      hcs65 = hcs65/hcq 
      hcs66 = hcs66/hcq 
!...2D-Modellierung                                                     
!                                                                       
!                                                                       
      do 508 nkz = 1,inkzmx 
      hcs67(nkz) = hcs67(nkz)/hcq 
      hcs68(nkz) = hcs68(nkz)/hcq 
      hcs69(nkz) = hcs69(nkz)/hcq 
      hcs70(nkz) = hcs70(nkz)/hcq 
      hcs71(nkz) = hcs71(nkz)/hcq 
      hcs72(nkz) = hcs72(nkz)/hcq 
      hcs73(nkz) = hcs73(nkz)/hcq 
      hcs74(nkz) = hcs74(nkz)/hcq 
      hcs75(nkz) = hcs75(nkz)/hcq 
      hcs76(nkz) = hcs76(nkz)/hcq 
      hcs84(nkz) = hcs84(nkz)/hcq 
  508 continue 
!                                                                       
      hcs77 = hcs77/hcq 
      hcs78 = hcs78/hcq 
      hcs79 = hcs79/hcq 
      hcs80 = hcs80/hcq 
      hcs81 = hcs81/hcq 
      hcs82 = hcs82/hcq 
      hcs83 = hcs83/hcq 
      hcs85 = hcs85/hcq 
      hcs86 = hcs86/hcq 
!                                                                       
      do 157 ior = iB,anzej,istep1 
      hsvhk(mstr,ior) = hcs1 
      hsvhg(mstr,ior) = hcs2 
      hsvhb(mstr,ior) = hcs3 
      hakbcm(mstr,ior) = hcs6 
      hagbcm(mstr,ior) = hcs7 
      habbcm(mstr,ior) = hcs8 
      hgesN(mstr,ior) = hcs9 
      hgesP(mstr,ior) = hcs10 
      hfssgr(mstr,ior) = hcs20 
      hfbsgr(mstr,ior) = hcs21 
      hfrfgr(mstr,ior) = hcs22 
      hnl0(mstr,ior) = hcs23 
      hpl0(mstr,ior) = hcs24 
      htempw(mstr,ior) = hcs25 
!...Festlegung der Anfangs-Sedimenttemperatur Tsed = TWasser            
      if(iwied.eq.0)hTsed(mstr,ior) = htempw(mstr,ior) 
      hbsb(mstr,ior) = hcs26 
      hcsb(mstr,ior) = hcs27 
      hCHNF(mstr,ior) = hcs28 
      hBVHNF(mstr,ior) = hcs29 
      hCD(mstr,1,ior) = hcs30 
      hCD(mstr,2,ior) = hcs31 
      hCP(mstr,1,ior) = hcs32 
      hCP(mstr,2,ior) = hcs33 
      hCM(mstr,ior) = hcs34 
      hBAC(mstr,ior) = hcs35 
      hO2BSB(mstr,ior) = hcs36 
      hbl01(mstr,ior) = hcs37 
      hbl02(mstr,ior) = hcs38 
      hnh4(mstr,ior) = hcs39 
      ho2(mstr,ior) = hcs40 
      hno3(mstr,ior) = hcs41 
      hno2(mstr,ior) = hcs42 
      hx0(mstr,ior) = hcs43 
      hx02(mstr,ior) = hcs44 
      hsi(mstr,ior) = hcs45 
!      hsised(mstr,ior) = 0.0                                           
!      hSKmor(mstr,ior) = 0.0                                           
      hchla(mstr,ior) = hcs46 
      haki(mstr,ior) = hcs47 
      hagr(mstr,ior) = hcs48 
      habl(mstr,ior) = hcs49 
      hchlak(mstr,ior) = hcs50 
      hchlag(mstr,ior) = hcs51 
      hchlab(mstr,ior) = hcs52 
      hvkigr(mstr,ior) = hcs53 
      hantbl(mstr,ior) = hcs54 
      habrz1(mstr,ior) = 0.0 
      hssalg(mstr,ior) = hcs55 
      hss(mstr,ior) = hcs56 
      hzooi(mstr,ior) = hcs57 
      hgelp(mstr,ior) = hcs58 
      hmw(mstr,ior) = hcs59 
      hpw(mstr,ior) = hcs60 
      hca(mstr,ior) = hcs61 
      hlf(mstr,ior) = hcs62 
      hph(mstr,ior) = hcs63 
      hdlarn(mstr,ior) = 0.0 
      hstind(mstr,ior) = 0.0 
      hcoli(mstr,ior) = hcs64 
      hvbsb(mstr,ior) = hcs65 
      hvcsb(mstr,ior) = hcs66 
      hQ_NK(mstr,ior) = hcs77 
      hQ_PK(mstr,ior) = hcs78 
      hQ_SK(mstr,ior) = hcs79 
      hQ_NG(mstr,ior) = hcs80 
      hQ_PG(mstr,ior) = hcs81 
      hQ_NB(mstr,ior) = hcs82 
      hQ_PB(mstr,ior) = hcs83 
      hSKmor(mstr,ior) = hcs85 
      hDOSCF(mstr,ior) = hcs86 
!                                                                       
!                                                                       
!...nur Tracer                                                          
      if(iwsim.eq.4)goto 157 
!                                                                       
!                                                                       
      if(inkzmx.ge.hnkzs(mstr,ior))goto 621 
      if(inkzmx.lt.hnkzs(mstr,ior))goto 622 
!                                                                       
  621 continue 
!...Mittelwertbildung der Gitterwerte groesser HNKZS                    
      sO2 = 0.0 
      sn4 = 0.0 
      sN2 = 0.0 
      sN3 = 0.0 
      sumT = 0.0 
      sumP = 0.0 
      sSi = 0.0 
      ski = 0.0 
      sgr = 0.0 
      sbl = 0.0 
      schl = 0.0 
      sumH = 0.0 
      do 546 nkz = hnkzs(mstr,ior),inkzmx-1 
      sumT = sumT+((hcs67(nkz)+hcs67(nkz+1))/2.)*dH2D 
      sO2 = sO2+((hcs68(nkz)+hcs68(nkz+1))/2.)*dH2D 
      sN4 = sN4+((hcs69(nkz)+hcs69(nkz+1))/2.)*dH2D 
      sN2 = sN2+((hcs70(nkz)+hcs70(nkz+1))/2.)*dH2D 
      sN3 = sN3+((hcs71(nkz)+hcs71(nkz+1))/2.)*dH2D 
      sumP = sumP+((hcs72(nkz)+hcs72(nkz+1))/2.)*dH2D 
      sSi = sSi+((hcs73(nkz)+hcs73(nkz+1))/2.)*dH2D 
      ski = ski+((hcs74(nkz)+hcs74(nkz+1))/2.)*dH2D 
      sgr = sgr+((hcs75(nkz)+hcs75(nkz+1))/2.)*dH2D 
      sbl = sbl+((hcs76(nkz)+hcs76(nkz+1))/2.)*dH2D 
      schl = schl+((hcs84(nkz)+hcs84(nkz+1))/2.)*dH2D 
      sumH = sumH+dH2D 
      if(sumH.eq.0.0)sumH = 0.00001 
  546 continue 
!                                                                       
      vo2end = sO2/sumH 
      vN4end = sN4/sumH 
      vN2end = sN2/sumH 
      vN3end = sN3/sumH 
      Tend = sumT/sumH 
      Pend = sumP/sumH 
      Siend = sSi/sumH 
      akiend = ski/sumH 
      agrend = sgr/sumH 
      ablend = sbl/sumH 
      chlend = schl/sumH 
!                                                                       
      do 680 nkz = 1,hnkzs(mstr,ior) 
      htempz(mstr,nkz,ior) = hcs67(nkz) 
      ho2z(mstr,nkz,ior) = hcs68(nkz) 
      hnh4z(mstr,nkz,ior) = hcs69(nkz) 
      hno2z(mstr,nkz,ior) = hcs70(nkz) 
      hno3z(mstr,nkz,ior) = hcs71(nkz) 
      hgelPz(mstr,nkz,ior) = hcs72(nkz) 
      hSiz(mstr,nkz,ior) = hcs73(nkz) 
      hakiz(mstr,nkz,ior) = hcs74(nkz) 
      hagrz(mstr,nkz,ior) = hcs75(nkz) 
      hablz(mstr,nkz,ior) = hcs76(nkz) 
      hchlaz(mstr,nkz,ior) = hcs84(nkz) 
  680 continue 
!                                                                       
      if(inkzmx.eq.hnkzs(mstr,ior))goto 159 
      htempz(mstr,hnkzs(mstr,ior),ior) = tend 
      ho2z(mstr,hnkzs(mstr,ior),ior) = vo2end 
      hnh4z(mstr,hnkzs(mstr,ior),ior) = vN4end 
      hno2z(mstr,hnkzs(mstr,ior),ior) = vN2end 
      hno3z(mstr,hnkzs(mstr,ior),ior) = vN3end 
      hgelPz(mstr,hnkzs(mstr,ior),ior) = Pend 
      hSiz(mstr,hnkzs(mstr,ior),ior) = Siend 
      hakiz(mstr,hnkzs(mstr,ior),ior) = akiend 
      hagrz(mstr,hnkzs(mstr,ior),ior) = agrend 
      hablz(mstr,hnkzs(mstr,ior),ior) = ablend 
      hchlaz(mstr,hnkzs(mstr,ior),ior) = chlend 
!                                                                       
      goto 159 
!                                                                       
!                                                                       
  622 continue 
      do 644 nkz=1,inkzmx 
      htempz(mstr,nkz,ior) = hcs67(nkz) 
      ho2z(mstr,nkz,ior) = hcs68(nkz) 
      hnh4z(mstr,nkz,ior) = hcs69(nkz) 
      hno2z(mstr,nkz,ior) = hcs70(nkz) 
      hno3z(mstr,nkz,ior) = hcs71(nkz) 
      hgelPz(mstr,nkz,ior) = hcs72(nkz) 
      hSiz(mstr,nkz,ior) = hcs73(nkz) 
      hakiz(mstr,nkz,ior) = hcs74(nkz) 
      hagrz(mstr,nkz,ior) = hcs75(nkz) 
      hablz(mstr,nkz,ior) = hcs76(nkz) 
      hchlaz(mstr,nkz,ior) = hcs84(nkz) 
  644 continue 
!                                                                       
      do 625 nkz=inkzmx+1,hnkzs(mstr,ior) 
      htempz(mstr,nkz,ior) = hcs67(inkzmx) 
      ho2z(mstr,nkz,ior) = hcs68(inkzmx) 
      hnh4z(mstr,nkz,ior) = hcs69(inkzmx) 
      hno2z(mstr,nkz,ior) = hcs70(inkzmx) 
      hno3z(mstr,nkz,ior) = hcs71(inkzmx) 
      hgelPz(mstr,nkz,ior) = hcs72(inkzmx) 
      hSiz(mstr,nkz,ior) = hcs73(inkzmx) 
      hakiz(mstr,nkz,ior) = hcs74(inkzmx) 
      hagrz(mstr,nkz,ior) = hcs75(inkzmx) 
      hablz(mstr,nkz,ior) = hcs76(inkzmx) 
      hchlaz(mstr,nkz,ior) = hcs84(inkzmx) 
  625 continue 
!                                                                       
  159 continue 
!                                                                       
!                                                                       
      if(nbuhn(mstr).eq.0.or.iwied.eq.1)goto 157 
!     Buhnenfelder                                                      
!                                                                       
      bsvhek(mstr,ior) = hsvhk(mstr,ior) 
      bsvheg(mstr,ior) = hsvhg(mstr,ior) 
      bakbcm(mstr,ior) = hakbcm(mstr,ior) 
      bagbcm(mstr,ior) = hagbcm(mstr,ior) 
      bnl0(mstr,ior) = hnl0(mstr,ior) 
      bpl0(mstr,ior) = hpl0(mstr,ior) 
      bgesN(mstr,ior) = hgesN(mstr,ior) 
      bgesP(mstr,ior) = hgesP(mstr,ior) 
      bstind(mstr,ior) = hstind(mstr,ior) 
      btempw(mstr,ior) = htempw(mstr,ior) 
!...Festlegung der Anfangs-Sedimenttemperatur Tsed = TWasser            
      if(iwied.eq.0)bTsed(mstr,ior) = htempw(mstr,ior) 
      bbsb(mstr,ior) = hbsb(mstr,ior) 
      bcsb(mstr,ior) = hcsb(mstr,ior) 
      bbl01(mstr,ior) = hbl01(mstr,ior) 
      bbl02(mstr,ior) = hbl02(mstr,ior) 
      bnh4(mstr,ior) = hnh4(mstr,ior) 
      bo2(mstr,ior) = ho2(mstr,ior) 
      bno3(mstr,ior) = hno3(mstr,ior) 
      bno2(mstr,ior) = hno2(mstr,ior) 
      bx0(mstr,ior) = hx0(mstr,ior) 
      bx02(mstr,ior) = hx02(mstr,ior) 
      bsi(mstr,ior) = hsi(mstr,ior) 
      bsised(mstr,ior) = hsised(mstr,ior) 
      bSKmor(mstr,ior) = hSKmor(mstr,ior) 
      bchla(mstr,ior) = hchla(mstr,ior) 
      baki(mstr,ior) = haki(mstr,ior) 
      bagr(mstr,ior) = hagr(mstr,ior) 
      babl(mstr,ior) = habl(mstr,ior) 
      bchlak(mstr,ior) = hchlak(mstr,ior) 
      bchlag(mstr,ior) = hchlag(mstr,ior) 
      bchlab(mstr,ior) = hchlab(mstr,ior) 
      bvkigr(mstr,ior) = hvkigr(mstr,ior) 
      bantbl(mstr,ior) = hantbl(mstr,ior) 
      babrz1(mstr,ior) = habrz1(mstr,ior) 
      bssalg(mstr,ior) = hssalg(mstr,ior) 
      bfssgr(mstr,ior) = hfssgr(mstr,ior) 
      bfbsgr(mstr,ior) = hfbsgr(mstr,ior) 
      bfrfgr(mstr,ior) = hfrfgr(mstr,ior) 
      bss(mstr,ior) = hss(mstr,ior) 
      bzooi(mstr,ior) = hzooi(mstr,ior) 
      bgelp(mstr,ior) = hgelp(mstr,ior) 
      bmw(mstr,ior) = hmw(mstr,ior) 
      bpw(mstr,ior) = hpw(mstr,ior) 
      bca(mstr,ior) = hca(mstr,ior) 
      blf(mstr,ior) =hlf(mstr,ior) 
      bdlarn(mstr,ior) = hdlarn(mstr,ior) 
      bph(mstr,ior) = hph(mstr,ior) 
      bvbsb(mstr,ior) = hvbsb(mstr,ior) 
      bvcsb(mstr,ior) = hvcsb(mstr,ior) 
      bCD(mstr,1,ior) = hCD(mstr,1,ior) 
      bCD(mstr,2,ior) = hCD(mstr,2,ior) 
      bCP(mstr,1,ior) = hCP(mstr,1,ior) 
      bCP(mstr,2,ior) = hCP(mstr,2,ior) 
      bCM(mstr,ior) = hCM(mstr,ior) 
      bBAC(mstr,ior) = hBAC(mstr,ior) 
      bO2BSB(mstr,ior) = hO2BSB(mstr,ior) 
      bQ_PK(mstr,ior) = hQ_PK(mstr,ior) 
      bQ_NK(mstr,ior) = hQ_NK(mstr,ior) 
      bQ_SK(mstr,ior) = hQ_SK(mstr,ior) 
      bQ_PG(mstr,ior) = hQ_PG(mstr,ior) 
      bQ_NG(mstr,ior) = hQ_NG(mstr,ior) 
      bQ_PB(mstr,ior) = hQ_PB(mstr,ior) 
      bQ_NB(mstr,ior) = hQ_NB(mstr,ior) 
!                                                                       
  157 continue 
  158 if(iwied.eq.0)then 
      ianze(mstr) = hanze(mstr) 
!                                                                       
      endif 
      goto 344 
!                                                                       
!                                                                       
  656 continue 
      if(jlauf.eq.1)goto 7777 
!.....Vorlauf ilang = 0                                                 
      if(iwied.eq.1.and.ilang.eq.0)goto 5555 
!                                                                       
!                                                                       
!.........Einlesen der hydraulischen Daten aus sysgenou                 
!                                                                       
      open(unit=11, DEFAULTFILE=cpfad, file='sysgenou') 
      rewind (11) 
!                                                                       
      do 773 azStr = 1,azStrs 
      mstr = mstra(azStr) 
!                                                                       
      read(11,1000)hanze(mstr) 
 1000 format(i4) 
      do 30 ior=1,hanze(mstr) 
!                                                                       
!                                                                       
      read(11,1010)hfkm(mstr,ior),hflag(mstr,ior)                       &
     &,hjiein(mstr,ior),helen(mstr,ior),hvmitt(mstr,ior)                &
     &,htiefe(mstr,ior),hrau(mstr,ior),hrhyd(mstr,ior)                  &
     &,hSedOM(mstr,ior),hw2(mstr,ior),hdKorn(mstr,ior),hflae(mstr,ior)  &
     &,hWS(mstr,ior),hischf(mstr,ior)                                   &
     &,hlboem(mstr,ior),hbsohl(mstr,ior),hvabfl(mstr,ior)               &
     &,bh(mstr,ior),bf(mstr,ior),bso(mstr,ior),blb(mstr,ior)            &
     &,bleb(mstr,ior),hdl(mstr,ior),htau2(mstr,ior)                     &
     &,vbm(mstr,ior),bSedOM(mstr,ior),bw2(mstr,ior),bdKorn(mstr,ior)    &
     &,dlalph(mstr,ior)                                                 
!                                                                       
                                                                        
!                                                                       
 1010 format(f8.3,2x,i1,2x,i2                                           &
     &,2x,f8.2,2x,f7.4,2x,f5.2,2x,f5.2,2x,f5.2                          &
     &,2x,f6.4,2x,E11.5,2x,E11.5,2x,f8.2,2x,f9.4,2x,i1,2x,f9.4          &
     &,2x,f9.4,2x,f14.6,2x,f5.2,2x,f7.2,2x,f7.2,2x,f6.2,2x              &
     &,f7.2,2x,f7.2,2x,f7.2,2x,f7.4,2x,f6.4,2x,E11.5,2x,E11.5,2x,f6.2)  
!                                                                       
!      if(ieros.eq.0)goto 30                                            
!....Umspeichern der Sedimentgroessen                                   
!      sedh(mstr,ior) = sedhg(mstr,ior)                                 
!      ischic(mstr,ior) = ischig(mstr,ior)                              
!      do 461 itau = 1,50                                               
!  461 tausc(mstr,ior,itau) = tauscg(mstr,ior,itau)                     
!                                                                       
   30 continue 
!....Belegung des letzten Knotens mit hydraulischen Daten.....          
      htiefe(mstr,hanze(mstr)+1) = htiefe(mstr,hanze(mstr)) 
      hvmitt(mstr,hanze(mstr)+1) = hvmitt(mstr,hanze(mstr)) 
      hrau(mstr,hanze(mstr)+1) = hrau(mstr,hanze(mstr)) 
      hrhyd(mstr,hanze(mstr)+1) = hrhyd(mstr,hanze(mstr)) 
      hflae(mstr,hanze(mstr)+1) = hflae(mstr,hanze(mstr)) 
      hWS(mstr,hanze(mstr)+1) = hWS(mstr,hanze(mstr)) 
      hlboem(mstr,hanze(mstr)+1) = hlboem(mstr,hanze(mstr)) 
      hbsohl(mstr,hanze(mstr)+1) = hbsohl(mstr,hanze(mstr)) 
      bh(mstr,hanze(mstr)+1) = bh(mstr,hanze(mstr)) 
      bf(mstr,hanze(mstr)+1) = bf(mstr,hanze(mstr)) 
      bso(mstr,hanze(mstr)+1) = bso(mstr,hanze(mstr)) 
      blb(mstr,hanze(mstr)+1) = blb(mstr,hanze(mstr)) 
      bleb(mstr,hanze(mstr)+1) = bleb(mstr,hanze(mstr)) 
      hdl(mstr,hanze(mstr)+1) = hdl(mstr,hanze(mstr)) 
      htau2(mstr,hanze(mstr)+1) = htau2(mstr,hanze(mstr)) 
      vbm(mstr,hanze(mstr)+1) = vbm(mstr,hanze(mstr)) 
      dlalph(mstr,hanze(mstr)+1) = dlalph(mstr,hanze(mstr)) 
      hSedOM(mstr,hanze(mstr)+1) = hSedOM(mstr,hanze(mstr)) 
      hw2(mstr,hanze(mstr)+1) = hw2(mstr,hanze(mstr)) 
      hdKorn(mstr,hanze(mstr)+1) = hdKorn(mstr,hanze(mstr)) 
!                                                                       
  773 continue 
!                                                                       
      close (11) 
!                                                                       
      if(ilang.eq.0)goto 5555 
!                                                                       
!...Neubelegung des vertikalen Rechengitters an jedem Gitterpunkt       
!                                                                       
      call sys_z_Gitter(azStrs,mstra,hanze,znkzs,hnkzs,dH2D             &
     &,iFlRi,htempz,ho2z,hnh4z,hno2z,hno3z,hgelPz,hSiz,hakiz,hagrz      &
     &,hablz,hchlaz,itags)                                              
!                                                                       
!                                                                       
!     **********************************************************        
!     Zeitschleife                                                      
!                                                                       
 5555 continue 
!                                                                       
!...Umrechnung der Uhrzeit in das Format <h.mm>                         
!                                                                       
      Stunde = int(Uhrz) 
      hcmin = (Uhrz-Stunde)*60. 
      minute = nint(hcmin) 
      if(minute.eq.60)then 
        minute = 0 
        Stunde = Stunde+1 
      endif 
      rmin = minute/100. 
      Uhrzhm = Stunde+rmin 
!                                                                       
      write(*,6161) 
 6161 format(2x,'GUETESIMULATION') 
      write(*,6162)itime 
 6162 format(2x,'Anzahl der Zeitschritte: ',I4) 
      write(*,6163)ij,itags,monats,jahrs,Uhrzhm 
 6163 format(2x,'Zeitschritt: ',I4,2x,i2,'.',i2,'.',I4,2x,F5.2) 
!                                                                       
!                                                                       
!....Strangschleife fr Berechnung                                      
 9898 do 8888 azStr = 1,azStrs 
      mstr = mstra(azStr) 
      anze = hanze(mstr) 
      iein = 0 
      iBe = 1 
      iendel = ieinsh(mstr) 
      istepe = 1 
!...Umdrehen der Einleiter bei Fliessumkehr                             
!                                                                       
      if(iflRi(mstr).eq.-1)then 
      iBe = ieinsh(mstr) 
      iendel = 1 
      istepe = -1 
      endif 
!                                                                       
      do 674 kein=iBe,iendel,istepe 
      iein = iein+1 
      einlk(iein) = einlkh(mstr,kein) 
      qeinl(iein) = qeinlh(mstr,kein) 
      ebsb(iein) = ebsbh(mstr,kein) 
      ecsb(iein) = ecsbh(mstr,kein) 
      eBVHNF(iein) = eBVHNh(mstr,kein) 
      eCHNF(iein) = eCHNFh(mstr,kein) 
!                                                                       
      enh4(iein) = enh4h(mstr,kein) 
      ex0(iein) = ex0h(mstr,kein) 
      ex02(iein) = ex02h(mstr,kein) 
      eo2(iein) = eo2h(mstr,kein) 
      etemp(iein) = etemph(mstr,kein) 
      echla(iein) = echlah(mstr,kein) 
      ezind(iein) = ezindh(mstr,kein) 
      ep(iein) = egph(mstr,kein) 
      esi(iein) = esih(mstr,kein) 
      eno2(iein) = eno2h(mstr,kein) 
      eno3(iein) = eno3h(mstr,kein) 
      egesN(iein) = egesNh(mstr,kein) 
      egesP(iein) = egesPh(mstr,kein) 
      ess(iein) = essh(mstr,kein) 
      ewaerm(iein) = ewaerh(mstr,kein) 
      typ(iein) = typh(mstr,kein) 
      eph(iein) = ephh(mstr,kein) 
      emw(iein) = emwh(mstr,kein) 
      elf(iein) = elfh(mstr,kein) 
      eca(iein) = ecah(mstr,kein) 
      ecoli(iein) = ecolih(mstr,kein) 
      evkigr(iein) = evkgh(mstr,kein) 
      eantbl(iein) = eantbh(mstr,kein) 
      enl0(iein) = enl0h(mstr,kein) 
      epl0(iein) = epl0h(mstr,kein) 
  674 continue 
!                                                                       
!...Linienquellen                                                       
      ieinL = 0 
      iBe = 1 
      iendel = ieinLs(mstr) 
      istepe = 1 
!...Umdrehen der Einleiter bei Fliessumkehr                             
!                                                                       
      if(iflRi(mstr).eq.-1)then 
      iBe = ieinLs(mstr) 
      iendel = 1 
      istepe = -1 
      endif 
!                                                                       
      do 675 kein=iBe,iendel,istepe 
      ieinL = ieinL+1 
      qeinlL(ieinL) = qLh(mstr,kein) 
      bsbL(ieinL) = bsbLh(mstr,kein) 
      csbL(ieinL) = csbLh(mstr,kein) 
      enh4L(ieinL) = enh4Lh(mstr,kein) 
      x0L(ieinL) = x0Lh(mstr,kein) 
      x02L(ieinL) = x02Lh(mstr,kein) 
      o2L(ieinL) = o2Lh(mstr,kein) 
      etempL(ieinL) = tempLh(mstr,kein) 
      gpL(ieinL) = gpLh(mstr,kein) 
      siL(ieinL) = siLh(mstr,kein) 
      eno2L(ieinL) = eno2Lh(mstr,kein) 
      eno3L(ieinL) = eno3Lh(mstr,kein) 
      gesNL(ieinL) = gesNLh(mstr,kein) 
      gesPL(ieinL) = gesPLh(mstr,kein) 
      ssL(ieinL) = ssLh(mstr,kein) 
      phL(ieinL) = phLh(mstr,kein) 
      elfL(ieinL) = elfLh(mstr,kein) 
      caL(ieinL) = caLh(mstr,kein) 
      coliL(ieinL) = coliLh(mstr,kein) 
      enl0L(ieinL) = enl0Lh(mstr,kein) 
      pl0L(ieinL) = pl0Lh(mstr,kein) 
!                                                                       
      if(iflRi(mstr).eq.-1)then 
      iorLa(ieinL) = anze+1-iorLeh(mstr,kein) 
      iorLe(ieinL) = anze+1-iorLah(mstr,kein) 
      goto 675 
      endif 
!                                                                       
      iorLa(ieinL) = iorLah(mstr,kein) 
      iorLe(ieinL) = iorLeh(mstr,kein) 
  675 continue 
!                                                                       
!.....Kenngroessen für Pflanzenwachstum,und Dreissenawachstum           
!.....nur strangweise nicht Abschnittsweise                             
      itstart = itsts(mstr) 
      mstart = msts(mstr) 
      itmax = itmaxs(mstr) 
      mmax = mmaxs(mstr) 
      itend = itends(mstr) 
      mend = mends(mstr) 
      lait1 = laits(mstr) 
      laim1 = laims(mstr) 
      laid1 = laids(mstr) 
!                                                                       
!....Rueckstroemung                                                     
      jR = 0 
      if(iFlRi(mstr).eq.(-1))then 
      ibeg = anze+1 
      iRe = 1 
      istep = -1 
      endif 
!                                                                       
      if(iFlRi(mstr).gt.(-1))then 
      ibeg = 1 
      iRe = anze+1 
      istep = 1 
      endif 
!                                                                       
      do 889 ior=ibeg,iRe,istep 
!                                                                       
      jR = jR+1 
      svhemk(jR) = hsvhk(mstr,ior) 
      svhemg(jR) = hsvhg(mstr,ior) 
      svhemb(jR) = hsvhb(mstr,ior) 
      DOSCF(jR) = hDOSCF(mstr,ior) 
      akbcm(jR) = hakbcm(mstr,ior) 
      agbcm(jR) = hagbcm(mstr,ior) 
      abbcm(jR) = habbcm(mstr,ior) 
      fssgr(jR) = hfssgr(mstr,ior) 
      fbsgr(jR) = hfbsgr(mstr,ior) 
      frfgr(jR) = hfrfgr(mstr,ior) 
      nl0(jR) = hnl0(mstr,ior) 
      pl0(jR) = hpl0(mstr,ior) 
      gesN(jR) = hgesN(mstr,ior) 
      gesP(jR) = hgesP(mstr,ior) 
      Q_NK(jR) = hQ_NK(mstr,ior) 
      Q_PK(jR) = hQ_PK(mstr,ior) 
      Q_SK(jR) = hQ_SK(mstr,ior) 
      Q_NG(jR) = hQ_NG(mstr,ior) 
      Q_PG(jR) = hQ_PG(mstr,ior) 
      Q_NB(jR) = hQ_NB(mstr,ior) 
      Q_PB(jR) = hQ_PB(mstr,ior) 
      tempw(jR) = htempw(mstr,ior) 
      Tsed(jR) = hTsed(mstr,ior) 
      obsb(jR) = hbsb(mstr,ior) 
      ocsb(jR) = hcsb(mstr,ior) 
!                                                                       
      CHNF(jR) = hCHNF(mstr,ior) 
      BVHNF(jR) = hBVHNF(mstr,ior) 
      CD(1,jR) = hCD(mstr,1,ior) 
      CD(2,jR) = hCD(mstr,2,ior) 
      CP(1,jR) = hCP(mstr,1,ior) 
      CP(2,jR) = hCP(mstr,2,ior) 
      CM(jR) = hCM(mstr,ior) 
      BAC(jR) = hBAC(mstr,ior) 
      O2BSB(jR) = hO2BSB(mstr,ior) 
!                                                                       
      bl01(jR) = hbl01(mstr,ior) 
      bl02(jR) = hbl02(mstr,ior) 
      vnh4(jR) = hnh4(mstr,ior) 
      vo2(jR) = ho2(mstr,ior) 
      vno3(jR) = hno3(mstr,ior) 
      vno2(jR) = hno2(mstr,ior) 
      vx0(jR) = hx0(mstr,ior) 
      vx02(jR) = hx02(mstr,ior) 
      si(jR) = hsi(mstr,ior) 
      sised(jR) = hsised(mstr,ior) 
      SKmor(jR) = hSKmor(mstr,ior) 
      chla(jR) = hchla(mstr,ior) 
      aki(jR) = haki(mstr,ior) 
      agr(jR) = hagr(mstr,ior) 
      abl(jR) = habl(mstr,ior) 
      chlaki(jR) = hchlak(mstr,ior) 
      chlagr(jR) = hchlag(mstr,ior) 
      chlabl(jR) = hchlab(mstr,ior) 
      vkigr(jR) = hvkigr(mstr,ior) 
      antbl(jR) = hantbl(mstr,ior) 
      abrzo1(jR) = habrz1(mstr,ior) 
      ssalg(jR) = hssalg(mstr,ior) 
      ss(jR) = hss(mstr,ior) 
      zooind(jR) = hzooi(mstr,ior) 
      gelp(jR) = hgelp(mstr,ior) 
      mw(jR) = hmw(mstr,ior) 
      pw(jR) = hpw(mstr,ior) 
      ca(jR) = hca(mstr,ior) 
      lf(jR) = hlf(mstr,ior) 
      vph(jR) = hph(mstr,ior) 
      dlarvn(jR) = hdlarn(mstr,ior) 
      vbsb(jR) = hvbsb(mstr,ior) 
      vcsb(jR) = hvcsb(mstr,ior) 
      stind(jR) = hstind(mstr,ior) 
      coli(jR) = hcoli(mstr,ior) 
      jiein(jR) = hjiein(mstr,ior) 
      Dz2D(jR) = hDz2D(mstr,ior) 
!                                                                       
!...nur Tracer                                                          
      if(iwsim.eq.4)goto 889 
!  2D-Modellierung                                                      
!                                                                       
      nkzs(jR) = hnkzs(mstr,ior) 
      dH2De(jR) = hdH2De(mstr,ior) 
      do 400 nkz = 1,nkzs(jR) 
      tempwz(nkz,jR) = htempz(mstr,nkz,ior) 
      vnh4z(nkz,jR) = hnh4z(mstr,nkz,ior) 
      vno2z(nkz,jR) = hno2z(mstr,nkz,ior) 
      vno3z(nkz,jR) = hno3z(mstr,nkz,ior) 
      vo2z(nkz,jR) = ho2z(mstr,nkz,ior) 
      gelPz(nkz,jR) = hgelPz(mstr,nkz,ior) 
      Siz(nkz,jR) = hSiz(mstr,nkz,ior) 
      akiz(nkz,jR) = hakiz(mstr,nkz,ior) 
      agrz(nkz,jR) = hagrz(mstr,nkz,ior) 
      ablz(nkz,jR) = hablz(mstr,nkz,ior) 
      chlaz(nkz,jR) = hchlaz(mstr,nkz,ior) 
  400 continue 
!                                                                       
      pflmin(jR) = hpfmnl(mstr,ior) 
      pflmax(jR) = hpfmxl(mstr,ior) 
      ischif(jR) = hischf(mstr,ior) 
      do 661 ndr = 1,nndr 
      zdrei(jR,ndr) = hzdrel(mstr,ior,ndr) 
      zdreis(jR,ndr) = hzdrsl(mstr,ior,ndr) 
  661 gewdr(jR,ndr) = hgwdrl(mstr,ior,ndr) 
      dlmax(jR) = hdlmx(mstr,ior) 
      dlmaxs(jR) = hdlmxs(mstr,ior) 
      gwdmax(jR) = hgwdmx(mstr,ior) 
      sgwmue(jR) = hsgwmu(mstr,ior) 
      abegm2(jR) = habgml(mstr,ior) 
      abekm2(jR) = habkml(mstr,ior) 
      do 662 ico = 1,5 
      coro(jR,ico) = hcoro2(mstr,ior,ico) 
  662 coros(jR,ico) = hcos2(mstr,ior,ico) 
!                                                                       
!.....Ufervegetation                                                    
      Do 847 iV = 1,14 
  847 VTYP(jR,iV) = VTYPH(mstr,ior,iV) 
      VALTBL(jR) = VALTLH(mstr,ior) 
      EDUFBL(jR) = EDUFLH(mstr,ior) 
      VALTBR(jR) = VALTRH(mstr,ior) 
      EDUFBR(jR) = EDUFRH(mstr,ior) 
!                                                                       
      if(ieros.eq.0)goto 889 
!....Umdrehen der Sedimentgroessen                                      
      sedh(jR) = sedhg(mstr,ior) 
      ischic(jR) = ischig(mstr,ior) 
      do 462 itau = 1,50 
  462 tausc(jR,itau) = tauscg(mstr,ior,itau) 
!                                                                       
!....falls Fliessumkehr auch Buhnenfeldparameter drehen!!               
  889 continue 
!                                                                       
!                                                                       
      dtmin = 99999. 
      do 614 ior = 1,anze+1 
      fkm(ior) = hfkm(mstr,ior) 
      flag(ior) = hflag(mstr,ior) 
      jiein(ior) = hjiein(mstr,ior) 
      elen(ior) = helen(mstr,ior) 
      vmitt(ior) = abs(hvmitt(mstr,ior)) 
      tiefe(ior) = htiefe(mstr,ior) 
      rau(ior) = hrau(mstr,ior) 
      rhyd(ior) = hrhyd(mstr,ior) 
      flae(ior) = hflae(mstr,ior) 
      lboem(ior) = hlboem(mstr,ior) 
      if(lboem(ior).le.0.0)lboem(ior) = 0.0000001 
      bsohlm(ior) = hbsohl(mstr,ior) 
      vabfl(ior) = hvabfl(mstr,ior) 
!                                                                       
      if(nbuhn(mstr).eq.0)goto 300 
      tau2(ior) = 1./(htau2(mstr,ior)*3600.) 
!                                                                       
!                                                                       
!     Berechnung des Abschnittsvolumens vol(ior)                        
!                                                                       
  300 elenl = elen(ior) 
      if(elenl.le.0.01)elenl = 0.0 
      vol(ior) = flae(ior)*elenl 
!                                                                       
!....falls idl = 1 wird der long. Dispersionskoeff eingelesen           
!....andernfalls wird er berechnet                                      
      if(idl.eq.1)then 
      dl(ior) = hdl(mstr,ior) 
      goto 613 
      endif 
!                                                                       
      ust = (((1./rau(ior))*9.81**0.5)/(tiefe(ior)**0.16667))*vmitt(ior) 
!                                                                       
!....Berechnung des longitudinalen Dispersionskoeff. nach DENG          
!                                                                       
!                                                                       
      krumm = 1.5 
      alpha = 1.5 
      if(dlalph(mstr,ior).gt.0.0)alpha = dlalph(mstr,ior) 
!                                                                       
      Breite(ior) = flae(ior)/Tiefe(Ior) 
      Integra = (0.0083*(krumm-1)**3-0.0168*(krumm-1)**2                &
     &+0.0167*(krumm-1)+0.0012)-0.0013*(Breite(ior)/Tiefe(ior))         &
     &**(-0.3523)                                                       
      MStern = 0.145+((1./3520.)*(vmitt(ior)/ust)*                      &
     &(Breite(ior)/Tiefe(ior))**alpha)                                  
      Dl(ior) = (Integra/MStern)*(vmitt(ior)/ust)**2*                   &
     &(Breite(ior)/Tiefe(ior))**2*ust*Tiefe(ior)                        
!                                                                       
  613 dtneu = elen(ior)**2*100./DL(ior) 
      if(dtneu.lt.dtmin.and.ior.le.anze)dtmin = dtneu 
!                                                                       
  614 continue 
      flag(anze+1) = 0 
!                                                                       
!      STRiz(mstr) = int((tflie*86400.)/dtmin)+1                        
!      if(Striz(mstr).lt.6)Striz(mstr) = 6                              
!      if(Striz(mstr).gt.100)Striz(mstr) = 100                          
!       write(89,*)mstr,Striz(mstr)                                     
!                                                                       
!..........................................                             
!..         BAUSTEINE                    ..                             
!..........................................                             
!                                                                       
!...nur Tracer                                                          
  615 if(iwsim.eq.4)goto 705 
      call strahlg(glob,uhrz,sa,su,schwi,tflie,geol,tdj,geob,dk         &
     &,cloud,schwia,imet,mstr,IDWe,itags,monats,VTYP,VALTBL,EDUFBL      &
     &,VALTBR,EDUFBR,breite,anze,ifehl,ifhStr)                          
      if(ifehl.gt.0)goto 989 
!                                                                       
      call Temperl(SA,SU,Uhrz,TEMPL,mstr,IDWe,TLMAX,TLMIN,anze,imet) 
!                                                                       
  705 if(nbuhn(mstr).eq.0)goto 709 
!                                                                       
!....Berechnung der Austauschraten zwischen Hauptstrom und Buhnenfelder 
      do 1113 ior = 1,anze 
      hctau1(ior) = ((bf(mstr,ior)/flae(ior))*tau2(ior))                &
     &*tflie*86400.                                                     
      hctau2(ior) = tau2(ior)*tflie*86400. 
      hconF = bf(mstr,ior)/flae(ior) 
      htau1m = -0.3196*hconF**2+0.8026*hconF+0.0122 
      if(hctau1(ior).gt.htau1m)then 
      hctau1(ior) = htau1m 
      hctau2(ior) = 1.-htau1m 
      endif 
 1113 continue 
  709 if(iwsim.eq.2.or.iwsim.eq.4)goto 113 
!                                                                       
!***************Sediment-Stofffluxe********                             
 1712 continue 
      call sedflux(tiefe,vmitt,rau,hw2,hSedOM,hdKorn,vO2,vNO3,vNH4,gelP &
     &,Tempw,anze,mstr,hJNO3,hJNH4,hJPO4,hJO2,orgCsd,sedalk,sedalg      &
     &,sedalb,sedSS,KNH4e,kapN3e,tflie,ilbuhn,itags,monats,uhrz,vo2z    &
     &,nkzs)                                                            
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1612 
      if(ilbuhn.eq.0)then 
      do 1710 ior=1,anze+1 
      zww2(ior) = hw2(mstr,ior) 
      zwSdOM(ior) = hSedOM(mstr,ior) 
      zwKorn(ior) = hdKorn(mstr,ior) 
      zwtemp(ior) = tempw(ior) 
      zwvm(ior) = vmitt(ior) 
      zwtief(ior) = tiefe(ior) 
      zwvo2(ior) = vo2(ior) 
      zwno3(ior) = vno3(ior) 
      zwnh4(ior) = vnh4(ior) 
      zwgelp(ior) = gelp(ior) 
      zwJNO3(ior) = hJNO3(mstr,ior) 
      zwJNH4(ior) = hJNH4(mstr,ior) 
      zwJPO4(ior) = hJPO4(mstr,ior) 
      zwJO2(ior) = hJO2(mstr,ior) 
      zwsedS(ior) = sedss(ior) 
      zwCsed(ior) = orgCsd(ior) 
      zwsedk(ior) = sedalk(ior) 
      zwsedg(ior) = sedalg(ior) 
      zwsedb(ior) = sedalb(ior) 
!                                                                       
      hw2(mstr,ior) = bw2(mstr,ior) 
      hSedOM(mstr,ior) = bSedOM(mstr,ior) 
      hdKorn(mstr,ior) = bdKorn(mstr,ior) 
      tempw(ior) = btempw(mstr,ior) 
      vmitt(ior) = vbm(mstr,ior) 
      tiefe(ior) = bh(mstr,ior) 
      vo2(ior) = bo2(mstr,ior) 
      vno3(ior) = bno3(mstr,ior) 
      vnh4(ior) = bnh4(mstr,ior) 
      gelp(ior) = bgelp(mstr,ior) 
      sedSS(ior) = bsedSS(mstr,ior) 
      sedalk(ior) = bsedak(mstr,ior) 
      sedalg(ior) = bsedag(mstr,ior) 
      sedalb(ior) = bsedab(mstr,ior) 
      orgCsd(ior) = borgCs(mstr,ior) 
!                                                                       
 1710 continue 
      ilbuhn = 1 
      goto 1712 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1714 ior=1,anze+1 
      bJNO3(mstr,ior) = hJNO3(mstr,ior) 
      bJNH4(mstr,ior) = hJNH4(mstr,ior) 
      bJPO4(mstr,ior) = hJPO4(mstr,ior) 
      bJO2(mstr,ior) = hJO2(mstr,ior) 
      tempw(ior) = zwtemp(ior) 
      tiefe(ior) = zwtief(ior) 
      vmitt(ior) = zwvm(ior) 
      vo2(ior) = zwvo2(ior) 
      vno3(ior) = zwno3(ior) 
      vnh4(ior) = zwnh4(ior) 
      gelp(ior) = zwgelp(ior) 
      hw2(mstr,ior) = zww2(ior) 
      hSedOM(mstr,ior) = zwSdOM(ior) 
      hdKorn(mstr,ior) = zwKorn(ior) 
      hJNO3(mstr,ior) = zwJNO3(ior) 
      hJNH4(mstr,ior) = zwJNH4(ior) 
      hJPO4(mstr,ior) = zwJPO4(ior) 
      hJO2(mstr,ior) = zwJO2(ior) 
      sedss(ior) = zwsedS(ior) 
      sedalk(ior) = zwsedk(ior) 
      sedalg(ior) = zwsedg(ior) 
      sedalb(ior) = zwsedb(ior) 
      orgCsd(ior) = zwCsed(ior) 
 1714 continue 
      ilbuhn = 0 
      endif 
!                                                                       
!***********Rotatorien***********************                           
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1612 
!                                                                       
 1612 if(Zooind(1).lt.0.0)goto 1415 
      call konsum(vkigr,TEMPW,VO2,TFLIE,VMITT                           &
     &,ezind,ZOOIND,abszo,ir,flag,elen,ior,anze,qeinl,vabfl             &
     &,jiein,FopIRe,GRote,dzres1,dzres2,zresge                          &
     &,irmaxe,zexki,zexgr,zexbl                                         &
     &,aki,agr,abl,iwied,rmuas,iras                                     &
     &,rakr,rbar,CHNF,zHNF,ilbuhn,zakie,zagre,zable,HNFza,algzok        &
     &,algzog,algzob,akiz,agrz,ablz,algzkz,algzgz,algzbz,nkzs,monats    &
     &,itags,mstr,itrein)                                               
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1415 
      if(ilbuhn.eq.0)then 
      do 1681 ior=1,anze+1 
      zwtemp(ior) = tempw(ior) 
      zwvm(ior) = vmitt(ior) 
      zwir(ior) = ir(ior) 
      zwkigr(ior) = vkigr(ior) 
      zwantb(ior) = antbl(ior) 
      zwaki(ior) = aki(ior) 
      zwagr(ior) = agr(ior) 
      zwabl(ior) = abl(ior) 
      do 1790 nkz = 1,nkzs(ior) 
      zwakiz(nkz,ior) = akiz(nkz,ior) 
      zwagrz(nkz,ior) = agrz(nkz,ior) 
      zwablz(nkz,ior) = ablz(nkz,ior) 
 1790 zwchlz(nkz,ior) = chlaz(nkz,ior) 
      zwvo2(ior) = vo2(ior) 
      zwzooi(ior) = zooind(ior) 
      zwabsz(ior) = abszo(ior) 
      zwdzr1(ior) = dzres1(ior) 
      zwdzr2(ior) = dzres2(ior) 
      zwzexk(ior) = zexki(ior) 
      zwzexg(ior) = zexgr(ior) 
      zwzexb(ior) = zexbl(ior) 
      zwrmue(ior) = rmuas(ior) 
      zwiras(ior) = iras(ior) 
      zwrakr(ior) = rakr(ior) 
      zwrbar(ior) = rbar(ior) 
      zwzok(ior) = algzok(ior) 
      zwzog(ior) = algzog(ior) 
      zwzob(ior) = algzob(ior) 
!                                                                       
!                                                                       
      tempw(ior) = btempw(mstr,ior) 
      vmitt(ior) = vbm(mstr,ior) 
      vkigr(ior) = bvkigr(mstr,ior) 
      antbl(ior) = bantbl(mstr,ior) 
      aki(ior) = baki(mstr,ior) 
      agr(ior) = bagr(mstr,ior) 
      abl(ior) = babl(mstr,ior) 
      vo2(ior) = bo2(mstr,ior) 
      zooind(ior) = bzooi(mstr,ior) 
!                                                                       
 1681 continue 
      ilbuhn = 1 
      goto 1612 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1682 ior=1,anze+1 
      bir(mstr,ior) = ir(ior) 
      bzooi(mstr,ior) = zooind(ior) 
      babszo(mstr,ior) = abszo(ior) 
      bzres1(mstr,ior) = dzres1(ior) 
      bzres2(mstr,ior) = dzres2(ior) 
      bzexki(mstr,ior) = zexki(ior) 
      bzexgr(mstr,ior) = zexgr(ior) 
      bzexbl(mstr,ior) = zexbl(ior) 
      brmuas(mstr,ior) = rmuas(ior) 
      biras(mstr,ior) = iras(ior) 
      brakr(mstr,ior) = rakr(ior) 
      brbar(mstr,ior) = rbar(ior) 
      bazok(mstr,ior) = algzok(ior) 
      bazog(mstr,ior) = algzog(ior) 
      bazob(mstr,ior) = algzob(ior) 
!                                                                       
!                                                                       
      tempw(ior) = zwtemp(ior) 
      vmitt(ior) = zwvm(ior) 
      ir(ior) = zwir(ior) 
      vkigr(ior) = zwkigr(ior) 
      antbl(ior) = zwantb(ior) 
      aki(ior) = zwaki(ior) 
      agr(ior) = zwagr(ior) 
      abl(ior) = zwabl(ior) 
      do 1791 nkz = 1,nkzs(ior) 
      akiz(nkz,ior) = zwakiz(nkz,ior) 
      agrz(nkz,ior) = zwagrz(nkz,ior) 
      ablz(nkz,ior) = zwablz(nkz,ior) 
 1791 chlaz(nkz,ior) = zwchlz(nkz,ior) 
      vo2(ior) = zwvo2(ior) 
      zooind(ior) = zwzooi(ior) 
      abszo(ior) = zwabsz(ior) 
      dzres1(ior) = zwdzr1(ior) 
      dzres2(ior) = zwdzr2(ior) 
      zexki(ior) = zwzexk(ior) 
      zexgr(ior) = zwzexg(ior) 
      zexbl(ior) = zwzexb(ior) 
      rmuas(ior) = zwrmue(ior) 
      iras(ior) = zwiras(ior) 
      rakr(ior) = zwrakr(ior) 
      rbar(ior) = zwrbar(ior) 
      algzok(ior) = zwzok(ior) 
      algzog(ior) = zwzog(ior) 
      algzob(ior) = zwzob(ior) 
!                                                                       
      dzooi1(ior) = bzooi(mstr,ior)-zooind(ior) 
      dzooi2(ior) = zooind(ior)-bzooi(mstr,ior) 
!                                                                       
      zooind(ior) = zooind(ior)+hctau1(ior)*dzooi1(ior) 
!                                                                       
      if(hctau2(ior).eq.0.0)goto 1682 
!                                                                       
      bzooi(mstr,ior) = bzooi(mstr,ior)+hctau2(ior)*dzooi2(ior) 
 1682 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!                                                                       
!***************Chorophium******************                            
!                                                                       
 1415 continue 
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1440 
      do 1783 ior = 1,anze+1 
      do 1784 jC=1,5 
      zwcoro(ior,jC) = coro(ior,jC) 
 1784 Coro(ior,jC) = 0.0 
 1783 continue 
!                                                                       
 1440 call coroph(coro,coros,tempw,flae,elen,anze,ior                   &
     &,volfco,aki,agr,algcok,algcog,tflie,bsohlm,lboem,coroI            &
     &,coroIs,abl,algcob,mStas,mstr                                     &
     &,itco1,itco2,itco3,itags,monats,ilang)                            
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1441 
      if(ilbuhn.eq.0)then 
      do 1786 ior=1,anze+1 
      zwtemp(ior) = tempw(ior) 
      zwflae(ior) = flae(ior) 
      zwlboe(ior) = lboem(ior) 
      zwaki(ior) = aki(ior) 
      zwagr(ior) = agr(ior) 
      zwabl(ior) = abl(ior) 
      zwacok(ior) = algcok(ior) 
      zwacog(ior) = algcog(ior) 
      zwacob(ior) = algcob(ior) 
      zwCoIs(ior) = coroIs(ior) 
      do 1785 jC=1,5 
      zwcors(ior,jC) = coros(ior,jC) 
      Coros(ior,jC) = 0.0 
 1785 coro(ior,jC) = zwcoro(ior,jC) 
!                                                                       
      flae(ior) = bf(mstr,ior) 
      lboem(ior) = blb(mstr,ior) 
      tempw(ior) = btempw(mstr,ior) 
      aki(ior) = baki(mstr,ior) 
      agr(ior) = bagr(mstr,ior) 
      abl(ior) = babl(mstr,ior) 
!                                                                       
 1786 continue 
      ilbuhn = 1 
      goto 1440 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1787 ior=1,anze+1 
      bacok(mstr,ior) = algcok(ior) 
      bacog(mstr,ior) = algcog(ior) 
      bacob(mstr,ior) = algcob(ior) 
!                                                                       
      flae(ior) = zwflae(ior) 
      lboem(ior) = zwlboe(ior) 
      tempw(ior) = zwtemp(ior) 
      CoroIs(ior) = zwCoIs(ior) 
      do 1788 jC=1,5 
 1788 coros(ior,jC) = zwcors(ior,jC) 
      aki(ior) = zwaki(ior) 
      agr(ior) = zwagr(ior) 
      abl(ior) = zwabl(ior) 
      algcok(ior) = zwacok(ior) 
      algcog(ior) = zwacog(ior) 
      algcob(ior) = zwacob(ior) 
!                                                                       
 1787 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!                                                                       
!                                                                       
!*************Dreissena*******************                              
!                                                                       
 1441 continue 
!                                                                       
      call dreissen(zdrei,zdreis,tempw,flae,elen,anze                   &
     &,ior,volfdr,akbcm,agbcm,aki,agr,algdrk,algdrg                     &
     &,tflie,ro2dr,lboem,bsohlm,ss,vo2,ssdr,drfaek                      &
     &,drfaeg,drfaes,gewdr,dlarvn,itags,monats                          &
     &,lait1,laim1,laid1,drrt,drft,stdpla,ilang                         &
     &,resdr,exdrvg,exdrvk,ssalg,drpfec                                 &
     &,abl,exdrvb,abbcm,algdrb,drfaeb                                   &
     &,idras,drmas,drakr,drbar,drmor,ffood,coroI,coroIs                 &
     &,CHNF,drHNF,HNFdra,dlmax,dlmaxs,gwdmax                            &
     &,sgwmue,fkm,FoptDe,mstr,itrein)                                   
!                                                                       
!***************hetrero. Nanoflagelaten (HNF)********                   
!                                                                       
  218 continue 
      if(CHNF(1).le.0.0)goto 1412 
      call HNF(CHNF,BVHNF,BAC,TEMPW,VO2,TFLIE,VMITT                     &
     &,echnf,eBVHNF,flag,elen,ior,anze,qeinl,vabfl                      &
     &,jiein,drHNF,zHNF,HNFBAC,rO2HNF,BSBHNF,HNFmua,upHNFe,BACkse       &
     &,HNFrea,HNFupa,HNFmoa,HNFexa,fkm,mstr,itrein)                     
!                                                                       
!                                                                       
!***********Kieselalgen***************                                  
!                                                                       
 1412 continue 
!      chla(1) = -1.                                                    
      if(Chla(1).lt.0.0)goto 1513 
                                                                        
!                                                                       
      call algaeski(SCHWI,TFLIE,TEMPW                                   &
     &,RAU,TIEFE,VMITT,VNO3,VNH4,GELP,svhemk,CHLA,ir                    &
     &,SI,dalgki,dalgak,flag,elen,ior,anze                              &
     &,sedalk,algzok,echla,qeinl,vabfl                                  &
     &,dkimor,fkm,jiein,evkigr,vkigr,antbl,eantbl                       &
     &,akchl,akgmax,akksn,akksp,akkssi,saettk,akremi,akrema             &
     &,sbioki,vco2,iph,akbcm,abbcm,agbcm,aki,abl,agr,extk               &
     &,uhrz,sised,tpki,iwied,akmuea,ftaaus,fiaus,fheaus                 &
     &,akraus,tauscs,ischif,ilbuhn,ieros,askie,cmatki,algdrk            &
     &,algcok,ess,zooind,GRote,SS,Q_PK,Q_NK,Q_SK                        &
     &,vNH4z,vNO3z,gelPz,Siz,dalgkz,nkzs,dH2D,dH2De,tempwz,cpfad        &
     &,up_PKz,up_NKz,up_Siz,Qmx_PK,Qmn_PK,upmxPK                        &
     &,Qmx_NK,Qmn_NK,upmxNK,Qmx_SK,Qmn_SK,upmxSK,SKmor,IKke,frmuke      &
     &,alamda,akitbr,chlaz,akibrz,akiz,algakz,algzkz,ablz,agrz          &
     &,Dz2D,mstr,itags,monats,itrein)                                   
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1413 
      if(ilbuhn.eq.0)then 
      do 1581 ior=1,anze+1 
      zwtemp(ior) = tempw(ior) 
      zwtief(ior) = tiefe(ior) 
      zwvm(ior) = vmitt(ior) 
      zwno3(ior) = vno3(ior) 
      zwnh4(ior) = vnh4(ior) 
      zwgelp(ior) = gelp(ior) 
      zwsvhk(ior) = svhemk(ior) 
      zwchla(ior) = chla(ior) 
      zwzooi(ior) = zooind(ior) 
      zwir(ior) = ir(ior) 
      zwssa(ior) = ssalg(ior) 
      zwsi(ior) = si(ior) 
      zwdalk(ior) = dalgki(ior) 
      zwdaak(ior) = dalgak(ior) 
      zwsedk(ior) = sedalk(ior) 
      zwzok(ior) = algzok(ior) 
      zwadrk(ior) = algdrk(ior) 
      zwacok(ior) = algcok(ior) 
      zwkmor(ior) = dkimor(ior) 
      zwkigr(ior) = vkigr(ior) 
      zwantb(ior) = antbl(ior) 
      zwkbcm(ior) = akbcm(ior) 
      zwgbcm(ior) = agbcm(ior) 
      zwbbcm(ior) = abbcm(ior) 
      zwaki(ior) = aki(ior) 
      zwagr(ior) = agr(ior) 
      zwabl(ior) = abl(ior) 
      zwsisd(ior) = sised(ior) 
      zwSKmo(ior) = SKmor(ior) 
      zwkmua(ior) = akmuea(ior) 
      zwfta(ior) = ftaaus(ior) 
      zwfia(ior) = fiaus(ior) 
      zwfhea(ior) = fheaus(ior) 
      zwkrau(ior) = akraus(ior) 
      zwtpki(ior) = tpki(ior) 
      zwextk(ior) = extk(ior) 
      zup_PK(ior) = up_PKz(1,ior) 
      zup_NK(ior) = up_NKz(1,ior) 
      zup_Si(ior) = up_Siz(1,ior) 
      zQ_PK(ior) = Q_PK(ior) 
      zQ_NK(ior) = Q_NK(ior) 
      zQ_SK(ior) = Q_SK(ior) 
      zaktbr(ior) = akibrz(1,ior) 
      zwakz(ior) = dalgkz(1,ior) 
      zwaakz(ior) = algakz(1,ior) 
      zwnkzs(ior) = nkzs(ior) 
      zwN4z(ior) = vNH4z(1,ior) 
      zwN3z(ior) = vNO3z(1,ior) 
      zwSiz(ior) = Siz(1,ior) 
      zwPz(ior) = gelPz(1,ior) 
!                                                                       
!                                                                       
      tempw(ior) = btempw(mstr,ior) 
      tiefe(ior) = bh(mstr,ior) 
      vmitt(ior) = vbm(mstr,ior) 
      vno3(ior) = bno3(mstr,ior) 
      vnh4(ior) = bnh4(mstr,ior) 
      gelp(ior) = bgelp(mstr,ior) 
      svhemk(ior) = bsvhek(mstr,ior) 
      chla(ior) = bchla(mstr,ior) 
      zooind(ior) = bzooi(mstr,ior) 
      ir(ior) = bir(mstr,ior) 
      ssalg(ior) = bssalg(mstr,ior) 
      si(ior) = bsi(mstr,ior) 
      dalgki(ior) = bdaki(mstr,ior) 
      dalgak(ior) = bdaak(mstr,ior) 
      sedalk(ior) = bsedak(mstr,ior) 
      dkimor(ior) = bdkmor(mstr,ior) 
      algzok(ior) = bazok(mstr,ior) 
      algdrk(ior) = badrk(mstr,ior) 
      algcok(ior) = bacok(mstr,ior) 
      vkigr(ior) = bvkigr(mstr,ior) 
      antbl(ior) = bantbl(mstr,ior) 
      akbcm(ior) = bakbcm(mstr,ior) 
      agbcm(ior) = bagbcm(mstr,ior) 
      abbcm(ior) = babbcm(mstr,ior) 
      aki(ior) = baki(mstr,ior) 
      agr(ior) = bagr(mstr,ior) 
      abl(ior) = babl(mstr,ior) 
      sised(ior) = bsised(mstr,ior) 
      SKmor(ior) = bSKmor(mstr,ior) 
      Q_PK(ior) = bQ_PK(mstr,ior) 
      Q_NK(ior) = bQ_NK(mstr,ior) 
      Q_SK(ior) = bQ_SK(mstr,ior) 
      vNH4z(1,ior) = bnh4(mstr,ior) 
      vNO3z(1,ior) = bno3(mstr,ior) 
      Siz(1,ior) = bsi(mstr,ior) 
      gelPz(1,ior) = bgelp(mstr,ior) 
!                                                                       
 1581 continue 
      ilbuhn = 1 
      goto 1412 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1582 ior=1,anze+1 
      bsvhek(mstr,ior) = svhemk(ior) 
      bdaki(mstr,ior) = dalgki(ior) 
      bdaak(mstr,ior) = dalgak(ior) 
      bsedak(mstr,ior) = sedalk(ior) 
      bdkmor(mstr,ior) = dkimor(ior) 
      bakbcm(mstr,ior) = akbcm(ior) 
      bagbcm(mstr,ior) = agbcm(ior) 
      babbcm(mstr,ior) = abbcm(ior) 
      baki(mstr,ior) = aki(ior) 
      bagr(mstr,ior) = agr(ior) 
      babl(mstr,ior) = abl(ior) 
      bsised(mstr,ior) = sised(ior) 
      bSKmor(mstr,ior) = SKmor(ior) 
      bakmua(mstr,ior) = akmuea(ior) 
      bftaau(mstr,ior) = ftaaus(ior) 
      bfiaus(mstr,ior) = fiaus(ior) 
      bfheau(mstr,ior) = fheaus(ior) 
      bakrau(mstr,ior) = akraus(ior) 
      btpki(mstr,ior) = tpki(ior) 
      bextk(mstr,ior) = extk(ior) 
      bQ_PK(mstr,ior) = Q_PK(ior) 
      bQ_NK(mstr,ior) = Q_NK(ior) 
      bQ_SK(mstr,ior) = Q_SK(ior) 
      bup_PK(mstr,ior) = up_PKz(1,ior) 
      bup_NK(mstr,ior) = up_NKz(1,ior) 
      bup_Si(mstr,ior) = up_Siz(1,ior) 
      baktbr(mstr,ior) = akibrz(1,ior) 
      balgkz(mstr,ior) = dalgkz(1,ior) 
      balakz(mstr,ior) = algakz(1,ior) 
!                                                                       
!                                                                       
      tempw(ior) = zwtemp(ior) 
      tiefe(ior) = zwtief(ior) 
      vmitt(ior) = zwvm(ior) 
      vno3(ior) = zwno3(ior) 
      vnh4(ior) = zwnh4(ior) 
      gelp(ior) = zwgelp(ior) 
      svhemk(ior) = zwsvhk(ior) 
      chla(ior) = zwchla(ior) 
      zooind(ior) = zwzooi(ior) 
      ir(ior) = zwir(ior) 
      ssalg(ior) = zwssa(ior) 
      si(ior) = zwsi(ior) 
      dalgki(ior) = zwdalk(ior) 
      dalgak(ior) = zwdaak(ior) 
      sedalk(ior) = zwsedk(ior) 
      algzok(ior) = zwzok(ior) 
      algdrk(ior) = zwadrk(ior) 
      algcok(ior) = zwacok(ior) 
      dkimor(ior) = zwkmor(ior) 
      vkigr(ior) = zwkigr(ior) 
      antbl(ior) = zwantb(ior) 
      akbcm(ior) = zwkbcm(ior) 
      aki(ior) = zwaki(ior) 
      agr(ior) = zwagr(ior) 
      abl(ior) = zwabl(ior) 
      sised(ior) = zwsisd(ior) 
      SKmor(Ior) = zwSKmo(ior) 
      akmuea(ior) = zwkmua(ior) 
      ftaaus(ior) = zwfta(ior) 
      fiaus(ior) = zwfia(ior) 
      fheaus(ior) = zwfhea(ior) 
      akraus(ior) = zwkrau(ior) 
      tpki(ior) = zwtpki(ior) 
      extk(ior) = zwextk(ior) 
      up_PKz(1,ior) = zup_PK(ior) 
      up_NKz(1,ior) = zup_NK(ior) 
      up_Siz(1,ior) = zup_Si(ior) 
      Q_PK(ior) = zQ_PK(ior) 
      Q_NK(ior) = zQ_NK(ior) 
      Q_SK(ior) = zQ_SK(ior) 
      akibrz(1,ior) = zaktbr(ior) 
      dalgkz(1,ior) = zwakz(ior) 
      algakz(1,ior) = zwaakz(ior) 
!                                                                       
      nkzs(ior) = zwnkzs(ior) 
      vNH4z(1,ior) = zwN4z(ior) 
      vNO3z(1,ior) = zwN3z(ior) 
      siz(1,ior) = zwsiz(ior) 
      gelPz(1,ior) = zwPz(ior) 
!                                                                       
!                                                                       
      dvhek1(ior) = bsvhek(mstr,ior)-svhemk(ior) 
      dSKmo1(ior) = bSKmor(mstr,ior)-SKmor(ior) 
!                                                                       
      dvhek2(ior) = svhemk(ior)-bsvhek(mstr,ior) 
      dSKmo2(ior) = SKmor(ior)-bSKmor(mstr,ior) 
!                                                                       
      svhemk(ior) = svhemk(ior)+hctau1(ior)*dvhek1(ior) 
      SKmor(ior) = SKmor(ior)+hctau1(ior)*dSKmo1(ior) 
      if(svhemk(ior).lt.0.0)svhemk(ior) = 0.0 
      if(SKmor(ior).lt.0.0)SKmor(ior) = 0.0 
!                                                                       
      if(hctau2(ior).eq.0.0)goto 1582 
!                                                                       
      bsvhek(mstr,ior) = bsvhek(mstr,ior)+hctau2(ior)*dvhek2(ior) 
      bSKmor(mstr,ior) = bSKmor(mstr,ior)+hctau2(ior)*dSKmo2(ior) 
      if(bsvhek(mstr,ior).lt.0.0)bsvhek(mstr,ior) = 0.0 
      if(bSKmor(mstr,ior).lt.0.0)bSKmor(mstr,ior) = 0.0 
 1582 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!                                                                       
!**********************Blaualgen******************                      
!                                                                       
 1413 continue 
!                                                                       
      call algaesbl(SCHWI,TFLIE,TEMPW,flag,elen                         &
     &,RAU,TIEFE,VMITT,VNO3,VNH4,GELP,svhemb,CHLA,ir                    &
     &,dalgbl,dalgab,ior,anze,sedalb,algzob,dblmor,fkm,vabfl            &
     &,abchl,abgmax,abksn,abksp,saettb,abremi                           &
     &,vco2,iph,vkigr,abbcm,abl,tpbl,uhrz,iwied                         &
     &,fibaus,abmuea,fhebas,abreau,tauscs,ischif,ilbuhn,ieros           &
     &,zakie,zagre,zable,asble,qeinl,jiein,echla,ess                    &
     &,algdrb,algcob,antbl,zooind,GRote,SS,extk                         &
     &,vNH4z,vNO3z,gelPz,dalgbz,nkzs,dH2D,dH2De,tempwz,cpfad            &
     &,up_PBz,up_NBz,Qmx_PB,Qmn_PB,upmxPB                               &
     &,Qmx_NB,Qmn_NB,upmxNB,Q_NB,Q_PB,IKbe,frmube,alamda,abltbr         &
     &,chlaz,ablbrz,up_N2z,ablz,algabz,algzbz,Dz2D                      &
     &,mstr,itags,monats)                                               
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1414 
!                                                                       
      if(ilbuhn.eq.0)then 
      do 1584 ior=1,anze+1 
      zwtemp(ior) = tempw(ior) 
      zwtief(ior) = tiefe(ior) 
      zwvm(ior) = vmitt(ior) 
      zwno3(ior) = vno3(ior) 
      zwnh4(ior) = vnh4(ior) 
      zwgelp(ior) = gelp(ior) 
      zwsvhb(ior) = svhemb(ior) 
      zwchla(ior) = chla(ior) 
      zwzooi(ior) = zooind(ior) 
      zwir(ior) = ir(ior) 
      zwssa(ior) = ssalg(ior) 
      zwsi(ior) = si(ior) 
      zwdalb(ior) = dalgbl(ior) 
      zwdaab(ior) = dalgab(ior) 
      zwsedb(ior) = sedalb(ior) 
      zwzob(ior) = algzob(ior) 
      zwadrb(ior) = algdrb(ior) 
      zwacob(ior) = algcob(ior) 
      zwbmor(ior) = dblmor(ior) 
      zwkigr(ior) = vkigr(ior) 
      zwantb(ior) = antbl(ior) 
      zwbbcm(ior) = abbcm(ior) 
      zwabl(ior) = abl(ior) 
      zwbmua(ior) = abmuea(ior) 
      zwfiba(ior) = fibaus(ior) 
      zwfhba(ior) = fhebas(ior) 
      zwbrau(ior) = abreau(ior) 
      zwtpbl(ior) = tpbl(ior) 
      zwextk(ior) = extk(ior) 
      zup_PB(ior) = up_PBz(1,ior) 
      zup_NB(ior) = up_NBz(1,ior) 
      zQ_PB(ior) = Q_PB(ior) 
      zQ_NB(ior) = Q_NB(ior) 
      zabtbr(ior) = ablbrz(1,ior) 
      zwabz(ior) = dalgbz(1,ior) 
      zwaabz(ior) = algabz(1,ior) 
      zwnkzs(ior) = nkzs(ior) 
      zwN4z(ior) = vNH4z(1,ior) 
      zwN3z(ior) = vNO3z(1,ior) 
      zwPz(ior) = gelPz(1,ior) 
!                                                                       
!                                                                       
      tempw(ior) = btempw(mstr,ior) 
      tiefe(ior) = bh(mstr,ior) 
      vmitt(ior) = vbm(mstr,ior) 
      vno3(ior) = bno3(mstr,ior) 
      vnh4(ior) = bnh4(mstr,ior) 
      gelp(ior) = bgelp(mstr,ior) 
      svhemb(ior) = bsvheb(mstr,ior) 
      chla(ior) = bchla(mstr,ior) 
      zooind(ior) = bzooi(mstr,ior) 
      ir(ior) = bir(mstr,ior) 
      ssalg(ior) = bssalg(mstr,ior) 
      si(ior) = bsi(mstr,ior) 
      vkigr(ior) = bvkigr(mstr,ior) 
      antbl(ior) = bantbl(mstr,ior) 
      abbcm(ior) = babbcm(mstr,ior) 
      extk(ior) = bextk(mstr,ior) 
      algzob(ior) = bazob(mstr,ior) 
      algdrb(ior) = badrb(mstr,ior) 
      algcob(ior) = bacob(mstr,ior) 
      abl(ior) = babl(mstr,ior) 
      Q_PB(ior) = bQ_PB(mstr,ior) 
      Q_NB(ior) = bQ_NB(mstr,ior) 
      vNH4z(1,ior) = bnh4(mstr,ior) 
      vNO3z(1,ior) = bno3(mstr,ior) 
      gelPz(1,ior) = bgelP(mstr,ior) 
!                                                                       
 1584 continue 
      ilbuhn = 1 
      goto 1413 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1575 ior=1,anze+1 
      bsvheb(mstr,ior) = svhemb(ior) 
      bdabl(mstr,ior) = dalgbl(ior) 
      bdaab(mstr,ior) = dalgab(ior) 
      bsedab(mstr,ior) = sedalb(ior) 
      bdbmor(mstr,ior) = dblmor(ior) 
      babbcm(mstr,ior) = abbcm(ior) 
      babl(mstr,ior) = abl(ior) 
      babmua(mstr,ior) = abmuea(ior) 
      bfibas(mstr,ior) = fibaus(ior) 
      bfhbau(mstr,ior) = fhebas(ior) 
      babrau(mstr,ior) = abreau(ior) 
      btpbl(mstr,ior) = tpbl(ior) 
      bQ_PB(mstr,ior) = Q_PB(ior) 
      bQ_NB(mstr,ior) = Q_NB(ior) 
      bup_PB(mstr,ior) = up_PBz(1,ior) 
      bup_NB(mstr,ior) = up_NBz(1,ior) 
      babtbr(mstr,ior) = ablbrz(1,ior) 
      balgbz(mstr,ior) = dalgbz(1,ior) 
      balabz(mstr,ior) = algabz(1,ior) 
!                                                                       
      tempw(ior) = zwtemp(ior) 
      tiefe(ior) = zwtief(ior) 
      vmitt(ior) = zwvm(ior) 
      vno3(ior) = zwno3(ior) 
      vnh4(ior) = zwnh4(ior) 
      gelp(ior) = zwgelp(ior) 
      svhemk(ior) = zwsvhk(ior) 
      chla(ior) = zwchla(ior) 
      zooind(ior) = zwzooi(ior) 
      ir(ior) = zwir(ior) 
      ssalg(ior) = zwssa(ior) 
      si(ior) = zwsi(ior) 
      dalgbl(ior) = zwdalb(ior) 
      dalgab(ior) = zwdaab(ior) 
      sedalb(ior) = zwsedb(ior) 
      algzob(ior) = zwzob(ior) 
      algdrb(ior) = zwadrb(ior) 
      algcob(ior) = zwacob(ior) 
      dblmor(ior) = zwbmor(ior) 
      vkigr(ior) = zwkigr(ior) 
      antbl(ior) = zwantb(ior) 
      abbcm(ior) = zwbbcm(ior) 
      abl(ior) = zwabl(ior) 
      abmuea(ior) = zwbmua(ior) 
      fibaus(ior) = zwfiba(ior) 
      fhebas(ior) = zwfhba(ior) 
      abreau(ior) = zwbrau(ior) 
      tpbl(ior) = zwtpbl(ior) 
      extk(ior) = zwextk(ior) 
      up_PBz(1,ior) = zup_PB(ior) 
      up_NBz(1,ior) = zup_NB(ior) 
      Q_PB(ior) = zQ_PB(ior) 
      Q_NB(ior) = zQ_NB(ior) 
      ablbrz(1,ior) = zabtbr(ior) 
      dalgbz(1,ior) = zwabz(ior) 
      algabz(1,ior) = zwaabz(ior) 
!                                                                       
      nkzs(ior) = zwnkzs(ior) 
      vNH4z(1,ior) = zwN4z(ior) 
      vNO3z(1,ior) = zwN3z(ior) 
      gelPz(1,ior) = zwPz(ior) 
!                                                                       
!                                                                       
      dvheb1(ior) = bsvheb(mstr,ior)-svhemb(ior) 
!                                                                       
      dvheb2(ior) = svhemb(ior)-bsvheb(mstr,ior) 
!                                                                       
!                                                                       
      svhemb(ior) = svhemb(ior)+hctau1(ior)*dvheb1(ior) 
      if(svhemb(ior).lt.0.0)svhemb(ior) = 0.0 
!                                                                       
      if(hctau2(ior).eq.0.0)goto 1575 
!                                                                       
      bsvheb(mstr,ior) = bsvheb(mstr,ior)+hctau2(ior)*dvheb2(ior) 
      if(bsvheb(mstr,ior).lt.0.0)bsvheb(mstr,ior) = 0.0 
 1575 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!                                                                       
!                                                                       
!**********************Gruenalgen******************                     
!                                                                       
 1414 continue 
      call algaesgr(SCHWI,TFLIE,TEMPW                                   &
     &,RAU,TIEFE,VMITT,VNO3,VNH4,GELP,svhemg,CHLA                       &
     &,SSALG,dalggr,dalgag,flag,elen,ior,anze,sedalg,algzog             &
     &,dgrmor,fkm,vkigr,chlaki,chlagr                                   &
     &,vabfl,qeinl,jiein,evkigr,eantbl                                  &
     &,agchl,aggmax,agksn,agksp,agremi                                  &
     &,vco2,algdrg,pbiogr,Q_PK,nbiogr,Q_NK,iph                          &
     &,akbcm,agbcm,aki,agr,cmatgr,cmatki,abbcm                          &
     &,antbl,abl,nbiobl,pbiobl,chlabl,extk                              &
     &,tpgr,uhrz,iwied,algcog,figaus,agmuea,fhegas                      &
     &,agreau,tauscs,ischif,ilbuhn,ieros                                &
     &,asgre,echla,ess,ss,zooind,GRote,Q_PG,Q_NG                        &
     &,vNH4z,vNO3z,gelPz,dalggz,nkzs,dH2D,dH2De,tempwz,cpfad            &
     &,itags,monats,mstr,up_PGz,up_NGz,Qmx_PG,Qmn_PG,upmxPG             &
     &,Qmx_NG,Qmn_NG,upmxNG,IKge,frmuge,alamda,agrtbr                   &
     &,agrbrz,akiz,agrz,ablz,chlaz,algagz,algzgz,Dz2D)                  
!                                                                       
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1513 
      if(ilbuhn.eq.0)then 
      do 1585 ior=1,anze+1 
      zwtemp(ior) = tempw(ior) 
      zwtief(ior) = tiefe(ior) 
      zwvm(ior) = vmitt(ior) 
      zwno3(ior) = vno3(ior) 
      zwnh4(ior) = vnh4(ior) 
      zwgelp(ior) = gelp(ior) 
      zwsvhg(ior) = svhemg(ior) 
      zwchla(ior) = chla(ior) 
      zwzooi(ior) = zooind(ior) 
      zwchlk(ior) = chlaki(ior) 
      zwchlg(ior) = chlagr(ior) 
      zwchlb(ior) = chlabl(ior) 
      zwir(ior) = ir(ior) 
      zwssa(ior) = ssalg(ior) 
      zwdalg(ior) = dalggr(ior) 
      zwdaag(ior) = dalgag(ior) 
      zwsedg(ior) = sedalg(ior) 
      zwzog(ior) = algzog(ior) 
      zwgmor(ior) = dgrmor(ior) 
      zwkigr(ior) = vkigr(ior) 
      zwantb(ior) = antbl(ior) 
      zwkbcm(ior) = akbcm(ior) 
      zwgbcm(ior) = agbcm(ior) 
      zwbbcm(ior) = abbcm(ior) 
      zwaki(ior) = aki(ior) 
      zwagr(ior) = agr(ior) 
      zwabl(ior) = abl(ior) 
      zwgmua(ior) = agmuea(ior) 
      zwfiga(ior) = figaus(ior) 
      zwfhga(ior) = fhegas(ior) 
      zwgrau(ior) = agreau(ior) 
      zwadrg(ior) = algdrg(ior) 
      zwacog(ior) = algcog(ior) 
      zwtpgr(ior) = tpgr(ior) 
      zwextk(ior) = extk(ior) 
      zup_PG(ior) = up_PGz(1,ior) 
      zup_NG(ior) = up_NGz(1,ior) 
      zQ_PG(ior) = Q_PG(ior) 
      zQ_NG(ior) = Q_NG(ior) 
      zagtbr(ior) = agrbrz(1,ior) 
      zwagz(ior) = dalggz(1,ior) 
      zwaagz(ior) = algagz(1,ior) 
      zwnkzs(ior) = nkzs(ior) 
      zwN4z(ior) = vNH4z(1,ior) 
      zwN3z(ior) = vNO3z(1,ior) 
      zwPz(ior) = gelPz(1,ior) 
!                                                                       
      tempw(ior) = btempw(mstr,ior) 
      tiefe(ior) = bh(mstr,ior) 
      vmitt(ior) = vbm(mstr,ior) 
      vno3(ior) = bno3(mstr,ior) 
      vnh4(ior) = bnh4(mstr,ior) 
      gelp(ior) = bgelp(mstr,ior) 
      svhemg(ior) = bsvheg(mstr,ior) 
      chla(ior) = bchla(mstr,ior) 
      zooind(ior) = bzooi(mstr,ior) 
      ir(ior) = bir(mstr,ior) 
      ssalg(ior) = bssalg(mstr,ior) 
      dalggr(ior) = bdagr(mstr,ior) 
      dalgag(ior) = bdaag(mstr,ior) 
      sedalg(ior) = bsedag(mstr,ior) 
      algzog(ior) = bazog(mstr,ior) 
      dgrmor(ior) = bdgmor(mstr,ior) 
      vkigr(ior) = bvkigr(mstr,ior) 
      antbl(ior) = bantbl(mstr,ior) 
      akbcm(ior) = bakbcm(mstr,ior) 
      agbcm(ior) = bagbcm(mstr,ior) 
      abbcm(ior) = babbcm(mstr,ior) 
      aki(ior) = baki(mstr,ior) 
      agr(ior) = bagr(mstr,ior) 
      abl(ior) = babl(mstr,ior) 
      algdrg(ior) = badrg(mstr,ior) 
      algcog(ior) = bacog(mstr,ior) 
      extk(ior) = bextk(mstr,ior) 
      Q_PG(ior) = bQ_PG(mstr,ior) 
      Q_NG(ior) = bQ_NG(mstr,ior) 
      vNH4z(1,ior) = bnh4(mstr,ior) 
      vNO3z(1,ior) = bno3(mstr,ior) 
      gelPz(1,ior) = bgelp(mstr,ior) 
!                                                                       
 1585 continue 
      ilbuhn = 1 
      goto 1414 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1586 ior=1,anze+1 
      bsvheg(mstr,ior) = svhemg(ior) 
      bchla(mstr,ior) = chla(ior) 
      bchlak(mstr,ior) = chlaki(ior) 
      bchlag(mstr,ior) = chlagr(ior) 
      bchlab(mstr,ior) = chlabl(ior) 
      bdagr(mstr,ior) = dalggr(ior) 
      bdaag(mstr,ior) = dalgag(ior) 
      bdgmor(mstr,ior) = dgrmor(ior) 
      bvkigr(mstr,ior) = vkigr(ior) 
      bantbl(mstr,ior) = antbl(ior) 
      bagbcm(mstr,ior) = agbcm(ior) 
      bagr(mstr,ior) = agr(ior) 
      bagmua(mstr,ior) = agmuea(ior) 
      bfigas(mstr,ior) = figaus(ior) 
      bfhgau(mstr,ior) = fhegas(ior) 
      bagrau(mstr,ior) = agreau(ior) 
      btpgr(mstr,ior) = tpgr(ior) 
      bextk(mstr,ior) = extk(ior) 
      bQ_PG(mstr,ior) = Q_PG(ior) 
      bQ_NG(mstr,ior) = Q_NG(ior) 
      bup_PG(mstr,ior) = up_PGz(1,ior) 
      bup_NG(mstr,ior) = up_NGz(1,ior) 
      bagtbr(mstr,ior) = agrbrz(1,ior) 
      balggz(mstr,ior) = dalggz(1,ior) 
      balagz(mstr,ior) = algagz(1,ior) 
!                                                                       
!                                                                       
      tempw(ior) = zwtemp(ior) 
      tiefe(ior) = zwtief(ior) 
      vmitt(ior) = zwvm(ior) 
      vno3(ior) = zwno3(ior) 
      vnh4(ior) = zwnh4(ior) 
      gelp(ior) = zwgelp(ior) 
      svhemg(ior) = zwsvhg(ior) 
      chla(ior) = zwchla(ior) 
      zooind(ior) = zwzooi(ior) 
      chlaki(ior) = zwchlk(ior) 
      chlagr(ior) = zwchlg(ior) 
      chlabl(ior) = zwchlb(ior) 
      ir(ior) = zwir(ior) 
      ssalg(ior) = zwssa(ior) 
      dalggr(ior) = zwdalg(ior) 
      dalgag(ior) = zwdaag(ior) 
      sedalg(ior) = zwsedg(ior) 
      algzog(ior) = zwzog(ior) 
      dgrmor(ior) = zwgmor(ior) 
      vkigr(ior) = zwkigr(ior) 
      antbl(ior) = zwantb(ior) 
      akbcm(ior) = zwkbcm(ior) 
      agbcm(ior) = zwgbcm(ior) 
      abbcm(ior) = zwbbcm(ior) 
      aki(ior) = zwaki(ior) 
      agr(ior) = zwagr(ior) 
      abl(ior) = zwabl(ior) 
      agmuea(ior) = zwgmua(ior) 
      figaus(ior) = zwfiga(ior) 
      fhegas(ior) = zwfhga(ior) 
      agreau(ior) = zwgrau(ior) 
      algdrg(ior) = zwadrg(ior) 
      algcog(ior) = zwacog(ior) 
      tpgr(ior) = zwtpgr(ior) 
      extk(ior) = zwextk(ior) 
      up_PGz(1,ior) = zup_PG(ior) 
      up_NGz(1,ior) = zup_NG(ior) 
      Q_PG(ior) = zQ_PG(ior) 
      Q_NG(ior) = zQ_NG(ior) 
      agrbrz(1,ior) = zagtbr(ior) 
!                                                                       
      nkzs(ior) = zwnkzs(ior) 
!                                                                       
      vNH4z(1,ior) = zwN4z(ior) 
      vNO3z(1,ior) = zwN3z(ior) 
      gelPz(1,ior) = zwPz(ior) 
!                                                                       
      dvheg1(ior) = bsvheg(mstr,ior)-svhemg(ior) 
      dkbcm1(ior) = bakbcm(mstr,ior)-akbcm(ior) 
      dgbcm1(ior) = bagbcm(mstr,ior)-agbcm(ior) 
      dbbcm1(ior) = babbcm(mstr,ior)-abbcm(ior) 
      dchlk1(ior) = bchlak(mstr,ior)-chlaki(ior) 
      dchlg1(ior) = bchlag(mstr,ior)-chlagr(ior) 
      dchlb1(ior) = bchlab(mstr,ior)-chlabl(ior) 
      dchla1(ior) = bchla(mstr,ior)-chla(ior) 
      daki1(ior) =  baki(mstr,ior)-aki(ior) 
      dagr1(ior) =  bagr(mstr,ior)-agr(ior) 
      dabl1(ior) =  babl(mstr,ior)-abl(ior) 
!                                                                       
      dvheg2(ior) = svhemg(ior)-bsvheg(mstr,ior) 
      dkbcm2(ior) = akbcm(ior)-bakbcm(mstr,ior) 
      dgbcm2(ior) = agbcm(ior)-bagbcm(mstr,ior) 
      dbbcm2(ior) = abbcm(ior)-babbcm(mstr,ior) 
      dchlk2(ior) = chlaki(ior)-bchlak(mstr,ior) 
      dchlg2(ior) = chlagr(ior)-bchlag(mstr,ior) 
      dchlb2(ior) = chlabl(ior)-bchlab(mstr,ior) 
      dchla2(ior) = chla(ior)-bchla(mstr,ior) 
      daki2(ior) =  aki(ior)-baki(mstr,ior) 
      dagr2(ior) =  agr(ior)-bagr(mstr,ior) 
      dabl2(ior) =  abl(ior)-babl(mstr,ior) 
!                                                                       
!                                                                       
      svhemg(ior) = svhemg(ior)+hctau1(ior)*dvheg1(ior) 
      akbcm(ior) = akbcm(ior)+hctau1(ior)*dkbcm1(ior) 
      agbcm(ior) = agbcm(ior)+hctau1(ior)*dgbcm1(ior) 
      abbcm(ior) = abbcm(ior)+hctau1(ior)*dbbcm1(ior) 
      chlaki(ior) = chlaki(ior)+hctau1(ior)*dchlk1(ior) 
      chlagr(ior) = chlagr(ior)+hctau1(ior)*dchlg1(ior) 
      chlabl(ior) = chlabl(ior)+hctau1(ior)*dchlb1(ior) 
      chla(ior) = chla(ior)+hctau1(ior)*dchla1(ior) 
      aki(ior) = aki(ior)+hctau1(ior)*daki1(ior) 
      agr(ior) = agr(ior)+hctau1(ior)*dagr1(ior) 
      abl(ior) = abl(ior)+hctau1(ior)*dabl1(ior) 
      if(svhemg(ior).lt.0.0)svhemg(ior) = 0.0 
      vkigr(ior) = chlaki(ior)/(Chlaki(ior)+chlagr(ior)+chlabl(ior)) 
      antbl(ior) = chlabl(ior)/(Chlaki(ior)+chlagr(ior)+chlabl(ior)) 
!                                                                       
      if(hctau2(ior).eq.0.0)goto 1586 
!                                                                       
      bsvheg(mstr,ior) = bsvheg(mstr,ior)+hctau2(ior)*dvheg2(ior) 
      bakbcm(mstr,ior) = bakbcm(mstr,ior)+hctau2(ior)*dkbcm2(ior) 
      bagbcm(mstr,ior) = bagbcm(mstr,ior)+hctau2(ior)*dgbcm2(ior) 
      babbcm(mstr,ior) = babbcm(mstr,ior)+hctau2(ior)*dbbcm2(ior) 
      bchlak(mstr,ior) = bchlak(mstr,ior)+hctau2(ior)*dchlk2(ior) 
      bchlag(mstr,ior) = bchlag(mstr,ior)+hctau2(ior)*dchlg2(ior) 
      bchlab(mstr,ior) = bchlab(mstr,ior)+hctau2(ior)*dchlb2(ior) 
      bchla(mstr,ior) = bchla(mstr,ior)+hctau2(ior)*dchla2(ior) 
      baki(mstr,ior) = baki(mstr,ior)+hctau2(ior)*daki2(ior) 
      bagr(mstr,ior) = bagr(mstr,ior)+hctau2(ior)*dagr2(ior) 
      babl(mstr,ior) = babl(mstr,ior)+hctau2(ior)*dabl2(ior) 
      if(bsvheg(mstr,ior).lt.0.0)bsvheg(mstr,ior) = 0.0 
      bvkigr(mstr,ior) = bchlak(mstr,ior)                               &
     &/(bChlak(mstr,ior)+bchlag(mstr,ior)+bchlab(mstr,ior))             
      bantbl(mstr,ior) = bchlab(mstr,ior)                               &
     &/(bChlak(mstr,ior)+bchlag(mstr,ior)+bchlab(mstr,ior))             
!                                                                       
 1586 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!**********benthische Algen**********************                       
!                                                                       
 1513 continue 
!                                                                       
      call albenth(SCHWI,TFLIE,TEMPW,TIEFE,VMITT,VNO3,VNH4,GELP         &
     &,albewg,alberg,elen,flae,ior,anze,aggmax,agksn,agksp              &
     &,si,akksn,akksp,akkssi,akgmax,albewk,alberk,abegm2,abekm2         &
     &,vabfl,cmatgr,cmatki,akchl,agchl,extk,ilang)                      
!                                                                       
!***********************Makrophythen*****************                   
!                                                                       
      call mphyt(tiefe,tempw,anze,po2p,po2r,pfldalg,tflie               &
     &,itags,monats,itstart,mstart,itmax,mmax,itend,mend,schwi          &
     &,pflmin,pflmax,pfl,sa,su,ilang,extk,mstr,ifehl,ifhStr)            
      if(ifehl.gt.0)goto 989 
!                                                                       
!*************orgC********************************                      
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1530 
!                                                                       
 1530 continue 
      if(vbsb(1).lt.0.0.and.vbsb(1).lt.0.0)goto 1514 
      call orgC(obsb,ocsb,TIEFE,RAU,TFLIE,VMITT,bl01,bl02               &
     &,zooind,abszo,tempw,vbsb,bsbt,flag,elen,ior,anze                  &
     &,ecsb,ebsb,qeinl,vabfl,sdbsb,zexki,zexgr,bsbbet,dkimor,dgrmor     &
     &,jiein,bsbgr,bsbki,akbcm,agbcm,pfl,ezind                          &
     &,abl,abbcm,bsbbl,csbbl,dblmor,zexbl,drfaeb                        &
     &,csbki,csbgr,ischif,echla,evkigr,eantbl                           &
     &,aki,agr,drfaek,drfaeg,drfaes,ssdr,orgCsd                         &
     &,CD,CP,CM,BAC,O2BSB,GRote,vcsb,vkigr,antbl                        &
     &,HNFBAC,BSBHNF,CHNF,eCHNF,fbsgr,frfgr,fbsgrs,frfgrs               &
     &,BACmua,dorgSS,ilbuhn,iwied,fkm,bsbct                             &
     &,pl0,Q_PK,Q_PB,Q_PG,pZoo,nl0,Q_NK,Q_NB,Q_NG,nzoo                  &
     &,bsbctP,bsbctN,hyPe,hymxDe,KsD1e,KsD2e,KsMe,upBACe                &
     &,YBACe,rsGBACe,nkzs,mstr,itags,monats,uhrz,itrein)                
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1514 
      if(ilbuhn.eq.0)then 
      do 1592 ior=1,anze+1 
      zwtemp(ior) = tempw(ior) 
      zwtief(ior) = tiefe(ior) 
      zwvm(ior) = vmitt(ior) 
      zwobsb(ior) = obsb(ior) 
      zwocsb(ior) = ocsb(ior) 
      zwvbsb(ior) = vbsb(ior) 
      zwvcsb(ior) = vcsb(ior) 
      zwbsbt(ior) = bsbt(ior) 
      zwbsct(ior) = bsbct(ior) 
      zwbsP(ior) = bsbctP(ior) 
      zwbsN(ior) = bsbctN(ior) 
      zwbl01(ior) = BL01(ior) 
      zwbl02(ior) = BL02(ior) 
      zwzooi(ior) = zooind(ior) 
      zwabsz(ior) = abszo(ior) 
      zwsbsb(ior) = sdbsb(ior) 
      zwzexk(ior) = zexki(ior) 
      zwzexg(ior) = zexgr(ior) 
      zwzexb(ior) = zexbl(ior) 
      zwbsbe(ior) = bsbbet(ior) 
      zwkmor(ior) = dkimor(ior) 
      zwgmor(ior) = dgrmor(ior) 
      zwbmor(ior) = dblmor(ior) 
      zwkbcm(ior) = akbcm(ior) 
      zwgbcm(ior) = agbcm(ior) 
      zwbbcm(ior) = abbcm(ior) 
      zwkigr(ior) = vkigr(ior) 
      zwantb(ior) = antbl(ior) 
      zwpfl(ior) = pfl(ior) 
      zwaki(ior) = aki(ior) 
      zwagr(ior) = agr(ior) 
      zwabl(ior) = abl(ior) 
      zwdfak(ior) = drfaek(ior) 
      zwdfag(ior) = drfaeg(ior) 
      zwdfab(ior) = drfaeb(ior) 
      zwdfas(ior) = drfaes(ior) 
      zwssdr(ior) = ssdr(ior) 
      zwCsed(ior) = orgCsd(ior) 
      zwcd(1,ior) = CD(1,ior) 
      zwcd(2,ior) = CD(2,ior) 
      zwcp(1,ior) = CP(1,ior) 
      zwcp(2,ior) = CP(2,ior) 
      zwcm(ior) = CM(ior) 
      zwBAC(ior) = BAC(ior) 
      zwo2bs(ior) = O2BSB(ior) 
      zwHNFB(ior) = HNFBAC(ior) 
      zwBSBH(ior) = BSBHNF(ior) 
      zwHNF(ior) = CHNF(ior) 
      zwfbgr(ior) = fbsgr(ior) 
      zwfrgr(ior) = frfgr(ior) 
      zworgS(ior) = dorgSS(ior) 
      zwnkzs(ior) = nkzs(ior) 
!                                                                       
!                                                                       
      tempw(ior) = btempw(mstr,ior) 
      tiefe(ior) = bh(mstr,ior) 
      vmitt(ior) = vbm(mstr,ior) 
      obsb(ior) = bbsb(mstr,ior) 
      ocsb(ior) = bcsb(mstr,ior) 
      vbsb(ior) = bvbsb(mstr,ior) 
      vcsb(ior) = bvcsb(mstr,ior) 
      zooind(ior) = bzooi(mstr,ior) 
      abszo(ior) = babszo(mstr,ior) 
      sdbsb(ior) = bsdbsb(mstr,ior) 
      zexki(ior) = bzexki(mstr,ior) 
      zexgr(ior) = bzexgr(mstr,ior) 
      zexbl(ior) = bzexbl(mstr,ior) 
      dkimor(ior) = bdkmor(mstr,ior) 
      dgrmor(ior) = bdgmor(mstr,ior) 
      dblmor(ior) = bdbmor(mstr,ior) 
      akbcm(ior) = bakbcm(mstr,ior) 
      agbcm(ior) = bagbcm(mstr,ior) 
      abbcm(ior) = babbcm(mstr,ior) 
      vkigr(ior) = bvkigr(mstr,ior) 
      antbl(ior) = bantbl(mstr,ior) 
      pfl(ior) = bpfl(mstr,ior) 
      aki(ior) = baki(mstr,ior) 
      agr(ior) = bagr(mstr,ior) 
      abl(ior) = babl(mstr,ior) 
      drfaek(ior) = bdfaek(mstr,ior) 
      drfaeg(ior) = bdfaeg(mstr,ior) 
      drfaeg(ior) = bdfaeb(mstr,ior) 
      drfaes(ior) = bdfaes(mstr,ior) 
      ssdr(ior) = bssdr(mstr,ior) 
      CD(1,ior) = bCD(mstr,1,ior) 
      CD(2,ior) = bCD(mstr,2,ior) 
      CP(1,ior) = bCP(mstr,1,ior) 
      CP(2,ior) = bCP(mstr,2,ior) 
      CM(ior) = bCM(mstr,ior) 
      BAC(ior) = bBAC(mstr,ior) 
      O2BSB(ior) = bO2BSB(mstr,ior) 
      HNFBAC(ior) = bHNFBS(mstr,ior) 
      BSBHNF(ior) = bBSBHN(mstr,ior) 
      CHNF(ior) = bCHNF(mstr,ior) 
      fbsgr(ior) = bfbsgr(mstr,ior) 
      frfgr(ior) = bfrfgr(mstr,ior) 
!                                                                       
!                                                                       
 1592 continue 
      ilbuhn = 1 
      goto 1530 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1593 ior=1,anze+1 
      bbsb(mstr,ior) = obsb(ior) 
      bcsb(mstr,ior) = ocsb(ior) 
      bvbsb(mstr,ior) = vbsb(ior) 
      bvcsb(mstr,ior) = vcsb(ior) 
      bbsbt(mstr,ior) = bsbt(ior) 
      bbsbct(mstr,ior) = bsbct(ior) 
      bbsbcP(mstr,ior) = bsbctP(ior) 
      bbsbcN(mstr,ior) = bsbctN(ior) 
      bbl01(mstr,ior) = BL01(ior) 
      bbl02(mstr,ior) = BL02(ior) 
      bsdbsb(mstr,ior) = sdbsb(ior) 
      bbsbbe(mstr,ior) = bsbbet(ior) 
      borgCs(mstr,ior) = orgCsd(ior) 
      bcd(mstr,1,ior) = CD(1,ior) 
      bcd(mstr,2,ior) = CD(2,ior) 
      bcp(mstr,1,ior) = CP(1,ior) 
      bcp(mstr,2,ior) = CP(2,ior) 
      bcm(mstr,ior) = CM(ior) 
      bBAC(mstr,ior) = BAC(ior) 
      bo2bsb(mstr,ior) = O2BSB(ior) 
      bHNFBS(mstr,ior) = HNFBAC(ior) 
      bBSBHN(mstr,ior) = BSBHNF(ior) 
      bCHNF(mstr,ior) = CHNF(ior) 
      bfbsgr(mstr,ior) = fbsgr(ior) 
      bfrfgr(mstr,ior) = frfgr(ior) 
      borgSS(mstr,ior) = dorgSS(ior) 
!                                                                       
      tempw(ior) = zwtemp(ior) 
      tiefe(ior) = zwtief(ior) 
      vmitt(ior) = zwvm(ior) 
      obsb(ior) = zwobsb(ior) 
      ocsb(ior) = zwocsb(ior) 
      vbsb(ior) = zwvbsb(ior) 
      vcsb(ior) = zwvcsb(ior) 
      bsbt(ior) = zwbsbt(ior) 
      bsbct(ior) = zwbsct(ior) 
      bsbctP(ior) = zwbsP(ior) 
      bsbctN(ior) = zwbsN(ior) 
      BL01(ior) = zwBL01(ior) 
      BL02(ior) = zwBL02(ior) 
      zooind(ior) = zwzooi(ior) 
      abszo(ior) = zwabsz(ior) 
      sdbsb(ior) = zwsbsb(ior) 
      zexki(ior) = zwzexk(ior) 
      zexgr(ior) = zwzexg(ior) 
      zexbl(ior) = zwzexb(ior) 
      bsbbet(ior) = zwbsbe(ior) 
      dkimor(ior) = zwkmor(ior) 
      dgrmor(ior) = zwgmor(ior) 
      dblmor(ior) = zwbmor(ior) 
      akbcm(ior) = zwkbcm(ior) 
      agbcm(ior) = zwgbcm(ior) 
      abbcm(ior) = zwbbcm(ior) 
      vkigr(ior) = zwkigr(ior) 
      antbl(ior) = zwantb(ior) 
      pfl(ior) = zwpfl(ior) 
      aki(ior) = zwaki(ior) 
      agr(ior) = zwagr(ior) 
      abl(ior) = zwabl(ior) 
      drfaek(ior) = zwdfak(ior) 
      drfaeg(ior) = zwdfag(ior) 
      drfaeb(ior) = zwdfab(ior) 
      drfaes(ior) = zwdfas(ior) 
      ssdr(ior) = zwssdr(ior) 
      orgCsd(ior) = zwCsed(ior) 
      CD(1,ior) = zwcd(1,ior) 
      CD(2,ior) = zwcd(2,ior) 
      CP(1,ior) = zwcp(1,ior) 
      CP(2,ior) = zwcp(2,ior) 
      CM(ior) = zwcm(ior) 
      BAC(ior) = zwBAC(ior) 
      O2BSB(ior) = zwo2bs(ior) 
      HNFBAC(ior) = zwHNFB(ior) 
      BSBHNF(ior) = zwBSBH(ior) 
      CHNF(ior) = zwHNF(ior) 
      fbsgr(ior) = zwfbgr(ior) 
      frfgr(ior) = zwfrgr(ior) 
      dorgSS(ior) = zworgS(ior) 
      nkzs(ior) = zwnkzs(ior) 
!                                                                       
      dobsb1(ior) = bbsb(mstr,ior)-obsb(ior) 
      docsb1(ior) = bcsb(mstr,ior)-ocsb(ior) 
      dvbsb1(ior) = bvbsb(mstr,ior)-vbsb(ior) 
      dvcsb1(ior) = bvcsb(mstr,ior)-vcsb(ior) 
      dBl011(ior) = bBL01(mstr,ior)-BL01(ior) 
      dBl021(ior) = bBL02(mstr,ior)-BL02(ior) 
      dcd11(ior) = bcd(mstr,1,ior)-CD(1,ior) 
      dcd21(ior) = bcd(mstr,2,ior)-CD(2,ior) 
      dcp11(ior) = bcp(mstr,1,ior)-CP(1,ior) 
      dcp21(ior) = bcp(mstr,2,ior)-CP(2,ior) 
      dcm1(ior) = bcm(mstr,ior)-CM(ior) 
      dBAC1(ior) = bBAC(mstr,ior)-BAC(ior) 
      do2BS1(ior) = bO2BSB(mstr,ior)-O2BSB(ior) 
      dfbgr1(ior) = bfbsgr(mstr,ior)-fbsgr(ior) 
      dfrgr1(ior) = bfrfgr(mstr,ior)-frfgr(ior) 
!                                                                       
      dobsb2(ior) = obsb(ior)-bbsb(mstr,ior) 
      docsb2(ior) = ocsb(ior)-bcsb(mstr,ior) 
      dvbsb2(ior) = vbsb(ior)-bvbsb(mstr,ior) 
      dvcsb2(ior) = vcsb(ior)-bvcsb(mstr,ior) 
      dBl012(ior) = BL01(ior)-bBL01(mstr,ior) 
      dBl022(ior) = BL02(ior)-bBL02(mstr,ior) 
      dcd12(ior) = CD(1,ior)-bcd(mstr,1,ior) 
      dcd22(ior) = CD(2,ior)-bcd(mstr,2,ior) 
      dcp12(ior) = CP(1,ior)-bcp(mstr,1,ior) 
      dcp22(ior) = CP(2,ior)-bcp(mstr,2,ior) 
      dcm2(ior) = CM(ior)-bcm(mstr,ior) 
      dBAC2(ior) = BAC(ior)-bBAC(mstr,ior) 
      do2BS2(ior) = O2BSB(ior)-bO2BSB(mstr,ior) 
      dfbgr2(ior) = fbsgr(ior)-bfbsgr(mstr,ior) 
      dfrgr2(ior) = frfgr(ior)-bfrfgr(mstr,ior) 
!                                                                       
      obsb(ior) = obsb(ior)+hctau1(ior)*dobsb1(ior) 
      ocsb(ior) = ocsb(ior)+hctau1(ior)*docsb1(ior) 
      vbsb(ior) = vbsb(ior)+hctau1(ior)*dvbsb1(ior) 
      vcsb(ior) = vcsb(ior)+hctau1(ior)*dvcsb1(ior) 
      BL01(ior) = BL01(ior)+hctau1(ior)*dBL011(ior) 
      BL02(ior) = BL02(ior)+hctau1(ior)*dBL021(ior) 
      CD(1,ior) = CD(1,ior)+hctau1(ior)*dcd11(ior) 
      CD(2,ior) = CD(2,ior)+hctau1(ior)*dcd21(ior) 
      CP(1,ior) = CP(1,ior)+hctau1(ior)*dcp11(ior) 
      CP(2,ior) = CP(2,ior)+hctau1(ior)*dcp21(ior) 
      CM(ior) = CM(ior)+hctau1(ior)*dcm1(ior) 
      BAC(ior) = BAC(ior)+hctau1(ior)*dBAC1(ior) 
      O2BSB(ior) = O2BSB(ior)+hctau1(ior)*do2BS1(ior) 
      fbsgr(ior) = fbsgr(ior)+hctau1(ior)*dfbgr1(ior) 
      frfgr(ior) = frfgr(ior)+hctau1(ior)*dfrgr1(ior) 
!                                                                       
      if(hctau2(ior).eq.0.0)goto 1593 
!                                                                       
      bbsb(mstr,ior) = bbsb(mstr,ior)+hctau2(ior)*dobsb2(ior) 
      bcsb(mstr,ior) = bcsb(mstr,ior)+hctau2(ior)*docsb2(ior) 
      bvbsb(mstr,ior) = bvbsb(mstr,ior)+hctau2(ior)*dvbsb2(ior) 
      bvcsb(mstr,ior) = bvcsb(mstr,ior)+hctau2(ior)*dvcsb2(ior) 
      bBL01(mstr,ior) = bBL01(mstr,ior)+hctau2(ior)*dBL012(ior) 
      bBL02(mstr,ior) = bBL02(mstr,ior)+hctau2(ior)*dBL022(ior) 
      bCD(mstr,1,ior) = bCD(mstr,1,ior)+hctau2(ior)*dcd12(ior) 
      bCD(mstr,2,ior) = bCD(mstr,2,ior)+hctau2(ior)*dcd22(ior) 
      bCP(mstr,1,ior) = bCP(mstr,1,ior)+hctau2(ior)*dcp12(ior) 
      bCP(mstr,2,ior) = bCP(mstr,2,ior)+hctau2(ior)*dcp22(ior) 
      bCM(mstr,ior) = bCM(mstr,ior)+hctau2(ior)*dcm2(ior) 
      bBAC(mstr,ior) = bBAC(mstr,ior)+hctau2(ior)*dBAC2(ior) 
      bO2BSB(mstr,ior) = bO2BSB(mstr,ior)+hctau2(ior)*do2BS2(ior) 
      bfbsgr(mstr,ior) = bfbsgr(mstr,ior)+hctau2(ior)*dfbgr2(ior) 
      bfrfgr(mstr,ior) = bfrfgr(mstr,ior)+hctau2(ior)*dfrgr2(ior) 
!                                                                       
 1593 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!                                                                       
!************Stickstoff****************                                 
!                                                                       
 1514 continue 
!                                                                       
      if(vnh4(1).lt.0.0)goto 1515 
      call ncyc(tempw,vx0,vnh4,tflie,rau,tiefe,vmitt,rhyd,vo2           &
     &,go2n,vno3,bsbt,flag,elen,ior,anze                                &
     &,enh4,eno3,ex0,qeinl,vabfl,pfl,sgo2n,sedx0,don                    &
     &,susn,bettn,susno,agrnh4,akinh4,dzres1,dzres2                     &
     &,agrno3,akino3,jiein,ischif                                       &
     &,ynmx1e,stks1e,anitrie,bnmx1e,bnks1e,vph,vno2,ij                  &
     &,albewg,alberg,albewk,alberk,resdr,aki,agr                        &
     &,exdrvk,exdrvg,vx02,ex02,eno2,ynmx2e,stks2e                       &
     &,abl,ablnh4,ablno3,exdrvb                                         &
     &,bnmx2e,bnks2e,nl0,zooind,GRote,nzoo,gesN,orgCsd                  &
     &,egesN,sedalk,sedalb,sedalg,ilbuhn,iwied,fkm                      &
     &,CD,CP,CM,BAC,bsbct,bsbctN,nkzs,vnh4z,vno2z,vno3z,dH2D            &
     &,hJNO3,hJNH4,susO2N,hFluN3                                        &
     &,Qmx_NK,Q_NK,up_NKz,Qmx_NG,Q_NG,up_NGz,Qmx_NB,Q_NB,up_NBz         &
     &,dalgkz,dalgbz,dalggz,agnh4z,aknh4z,abnh4z,agno3z,akno3z          &
     &,abno3z,vo2z,abltbr,akitbr,agrtbr,agrbrz,akibrz,ablbrz            &
     &,mstr,uhrz,itags,monats,enl0,algakz,algagz,algabz                 &
     &,up_N2z,iorLa,iorLe,ieinLs,flae,qeinlL,eNH4L                      &
     &,eNO2L,eNO3L,gesNL,itrein)                                        
!      write(*,*)mstr,mstr                                              
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1515 
      if(ilbuhn.eq.0)then 
      do 1587 ior=1,anze+1 
      zwtemp(ior) = tempw(ior) 
      zwtief(ior) = tiefe(ior) 
      zwvm(ior) = vmitt(ior) 
      zwno3(ior) = vno3(ior) 
      zwnh4(ior) = vnh4(ior) 
      zwno2(ior) = vno2(ior) 
      zwgesN(ior) = gesN(ior) 
      zwn4z(ior) = vnh4z(1,ior) 
      zwn2z(ior) = vno2z(1,ior) 
      zwn3z(ior) = vno3z(1,ior) 
      zwx0(ior) = vx0(ior) 
      zwx02(ior) = vx02(ior) 
      zwvo2(ior) = vo2(ior) 
      zwgo2n(ior) = go2n(ior) 
      zwbsbt(ior) = bsbt(ior) 
      zwbsct(ior) = bsbct(ior) 
      zwbsN(ior) = bsbctN(ior) 
      zwsedk(ior) = sedalk(ior) 
      zwsedg(ior) = sedalg(ior) 
      zwsedb(ior) = sedalb(ior) 
      zwpfl(ior) = pfl(ior) 
      zwsgon(ior) = sgo2n(ior) 
      zwsdx0(ior) = sedx0(ior) 
      zwdon(ior) = don(ior) 
      zwsusn(ior) = susn(ior) 
      zwbetn(ior) = bettn(ior) 
      zwsuso(ior) = susno(ior) 
      zwagn4(ior) = agrnh4(ior) 
      zwakn4(ior) = akinh4(ior) 
      zwabn4(ior) = ablnh4(ior) 
      zwagn3(ior) = agrno3(ior) 
      zwakn3(ior) = akino3(ior) 
      zwabn3(ior) = ablno3(ior) 
      zwdzr1(ior) = dzres1(ior) 
      zwdzr2(ior) = dzres2(ior) 
      zwph(ior) = vph(ior) 
      zwabwg(ior) = albewg(ior) 
      zwabrg(ior) = alberg(ior) 
      zwabwk(ior) = albewk(ior) 
      zwabrk(ior) = alberk(ior) 
      zwsedn(ior) = sedn(ior) 
      zwrdr(ior) = resdr(ior) 
      zwaki(ior) = aki(ior) 
      zwagr(ior) = agr(ior) 
      zwabl(ior) = abl(ior) 
      zwexdk(ior) = exdrvk(ior) 
      zwexdg(ior) = exdrvg(ior) 
      zwexdb(ior) = exdrvb(ior) 
      zwnl0(ior) = nl0(ior) 
      zwCsed(ior) = orgCsd(ior) 
      zup_NK(ior) = up_NKz(1,ior) 
      zup_NG(ior) = up_NGz(1,ior) 
      zup_NB(ior) = up_NBz(1,ior) 
      zQ_NK(ior) = Q_NK(ior) 
      zQ_NG(ior) = Q_NG(ior) 
      zQ_NB(ior) = Q_NB(ior) 
      zwJNO3(ior) = hJNO3(mstr,ior) 
      zwJNH4(ior) = hJNH4(mstr,ior) 
      zwFlN3(ior) = hFluN3(mstr,ior) 
      zaktbr(ior) = akibrz(1,ior) 
      zagtbr(ior) = agrbrz(1,ior) 
      zabtbr(ior) = ablbrz(1,ior) 
      zwakz(ior) = dalgkz(1,ior) 
      zwaakz(ior) = algakz(1,ior) 
      zwagz(ior) = dalggz(1,ior) 
      zwaagz(ior) = algagz(1,ior) 
      zwabz(ior) = dalgbz(1,ior) 
      zwaabz(ior) = algabz(1,ior) 
!                                                                       
      zwkN4z(ior) = akNH4z(1,ior) 
      zwkN3z(ior) = akNO3z(1,ior) 
      zwgN4z(ior) = agNH4z(1,ior) 
      zwgN3z(ior) = agNO3z(1,ior) 
      zwbN4z(ior) = abNH4z(1,ior) 
      zwbN3z(ior) = abNO3z(1,ior) 
!                                                                       
      zwnkzs(ior) = nkzs(ior) 
!                                                                       
      tempw(ior) = btempw(mstr,ior) 
      tiefe(ior) = bh(mstr,ior) 
      vmitt(ior) = vbm(mstr,ior) 
      vno3(ior) = bno3(mstr,ior) 
      vnh4(ior) = bnh4(mstr,ior) 
      vno2(ior) = bno2(mstr,ior) 
      gesN(ior) = bgesN(mstr,ior) 
      vnh4z(1,ior) = bnh4(mstr,ior) 
      vno2z(1,ior) = bno2(mstr,ior) 
      vno3z(1,ior) = bno3(mstr,ior) 
      vx0(ior) = bx0(mstr,ior) 
      vx02(ior) = bx02(mstr,ior) 
      vo2(ior) = bo2(mstr,ior) 
      bsbt(ior) = bbsbt(mstr,ior) 
      bsbct(ior) = bbsbct(mstr,ior) 
      bsbctN(ior) = bbsbcN(mstr,ior) 
      sedalk(ior) = bsedak(mstr,ior) 
      sedalg(ior) = bsedag(mstr,ior) 
      sedalb(ior) = bsedab(mstr,ior) 
!      pfl(ior) = bpfl(mstr,ior)                                        
      dzres1(ior) = bzres1(mstr,ior) 
      dzres2(ior) = bzres2(mstr,ior) 
      vph(ior) = bph(mstr,ior) 
      albewg(ior) = babewg(mstr,ior) 
      albewk(ior) = babewk(mstr,ior) 
      alberg(ior) = baberg(mstr,ior) 
      alberk(ior) = baberk(mstr,ior) 
      resdr(ior) = bresdr(mstr,ior) 
      aki(ior) = baki(mstr,ior) 
      agr(ior) = bagr(mstr,ior) 
      abl(ior) = babl(mstr,ior) 
      exdrvk(ior) = bexdvk(mstr,ior) 
      exdrvg(ior) = bexdvg(mstr,ior) 
      exdrvb(ior) = bexdvb(mstr,ior) 
      nl0(ior) = bnl0(mstr,ior) 
      orgCsd(ior) = borgCs(mstr,ior) 
      up_NKz(1,ior) = bup_NK(mstr,ior) 
      up_NGz(1,ior) = bup_NG(mstr,ior) 
      up_NBz(1,ior) = bup_NB(mstr,ior) 
      Q_NK(ior) = bQ_NK(mstr,ior) 
      Q_NG(ior) = bQ_NG(mstr,ior) 
      Q_NB(ior) = bQ_NB(mstr,ior) 
      hJNO3(mstr,ior) = bJNO3(mstr,ior) 
      hJNH4(mstr,ior) = bJNH4(mstr,ior) 
      akibrz(1,ior) = baktbr(mstr,ior) 
      agrbrz(1,ior) = bagtbr(mstr,ior) 
      ablbrz(1,ior) = babtbr(mstr,ior) 
      dalgkz(1,ior) = balgkz(mstr,ior) 
      algakz(1,ior) = balakz(mstr,ior) 
      dalggz(1,ior) = balggz(mstr,ior) 
      algagz(1,ior) = balagz(mstr,ior) 
      dalgbz(1,ior) = balgbz(mstr,ior) 
      algabz(1,ior) = balabz(mstr,ior) 
!                                                                       
 1587 continue 
      ilbuhn = 1 
      goto 1514 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1589 ior=1,anze+1 
      bno3(mstr,ior) = vno3(ior) 
      bnh4(mstr,ior) = vnh4(ior) 
      bno2(mstr,ior)  = vno2(ior) 
      bgesN(mstr,ior) = gesN(ior) 
      bx0(mstr,ior) = vx0(ior) 
      bx02(mstr,ior) = vx02(ior) 
      bsgon(mstr,ior) = sgo2n(ior) 
      bgo2n(mstr,ior) = go2n(ior) 
      bsedx0(mstr,ior) = sedx0(ior) 
      bdon(mstr,ior) = don(ior) 
      bsusn(mstr,ior) = susn(ior) 
      bbettn(mstr,ior) = bettn(ior) 
      bsuso(mstr,ior) = susno(ior) 
      bagn4(mstr,ior) = agrnh4(ior) 
      bakn4(mstr,ior) = akinh4(ior) 
      babn4(mstr,ior) = ablnh4(ior) 
      bagn3(mstr,ior) = agrno3(ior) 
      bakn3(mstr,ior) = akino3(ior) 
      babn3(mstr,ior) = ablno3(ior) 
      bsedn(mstr,ior) = sedn(ior) 
      bnl0(mstr,ior) = nl0(ior) 
      bup_NK(mstr,ior) = up_NKz(1,ior) 
      bup_NG(mstr,ior) = up_NGz(1,ior) 
      bQ_NK(mstr,ior) = Q_NK(ior) 
      bQ_NG(mstr,ior) = Q_NG(ior) 
      bFluN3(mstr,ior) = hFluN3(mstr,ior) 
      baktbr(mstr,ior) = akibrz(1,ior) 
      bagtbr(mstr,ior) = agrbrz(1,ior) 
      balgkz(mstr,ior) = dalgkz(1,ior) 
      balakz(mstr,ior) = algakz(1,ior) 
      balggz(mstr,ior) = dalggz(1,ior) 
      balagz(mstr,ior) = algagz(1,ior) 
      bkN4z(mstr,ior) = akNH4z(1,ior) 
      bkN3z(mstr,ior) = akNO3z(1,ior) 
      bgN4z(mstr,ior) = agNH4z(1,ior) 
      bgN3z(mstr,ior) = agNO3z(1,ior) 
      bbN4z(mstr,ior) = abNH4z(1,ior) 
      bbN3z(mstr,ior) = abNO3z(1,ior) 
!                                                                       
!                                                                       
      tempw(ior) = zwtemp(ior) 
      tiefe(ior) = zwtief(ior) 
      vmitt(ior) = zwvm(ior) 
      vno3(ior) = zwno3(ior) 
      vnh4(ior) = zwnh4(ior) 
      vno2(ior) = zwno2(ior) 
      gesN(ior) = zwgesN(ior) 
      nkzs(ior) = zwnkzs(ior) 
!                                                                       
      vnh4z(1,ior) = zwn4z(ior) 
      vno2z(1,ior) = zwn2z(ior) 
      vno3z(1,ior) = zwn3z(ior) 
!                                                                       
      vx0(ior) = zwx0(ior) 
      vx02(ior) = zwx02(ior) 
      vo2(ior) = zwvo2(ior) 
      go2n(ior) = zwgo2n(ior) 
      bsbt(ior) = zwbsbt(ior) 
      bsbct(ior) = zwbsct(ior) 
      bsbctN(ior) = zwbsN(ior) 
      sedalk(ior) = zwsedk(ior) 
      sedalg(ior) = zwsedg(ior) 
      sedalb(ior) = zwsedb(ior) 
      pfl(ior) = zwpfl(ior) 
      sgo2n(ior) = zwsgon(ior) 
      sedx0(ior) = zwsdx0(ior) 
      don(ior) = zwdon(ior) 
      susn(ior) = zwsusn(ior) 
      bettn(ior) = zwbetn(ior) 
      susno(ior) = zwsuso(ior) 
      agrnh4(ior) = zwagn4(ior) 
      akinh4(ior) = zwakn4(ior) 
      ablnh4(ior) = zwabn4(ior) 
      agrno3(ior) = zwagn3(ior) 
      akino3(ior) = zwakn3(ior) 
      ablno3(ior) = zwabn3(ior) 
      dzres1(ior) = zwdzr1(ior) 
      dzres2(ior) = zwdzr2(ior) 
      vph(ior) = zwph(ior) 
      albewg(ior) = zwabwg(ior) 
      alberg(ior) = zwabrg(ior) 
      albewk(ior) = zwabwk(ior) 
      alberk(ior) = zwabrk(ior) 
      sedn(ior) = zwsedn(ior) 
      resdr(ior) = zwrdr(ior) 
      aki(ior) = zwaki(ior) 
      agr(ior) = zwagr(ior) 
      abl(ior) = zwabl(ior) 
      exdrvk(ior) = zwexdk(ior) 
      exdrvg(ior) = zwexdg(ior) 
      exdrvb(ior) = zwexdb(ior) 
      nl0(ior) = zwnl0(ior) 
      orgCsd(ior) = zwCsed(ior) 
      up_NKz(1,ior) = zup_NK(ior) 
      up_NGz(1,ior) = zup_NG(ior) 
      up_NBz(1,ior) = zup_NB(ior) 
      Q_NK(ior) = zQ_NK(ior) 
      Q_NG(ior) = zQ_NG(ior) 
      Q_NB(ior) = zQ_NB(ior) 
      hJNO3(mstr,ior) = zwJNO3(ior) 
      hJNH4(mstr,ior) = zwJNH4(ior) 
      hFluN3(mstr,ior) = zwFlN3(ior) 
      akibrz(1,ior) = zaktbr(ior) 
      agrbrz(1,ior) = zagtbr(ior) 
      ablbrz(1,ior) = zabtbr(ior) 
      dalgkz(1,ior) = zwakz(ior) 
      algakz(1,ior) = zwaakz(ior) 
      dalggz(1,ior) = zwagz(ior) 
      algagz(1,ior) = zwaagz(ior) 
      dalgbz(1,ior) = zwabz(ior) 
      algabz(1,ior) = zwaabz(ior) 
!                                                                       
      vNh4z(1,ior) = zwN4z(ior) 
      vNo2z(1,ior) = zwN2z(ior) 
      vNO3z(1,ior) = zwN3z(ior) 
      akNH4z(1,ior) = zwkN4z(ior) 
      akNO3z(1,ior) = zwkN3z(ior) 
      agNH4z(1,ior) = zwgN4z(ior) 
      agNO3z(1,ior) = zwgN3z(ior) 
      abNH4z(1,ior) = zwbN4z(ior) 
      abNO3z(1,ior) = zwbN3z(ior) 
!                                                                       
!                                                                       
      dvx01(ior) = bx0(mstr,ior)-vx0(ior) 
      dvx021(ior) = bx02(mstr,ior)-vx02(ior) 
      dvnh41(ior) = bnh4(mstr,ior)-vnh4(ior) 
      dvno21(ior) = bno2(mstr,ior)-vno2(ior) 
      dvno31(ior) = bno3(mstr,ior)-vno3(ior) 
      dnl01(ior) = bnl0(mstr,ior)-nl0(ior) 
      dgesN1(ior) = bgesN(mstr,ior)-gesN(ior) 
      dQ_NK1(ior) = bQ_NK(mstr,ior)-Q_NK(ior) 
      dQ_NG1(ior) = bQ_NG(mstr,ior)-Q_NG(ior) 
      dQ_NB1(ior) = bQ_NB(mstr,ior)-Q_NB(ior) 
      dFlN31(ior) = bFluN3(mstr,ior)-hFluN3(mstr,ior) 
!                                                                       
      dvx02(ior) = vx0(ior)-bx0(mstr,ior) 
      dvx022(ior) = vx02(ior)-bx02(mstr,ior) 
      dvnh42(ior) = vnh4(ior)-bnh4(mstr,ior) 
      dvno22(ior) = vno2(ior)-bno2(mstr,ior) 
      dvno32(ior) = vno3(ior)-bno3(mstr,ior) 
      dnl02(ior) = nl0(ior)-bnl0(mstr,ior) 
      dgesN2(ior) = gesN(ior)-bgesN(mstr,ior) 
      dQ_NK2(ior) = Q_NK(ior)-bQ_NK(mstr,ior) 
      dQ_NG2(ior) = Q_NG(ior)-bQ_NG(mstr,ior) 
      dQ_NB2(ior) = Q_NB(ior)-bQ_NB(mstr,ior) 
      dFlN32(ior) = hFluN3(mstr,ior)-bFluN3(mstr,ior) 
!                                                                       
!                                                                       
      vx0(ior) = vx0(ior)+hctau1(ior)*dvx01(ior) 
      vx02(ior) = vx02(ior)+hctau1(ior)*dvx021(ior) 
      vnh4(ior) = vnh4(ior)+hctau1(ior)*dvnh41(ior) 
      vno2(ior) = vno2(ior)+hctau1(ior)*dvno21(ior) 
      vno3(ior) = vno3(ior)+hctau1(ior)*dvno31(ior) 
      nl0(ior) = nl0(ior)+hctau1(ior)*dnl01(ior) 
      gesN(ior) = gesN(ior)+hctau1(ior)*dgesN1(ior) 
      Q_NK(ior) = Q_NK(ior)+hctau1(ior)*dQ_NK1(ior) 
      Q_NG(ior) = Q_NG(ior)+hctau1(ior)*dQ_NG1(ior) 
      Q_NB(ior) = Q_NB(ior)+hctau1(ior)*dQ_NB1(ior) 
      hFluN3(mstr,ior) = hFluN3(mstr,ior)+hctau1(ior)*dFlN31(ior) 
!                                                                       
      if(hctau2(ior).eq.0.0)goto 1589 
!                                                                       
      bx0(mstr,ior) = bx0(mstr,ior)+hctau2(ior)*dvx02(ior) 
      bx02(mstr,ior) = bx02(mstr,ior)+hctau2(ior)*dvx022(ior) 
      bnh4(mstr,ior) = bnh4(mstr,ior)+hctau2(ior)*dvnh42(ior) 
      bno2(mstr,ior) = bno2(mstr,ior)+hctau2(ior)*dvno22(ior) 
      bno3(mstr,ior) = bno3(mstr,ior)+hctau2(ior)*dvno32(ior) 
      bnl0(mstr,ior) = bnl0(mstr,ior)+hctau2(ior)*dnl02(ior) 
      bgesN(mstr,ior) = bgesN(mstr,ior)+hctau2(ior)*dgesN2(ior) 
      bQ_NK(mstr,ior) = bQ_NK(mstr,ior)+hctau2(ior)*dQ_NK2(ior) 
      bQ_NG(mstr,ior) = bQ_NG(mstr,ior)+hctau2(ior)*dQ_NG2(ior) 
      bQ_NB(mstr,ior) = bQ_NB(mstr,ior)+hctau2(ior)*dQ_NB2(ior) 
      bFluN3(mstr,ior) = bFluN3(mstr,ior)+hctau2(ior)*dFlN32(ior) 
!                                                                       
 1589 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!                                                                       
!*****************pH-Wert***********************                        
!                                                                       
 1515 continue 
      if(iph.eq.0)goto 113 
      if(vph(1).lt.0.0)goto 113 
!                                                                       
      call ph(mw,pw,ca,lf,tempw,tflie,susn,bsbt,dalgki                  &
     &,dalggr,dalgak,dalgag,po2p,po2r,rau,vmitt,tiefe,flae,vabfl        &
     &,flag,elen,ior,anze,vph                                           &
     &,ssalg,stind,albewg,alberg,albewk,alberk,wge                      &
     &,abl,dalgbl,dalgab,IDWe,iwied,fkm,ij,resdr                        &
     &,dzres1,dzres2,aki,agr,ilbuhn,eph,emw,elf,eca,vco2,qeinl          &
     &,jiein,mstr,cpfad,itags,monats,uhrz,itrein)                       
!      write(*,*)mstr,mstr,mstr,mstr                                    
!                                                                       
      if(nbuhn(mstr).eq.0)goto 412 
      if(ilbuhn.eq.0)then 
      do 1605 ior=1,anze+1 
      zwtemp(ior) = tempw(ior) 
      zwtief(ior) = tiefe(ior) 
      zwvm(ior) = vmitt(ior) 
      zwmw(ior) = mw(ior) 
      zwpw(ior) = pw(ior) 
      zwca(ior) = ca(ior) 
      zwlf(ior) = lf(ior) 
      zwph(ior) = vph(ior) 
      zwsusn(ior) = susn(ior) 
      zwbetn(ior) = bettn(ior) 
      zwbsbt(ior) = bsbt(ior) 
      zwdalk(ior) = dalgki(ior) 
      zwdalg(ior) = dalggr(ior) 
      zwdalb(ior) = dalgbl(ior) 
      zwdaak(ior) = dalgak(ior) 
      zwdaag(ior) = dalgag(ior) 
      zwdaab(ior) = dalgab(ior) 
      zwpo2p(ior) = po2p(ior) 
      zwpo2r(ior) = po2r(ior) 
      zwssa(ior) = ssalg(ior) 
      zwstin(ior) = stind(ior) 
      zwabwg(ior) = albewg(ior) 
      zwabrg(ior) = alberg(ior) 
      zwabwk(ior) = albewk(ior) 
      zwabrk(ior) = alberk(ior) 
      zwrdr(ior) = resdr(ior) 
      zwaki(ior) = aki(ior) 
      zwagr(ior) = agr(ior) 
      zwabl(ior) = abl(ior) 
      zwdzr1(ior) = dzres1(ior) 
      zwdzr2(ior) = dzres2(ior) 
!                                                                       
      tempw(ior) = btempw(mstr,ior) 
      tiefe(ior) = bh(mstr,ior) 
      vmitt(ior) = vbm(mstr,ior) 
      mw(ior) = bmw(mstr,ior) 
      pw(ior) = bpw(mstr,ior) 
      ca(ior) = bca(mstr,ior) 
      lf(ior) = blf(mstr,ior) 
      vph(ior) = bph(mstr,ior) 
      susn(ior) = bsusn(mstr,ior) 
      bettn(ior) = bbettn(mstr,ior) 
      bsbt(ior) = bbsbt(mstr,ior) 
      dalgki(ior) = bdaki(mstr,ior) 
      dalggr(ior) = bdagr(mstr,ior) 
      dalgbl(ior) = bdabl(mstr,ior) 
      dalgak(ior) = bdaak(mstr,ior) 
      dalgag(ior) = bdaag(mstr,ior) 
      dalgab(ior) = bdaab(mstr,ior) 
      po2p(ior) = bpo2p(mstr,ior) 
      po2r(ior) = bpo2r(mstr,ior) 
      stind(ior) = bstind(mstr,ior) 
      ssalg(ior) = bssalg(mstr,ior) 
      albewg(ior) = babewg(mstr,ior) 
      albewk(ior) = babewk(mstr,ior) 
      alberg(ior) = baberg(mstr,ior) 
      alberk(ior) = baberk(mstr,ior) 
      resdr(ior) = bresdr(mstr,ior) 
      dzres1(ior) = bzres1(mstr,ior) 
      dzres2(ior) = bzres2(mstr,ior) 
      resdr(ior) = bresdr(mstr,ior) 
      aki(ior) = baki(mstr,ior) 
      agr(ior) = bagr(mstr,ior) 
      abl(ior) = babl(mstr,ior) 
 1605 continue 
      ilbuhn = 1 
      goto 1515 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1606 ior=1,anze+1 
      bmw(mstr,ior) = mw(ior) 
      bpw(mstr,ior) = pw(ior) 
      bca(mstr,ior) = ca(ior) 
      blf(mstr,ior) = lf(ior) 
      bph(mstr,ior) = vph(ior) 
      bstind(mstr,ior) = stind(ior) 
!                                                                       
      tempw(ior) = zwtemp(ior) 
      tiefe(ior) = zwtief(ior) 
      vmitt(ior) = zwvm(ior) 
      mw(ior) = zwmw(ior) 
      pw(ior) = zwpw(ior) 
      ca(ior) = zwca(ior) 
      lf(ior) = zwlf(ior) 
      vph(ior) = zwph(ior) 
      susn(ior) = zwsusn(ior) 
      bettn(ior) = zwbetn(ior) 
      bsbt(ior) = zwbsbt(ior) 
      dalgki(ior) = zwdalk(ior) 
      dalggr(ior) = zwdalg(ior) 
      dalgbl(ior) = zwdalb(ior) 
      dalgak(ior) = zwdaak(ior) 
      dalgag(ior) = zwdaag(ior) 
      dalgab(ior) = zwdaab(ior) 
      po2p(ior) = zwpo2p(ior) 
      po2r(ior) = zwpo2r(ior) 
      ssalg(ior) = zwssa(ior) 
      stind(ior) = zwstin(ior) 
      albewg(ior) = zwabwg(ior) 
      alberg(ior) = zwabrg(ior) 
      albewk(ior) = zwabwk(ior) 
      alberk(ior) = zwabrk(ior) 
      resdr(ior) = zwrdr(ior) 
      aki(ior) = zwaki(ior) 
      agr(ior) = zwagr(ior) 
      abl(ior) = zwabl(ior) 
      dzres1(ior) = zwdzr1(ior) 
      dzres2(ior) = zwdzr2(ior) 
!                                                                       
      dmw1(ior) = bmw(mstr,ior)-mw(ior) 
      dpw1(ior) = bpw(mstr,ior)-pw(ior) 
      dca1(ior) = bca(mstr,ior)-ca(ior) 
      dlf1(ior) = blf(mstr,ior)-lf(ior) 
      dvph1(ior) = bph(mstr,ior)-vph(ior) 
      dstin1(ior) = bstind(mstr,ior)-stind(ior) 
!                                                                       
      dmw2(ior) = mw(ior)-bmw(mstr,ior) 
      dpw2(ior) = pw(ior)-bpw(mstr,ior) 
      dca2(ior) = ca(ior)-bca(mstr,ior) 
      dlf2(ior) = lf(ior)-blf(mstr,ior) 
      dvph2(ior) = vph(ior)-bph(mstr,ior) 
      dstin2(ior) = stind(ior)-bstind(mstr,ior) 
!                                                                       
      mw(ior) = mw(ior)+hctau1(ior)*dmw1(ior) 
      pw(ior) = pw(ior)+hctau1(ior)*dpw1(ior) 
      ca(ior) = ca(ior)+hctau1(ior)*dca1(ior) 
      lf(ior) = lf(ior)+hctau1(ior)*dlf1(ior) 
      vph(ior) = vph(ior)+hctau1(ior)*dvph1(ior) 
      stind(ior) = stind(ior)+hctau1(ior)*dstin1(ior) 
!                                                                       
      if(hctau2(ior).eq.0.0)goto 1606 
!                                                                       
      bmw(mstr,ior) = bmw(mstr,ior)+hctau2(ior)*dmw2(ior) 
      bpw(mstr,ior) = bpw(mstr,ior)+hctau2(ior)*dpw2(ior) 
      bca(mstr,ior) = bca(mstr,ior)+hctau2(ior)*dca2(ior) 
      blf(mstr,ior) = blf(mstr,ior)+hctau2(ior)*dlf2(ior) 
      bph(mstr,ior) = bph(mstr,ior)+hctau2(ior)*dvph2(ior) 
      bstind(mstr,ior) = bstind(mstr,ior)+hctau2(ior)*dstin2(ior) 
!                                                                       
 1606 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!                                                                       
!****************Temperatur*******************                          
!                                                                       
  113 if(nbuhn(mstr).eq.0)goto 412 
!                                                                       
  412 continue 
!                                                                       
      if(iwsim.lt.4)goto 408 
      call CTracer(TEMPW,vmitt,flag,elen,anze,etemp,qeinl,vabfl         &
     &,dl,STRdt,jiein,uhrz,ilbuhn,mstr,STRiz,htempw,nkzs,iMAC,fkm,iwied &
     &,itrein)                                                          
      if(iwsim.eq.4)goto 409 
!                                                                       
  408 continue 
      call temperw(RO,TEMPL,TEMPW,SCHWI,WGE,TIEFE,TFLIE                 &
     &,vmitt,flag,elen,ior,anze,etemp,ewaerm,typ,qeinl,vabfl            &
     &,jiein,cloud,typw,iwied,uhrz,ilbuhn,nwaerm,fkm,nkzs               &
     &,tempwz,dH2D,iorLa,iorLe,ieinLs,flae,qeinlL,etempL                &
     &,mstr,IDWe,ilang,dtemp,FluxT1,extk,itags,monats,Tsed              &
     &,Wlage,hWS,iRHKW,itrein,htempw,htempz)                            
!      write(*,*)mstr,mstr                                              
!                                                                       
!...dtemp zwischenspeichern bei Buhnen                                  
  409 if(nbuhn(mstr).eq.0)goto 413 
      if(ilbuhn.eq.0)then 
      do 581 ior=1,anze+1 
      zwtemp(ior) = tempw(ior) 
      zwTsed(ior) = Tsed(ior) 
      zwextk(ior) = extk(ior) 
      do 1579 nkz = 1,nkzs(ior) 
 1579 zwtez(nkz,ior) = tempwz(nkz,ior) 
      zwnkzs(ior) = nkzs(ior) 
      zwtief(ior) = tiefe(ior) 
!                                                                       
      tempw(ior) = btempw(mstr,ior) 
      Tsed(ior) = bTsed(mstr,ior) 
      tempwz(1,ior) = btempw(mstr,ior) 
      tiefe(ior) = bh(mstr,ior) 
      extk(ior) = bextk(mstr,ior) 
  581 continue 
      ilbuhn = 1 
      goto 412 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 582 ior=1,anze+1 
      btempw(mstr,ior) = tempw(ior) 
      bTsed(mstr,ior) = Tsed(ior) 
      tempw(ior) = zwtemp(ior) 
      Tsed(ior) = zwTsed(ior) 
      nkzs(ior) = zwnkzs(ior) 
      extk(ior) = zwextk(ior) 
      do 1583 nkz = 1,nkzs(ior) 
 1583 tempwz(nkz,ior) = zwtez(nkz,ior) 
      tiefe(ior) = zwtief(ior) 
!                                                                       
      dift1(ior) = btempw(mstr,ior)-tempw(ior) 
      dift2(ior) = tempw(ior)-btempw(mstr,ior) 
!                                                                       
      tempw(ior) = tempw(ior)+hctau1(ior)*dift1(ior) 
!                                                                       
      do 1702 nkz = 1,nkzs(ior) 
 1702 tempwz(nkz,ior) = tempwz(nkz,ior)+hctau1(ior)*dift1(ior) 
!                                                                       
      if(hctau2(ior).eq.0.0)goto 582 
!                                                                       
      btempw(mstr,ior) = btempw(mstr,ior)+hctau2(ior)*dift2(ior) 
!                                                                       
  582 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!                                                                       
!************ortho-Phosphat**********                                   
!                                                                       
  413 continue 
      if(iwsim.eq.4.or.iwsim.eq.2)goto 118 
      if(gelP(1).lt.0.0)goto 1516 
      call po4s(gelp,flag,elen,ior,tiefe                                &
     &,dalggr,dalgki,dalgag,dalgak                                      &
     &,ep,qeinl,vabfl,anze,tflie,dzres1,dzres2                          &
     &,jiein,sedalk,sedalb,sedalg                                       &
     &,albewg,alberg,albewk,alberk,resdr,aki,agr,exdrvk,exdrvg,pl0      &
     &,abl,dalgbl,dalgab,exdrvb,gesP,orgCsd                             &
     &,zooind,GRote,pZoo,bl01,bl02,egesP,ilbuhn,iwied                   &
     &,CD,CP,CM,BAC,bsbctP,Qmx_PK,Q_PK,up_PKz                           &
     &,Qmx_PG,Q_PG,up_PGz,Qmx_PB,Q_PB,up_PBz,epl0                       &
     &,gelpz,dalggz,dalgkz,dalgbz,agrtbr,akitbr,abltbr,agrbrz           &
     &,akibrz,ablbrz,algakz,algagz,algabz,hJPO4,nkzs,dH2D               &
     &,dH2De,mstr,iorLa,iorLe,ieinLs,flae,qeinlL,gPL,gesPL,itrein)      
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1516 
      if(ilbuhn.eq.0)then 
      do 1590 ior=1,anze+1 
      zwtief(ior) = tiefe(ior) 
      zwgelp(ior) = gelp(ior) 
      zwgesP(ior) = gesP(ior) 
      zwbsP(ior) = bsbctP(ior) 
      zwsedk(ior) = sedalk(ior) 
      zwsedg(ior) = sedalg(ior) 
      zwsedb(ior) = sedalb(ior) 
      zwdzr1(ior) = dzres1(ior) 
      zwdzr2(ior) = dzres2(ior) 
      zwabwg(ior) = albewg(ior) 
      zwabrg(ior) = alberg(ior) 
      zwabwk(ior) = albewk(ior) 
      zwabrk(ior) = alberk(ior) 
      zwrdr(ior) = resdr(ior) 
      zwaki(ior) = aki(ior) 
      zwagr(ior) = agr(ior) 
      zwabl(ior) = abl(ior) 
      zwexdk(ior) = exdrvk(ior) 
      zwexdg(ior) = exdrvg(ior) 
      zwexdb(ior) = exdrvb(ior) 
      zwpl0(ior) = pl0(ior) 
      zup_PK(ior) = up_PKz(1,ior) 
      zup_PG(ior) = up_PGz(1,ior) 
      zup_PB(ior) = up_PBz(1,ior) 
      zQ_PK(ior) = Q_PK(ior) 
      zQ_PG(ior) = Q_PG(ior) 
      zQ_PB(ior) = Q_PB(ior) 
      zwJPO4(ior) = hJPO4(mstr,ior) 
      zaktbr(ior) = akibrz(1,ior) 
      zagtbr(ior) = agrbrz(1,ior) 
      zabtbr(ior) = ablbrz(1,ior) 
      zwakz(ior) = dalgkz(1,ior) 
      zwaakz(ior) = algakz(1,ior) 
      zwagz(ior) = dalggz(1,ior) 
      zwaagz(ior) = algagz(1,ior) 
      zwabz(ior) = dalgbz(1,ior) 
      zwaabz(ior) = algabz(1,ior) 
      zwPz(ior) = gelPz(1,ior) 
      zwCsed(ior) = orgCsd(ior) 
!                                                                       
      zwnkzs(ior) = nkzs(ior) 
!                                                                       
      tiefe(ior) = bh(mstr,ior) 
      vmitt(ior) = vbm(mstr,ior) 
      gelp(ior) = bgelp(mstr,ior) 
      gesP(ior) = bgesP(mstr,ior) 
      bsbt(ior) = bbsbt(mstr,ior) 
      bsbct(ior) = bbsbct(mstr,ior) 
      bsbctP(ior) = bbsbcP(mstr,ior) 
      sedalk(ior) = bsedak(mstr,ior) 
      sedalg(ior) = bsedag(mstr,ior) 
      sedalb(ior) = bsedab(mstr,ior) 
      dzres1(ior) = bzres1(mstr,ior) 
      dzres2(ior) = bzres2(mstr,ior) 
      albewg(ior) = babewg(mstr,ior) 
      albewk(ior) = babewk(mstr,ior) 
      alberg(ior) = baberg(mstr,ior) 
      alberk(ior) = baberk(mstr,ior) 
      resdr(ior) = bresdr(mstr,ior) 
      aki(ior) = baki(mstr,ior) 
      agr(ior) = bagr(mstr,ior) 
      abl(ior) = babl(mstr,ior) 
      exdrvk(ior) = bexdvk(mstr,ior) 
      exdrvg(ior) = bexdvg(mstr,ior) 
      exdrvb(ior) = bexdvb(mstr,ior) 
      pl0(ior) = bpl0(mstr,ior) 
      orgCsd(ior) = borgCs(mstr,ior) 
      up_PKz(1,ior) = bup_PK(mstr,ior) 
      up_PGz(1,ior) = bup_PG(mstr,ior) 
      up_PBz(1,ior) = bup_PB(mstr,ior) 
      Q_PK(ior) = bQ_PK(mstr,ior) 
      Q_PG(ior) = bQ_PG(mstr,ior) 
      Q_PB(ior) = bQ_PB(mstr,ior) 
      hJPO4(mstr,ior) = bJPO4(mstr,ior) 
      akibrz(1,ior) = baktbr(mstr,ior) 
      agrbrz(1,ior) = bagtbr(mstr,ior) 
      ablbrz(1,ior) = babtbr(mstr,ior) 
      dalgkz(1,ior) = balgkz(mstr,ior) 
      algakz(1,ior) = balakz(mstr,ior) 
      dalggz(1,ior) = balggz(mstr,ior) 
      algagz(1,ior) = balagz(mstr,ior) 
      dalgbz(1,ior) = balgbz(mstr,ior) 
      algabz(1,ior) = balabz(mstr,ior) 
      gelPz(1,ior) = bgelP(mstr,ior) 
!                                                                       
!                                                                       
 1590 continue 
      ilbuhn = 1 
      goto 413 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1591 ior=1,anze+1 
      bgelp(mstr,ior) = gelp(ior) 
      bgesP(mstr,ior) = gesP(ior) 
      bpl0(mstr,ior) = pl0(ior) 
!                                                                       
      tiefe(ior) = zwtief(ior) 
      vmitt(ior) = zwvm(ior) 
      gelp(ior) = zwgelp(ior) 
      gesP(ior) = zwgesP(ior) 
      bsbt(ior) = zwbsbt(ior) 
      bsbct(ior) = zwbsct(ior) 
      bsbctP(ior) = zwbsP(ior) 
      sedalk(ior) = zwsedk(ior) 
      sedalg(ior) = zwsedg(ior) 
      sedalb(ior) = zwsedb(ior) 
      dzres1(ior) = zwdzr1(ior) 
      dzres2(ior) = zwdzr2(ior) 
      albewg(ior) = zwabwg(ior) 
      alberg(ior) = zwabrg(ior) 
      albewk(ior) = zwabwk(ior) 
      alberk(ior) = zwabrk(ior) 
      resdr(ior) = zwrdr(ior) 
      aki(ior) = zwaki(ior) 
      agr(ior) = zwagr(ior) 
      abl(ior) = zwabl(ior) 
      exdrvk(ior) = zwexdk(ior) 
      exdrvg(ior) = zwexdg(ior) 
      exdrvb(ior) = zwexdb(ior) 
      pl0(ior) = zwpl0(ior) 
      up_PKz(1,ior) = zup_PK(ior) 
      up_PGz(1,ior) = zup_PG(ior) 
      up_PBz(1,ior) = zup_PB(ior) 
      Q_PK(ior) = zQ_PK(ior) 
      Q_PG(ior) = zQ_PG(ior) 
      Q_PB(ior) = zQ_PB(ior) 
      hJPO4(mstr,ior) = zwJPO4(ior) 
      akibrz(1,ior) = zaktbr(ior) 
      agrbrz(1,ior) = zagtbr(ior) 
      ablbrz(1,ior) = zabtbr(ior) 
      dalgkz(1,ior) = zwakz(ior) 
      algakz(1,ior) = zwaakz(ior) 
      dalggz(1,ior) = zwagz(ior) 
      algagz(1,ior) = zwaagz(ior) 
      dalgbz(1,ior) = zwabz(ior) 
      algabz(1,ior) = zwaabz(ior) 
      orgCsd(ior) = zwCsed(ior) 
!                                                                       
      nkzs(ior) = zwnkzs(ior) 
      gelPz(1,ior) = zwPz(ior) 
!                                                                       
      dgelp1(ior) = bgelp(mstr,ior)-gelp(ior) 
      dpl01(ior) = bpl0(mstr,ior)-pl0(ior) 
      dgesP1(ior) = bgesP(mstr,ior)-gesP(ior) 
      dQ_PK1(ior) = bQ_PK(mstr,ior)-Q_PK(ior) 
      dQ_PG1(ior) = bQ_PG(mstr,ior)-Q_PG(ior) 
      dQ_PB1(ior) = bQ_PB(mstr,ior)-Q_PB(ior) 
!                                                                       
      dgelp2(ior) = gelp(ior)-bgelp(mstr,ior) 
      dpl02(ior) = pl0(ior)-bpl0(mstr,ior) 
      dgesP2(ior) = gesP(ior)-bgesP(mstr,ior) 
      dQ_PK2(ior) = Q_PK(ior)-bQ_PK(mstr,ior) 
      dQ_PG2(ior) = Q_PG(ior)-bQ_PG(mstr,ior) 
      dQ_PB2(ior) = Q_PB(ior)-bQ_PB(mstr,ior) 
!                                                                       
      gelp(ior) = gelp(ior)+hctau1(ior)*dgelp1(ior) 
      pl0(ior) = pl0(ior)+hctau1(ior)*dpl01(ior) 
      gesP(ior) = gesP(ior)+hctau1(ior)*dgesP1(ior) 
      Q_PK(ior) = Q_PK(ior)+hctau1(ior)*dQ_PK1(ior) 
      Q_PG(ior) = Q_PG(ior)+hctau1(ior)*dQ_PG1(ior) 
      Q_PB(ior) = Q_PB(ior)+hctau1(ior)*dQ_PB1(ior) 
!                                                                       
      if(hctau2(ior).eq.0.0)goto 1591 
!                                                                       
      bgelp(mstr,ior) = bgelp(mstr,ior)+hctau2(ior)*dgelp2(ior) 
      bpl0(mstr,ior) = bpl0(mstr,ior)+hctau2(ior)*dpl02(ior) 
      bgesP(mstr,ior) = bgesP(mstr,ior)+hctau2(ior)*dgesP2(ior) 
      bQ_PK(mstr,ior) = bQ_PK(mstr,ior)+hctau2(ior)*dQ_PK2(ior) 
      bQ_PG(mstr,ior) = bQ_PG(mstr,ior)+hctau2(ior)*dQ_PG2(ior) 
      bQ_PB(mstr,ior) = bQ_PB(mstr,ior)+hctau2(ior)*dQ_PB2(ior) 
!                                                                       
 1591 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!                                                                       
!***************Silikat**********************                           
!                                                                       
 1516 continue 
      if(si(1).lt.0.0)goto 1517 
      call silikat(si,flag,elen,ior                                     &
     &,esi,qeinl,vabfl,anze,tflie,jiein,aki                             &
     &,albewk,alberk,tiefe,tempw,sised,ilbuhn,akkssi                    &
     &,Qmx_SK,Q_SK,up_Siz,Siz,dalgkz,akitbr,akibrz                      &
     &,SiRuek,Skmor,nkzs,dH2D,dH2De,mstr                                &
     &,iorLa,iorLe,ieinLs,flae,qeinlL,SiL,itags,uhrz,itrein)            
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1517 
      if(ilbuhn.eq.0)then 
      do 1595 ior=1,anze+1 
      zwtief(ior) = tiefe(ior) 
      zwtemp(ior) = tempw(ior) 
      zwsi(ior) = si(ior) 
      zwabwk(ior) = albewk(ior) 
      zwabrk(ior) = alberk(ior) 
      zwsisd(ior) = sised(ior) 
      zwSKmo(ior) = SKmor(ior) 
      zup_Si(ior) = up_Siz(1,ior) 
      zQ_SK(ior) = Q_SK(ior) 
      zwakz(ior) = dalgkz(1,ior) 
      zwaakz(ior) = algakz(1,ior) 
!                                                                       
      zwnkzs(ior) = nkzs(ior) 
      zwsiz(ior) = siz(1,ior) 
!                                                                       
      tiefe(ior) = bh(mstr,ior) 
      tempw(ior) = btempw(mstr,ior) 
      si(ior) = bsi(mstr,ior) 
      albewk(ior) = babewk(mstr,ior) 
      alberk(ior) = baberk(mstr,ior) 
      sised(ior) = bsised(mstr,ior) 
      SKmor(ior) = bSKmor(mstr,ior) 
      up_Siz(1,ior) = bup_Si(mstr,ior) 
      Q_SK(ior) = bQ_SK(mstr,ior) 
      akibrz(1,ior) = baktbr(mstr,ior) 
      dalgkz(1,ior) = balgkz(mstr,ior) 
      algakz(1,ior) = balakz(mstr,ior) 
      Siz(1,ior) = bsi(mstr,ior) 
!                                                                       
!                                                                       
 1595 continue 
      ilbuhn = 1 
      goto 1516 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1596 ior=1,anze+1 
      bsi(mstr,ior) = si(ior) 
      bsised(mstr,ior) = sised(ior) 
      bSKmor(mstr,ior) = SKmor(ior) 
!                                                                       
      tiefe(ior) = zwtief(ior) 
      tempw(ior) = zwtemp(ior) 
      si(ior) = zwsi(ior) 
      albewk(ior) = zwabwk(ior) 
      alberk(ior) = zwabrk(ior) 
      sised(ior) = zwsisd(ior) 
      SKmor(ior) = zwSKmo(ior) 
      up_Siz(1,ior) = zup_Si(ior) 
      Q_SK(ior) = zQ_SK(ior) 
      dalgkz(1,ior) = zwakz(ior) 
      algakz(1,ior) = zwaakz(ior) 
!                                                                       
      nkzs(ior) = zwnkzs(ior) 
      siz(1,ior) = zwsiz(ior) 
!                                                                       
      dsi1(ior) = bsi(mstr,ior)-si(ior) 
      dQ_SK1(ior) = bQ_SK(mstr,ior)-Q_SK(ior) 
!                                                                       
      dsi2(ior) = si(ior)-bsi(mstr,ior) 
      dQ_SK2(ior) = Q_SK(ior)-bQ_SK(mstr,ior) 
!                                                                       
      si(ior) = si(ior)+hctau1(ior)*dsi1(ior) 
      Q_SK(ior) = Q_SK(ior)+hctau1(ior)*dQ_SK1(ior) 
!                                                                       
      if(hctau2(ior).eq.0.0)goto 1596 
!                                                                       
      bsi(mstr,ior) = bsi(mstr,ior)+hctau2(ior)*dsi2(ior) 
      bQ_SK(mstr,ior) = bQ_SK(mstr,ior)+hctau2(ior)*dQ_SK2(ior) 
!                                                                       
 1596 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!*********Sauerstoff******************                                  
!                                                                       
 1517 continue 
      if(vo2(1).lt.0.0)goto 1518 
      call oxygen(VO2,TEMPW,RAU,VMITT,TIEFE,FLAE,TFLIE,go2n             &
     &,dalgki,dalggr,dalgak,dalgag,akinh4,agrnh4,akino3,agrno3          &
     &,bsbt,hJO2,flag,elen,ior,anze,dzres1,dzres2,hschlr                &
     &,eo2,qeinl,vabfl,po2p,po2r,so2ein                                 &
     &,bbei2D,salgo,dalgo,dalgao,o2ein1,jiein                           &
     &,opgrmi,opgrma,opkimi,opkima,albewg,alberg,abeowg,abeorg          &
     &,opblmi,opblma,ablnh4,ablno3,dalgbl,dalgab                        &
     &,albewk,alberk,abeowk,abeork,ro2dr,wge,IDWe                       &
     &,fkm,uhrz,si,gelp,ssalg,ir,vnh4,vno3,bsbbet                       &
     &,zooro2,rO2HNF,ilbuhn,iwied                                       &
     &,vo2z,susO2N,nkzs,dH2D                                            &
     &,agnh4z,aknh4z,abnh4z,dalgkz,dalgbz,dalggz,agno3z,akno3z,abno3z   &
     &,algakz,algagz,algabz,vz1,tempwz,saett,mstr,cpfad,ij,itags,monats &
     &,itrein)                                                          
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1518 
      if(ilbuhn.eq.0)then 
      do 1597 ior=1,anze+1 
      zwtemp(ior) = tempw(ior) 
      zwtief(ior) = tiefe(ior) 
      zwvm(ior) = vmitt(ior) 
      zwno3(ior) = vno3(ior) 
      zwnh4(ior) = vnh4(ior) 
      zwvo2(ior) = vo2(ior) 
      do 2780 nkz = 1,nkzs(ior) 
 2780 zwo2z(nkz,ior) = vo2z(nkz,ior) 
      zwnkzs(ior) = nkzs(ior) 
      zwgo2n(ior) = go2n(ior) 
      zwbsbt(ior) = bsbt(ior) 
      zwdalk(ior) = dalgki(ior) 
      zwdalg(ior) = dalggr(ior) 
      zwdalb(ior) = dalgbl(ior) 
      zwdaak(ior) = dalgak(ior) 
      zwdaag(ior) = dalgag(ior) 
      zwdaab(ior) = dalgab(ior) 
      zwschr(ior) = hschlr(mstr,ior) 
      zwagn4(ior) = agrnh4(ior) 
      zwakn4(ior) = akinh4(ior) 
      zwabn4(ior) = ablnh4(ior) 
      zwagn3(ior) = agrno3(ior) 
      zwakn3(ior) = akino3(ior) 
      zwabn3(ior) = ablno3(ior) 
      zwdzr1(ior) = dzres1(ior) 
      zwdzr2(ior) = dzres2(ior) 
      zwpo2p(ior) = po2p(ior) 
      zwpo2r(ior) = po2r(ior) 
      zwso2e(ior) = so2ein(ior) 
      zwsalo(ior) = salgo(ior) 
      zwdalo(ior) = dalgo(ior) 
      zwdago(ior) = dalgao(ior) 
      zwo2ei(ior) = o2ein1(ior) 
      zwabwg(ior) = albewg(ior) 
      zwabrg(ior) = alberg(ior) 
      zwabwk(ior) = albewk(ior) 
      zwabrk(ior) = alberk(ior) 
      zwabwg(ior) = abeowg(ior) 
      zwabwk(ior) = abeowk(ior) 
      zwabrg(ior) = abeorg(ior) 
      zwabrk(ior) = abeork(ior) 
      zwrodr(ior) = ro2dr(ior) 
      zwrzo(ior) =  zooro2(ior) 
      zwrHNF(ior) = ro2HNF(ior) 
      zwJO2(ior) = hJO2(mstr,ior) 
!                                                                       
!                                                                       
      tempw(ior) = btempw(mstr,ior) 
      tiefe(ior) = bh(mstr,ior) 
      vmitt(ior) = vbm(mstr,ior) 
      vno3(ior) = bno3(mstr,ior) 
      vnh4(ior) = bnh4(mstr,ior) 
      vo2(ior) = bo2(mstr,ior) 
      vo2z(1,ior) = bo2(mstr,ior) 
      go2n(ior) = bgo2n(mstr,ior) 
      bsbt(ior) = bbsbt(mstr,ior) 
      dalgki(ior) = bdaki(mstr,ior) 
      dalggr(ior) = bdagr(mstr,ior) 
      dalgbl(ior) = bdabl(mstr,ior) 
      dalgak(ior) = bdaak(mstr,ior) 
      dalgag(ior) = bdaag(mstr,ior) 
      dalgab(ior) = bdaab(mstr,ior) 
      agrnh4(ior) = bagn4(mstr,ior) 
      akinh4(ior) = bakn4(mstr,ior) 
      ablnh4(ior) = babn4(mstr,ior) 
      agrno3(ior) = bagn3(mstr,ior) 
      akino3(ior) = bakn3(mstr,ior) 
      ablno3(ior) = babn3(mstr,ior) 
      dzres1(ior) = bzres1(mstr,ior) 
      dzres2(ior) = bzres2(mstr,ior) 
      po2p(ior) = bpo2p(mstr,ior) 
      po2r(ior) = bpo2r(mstr,ior) 
      albewg(ior) = babewg(mstr,ior) 
      albewk(ior) = babewk(mstr,ior) 
      alberg(ior) = baberg(mstr,ior) 
      alberk(ior) = baberk(mstr,ior) 
      ro2dr(ior) = bro2dr(mstr,ior) 
      ro2HNF(ior) = bro2HF(mstr,ior) 
      dalgkz(1,ior) = balgkz(mstr,ior) 
      algakz(1,ior) = balakz(mstr,ior) 
      dalggz(1,ior) = balggz(mstr,ior) 
      algagz(1,ior) = balagz(mstr,ior) 
      akNH4z(1,ior) = bkN4z(mstr,ior) 
      akNO3z(1,ior) = bkN3z(mstr,ior) 
      agNH4z(1,ior) = bgN4z(mstr,ior) 
      agNO3z(1,ior) = bgN3z(mstr,ior) 
      hJO2(mstr,ior) = bJO2(mstr,ior) 
!                                                                       
 1597 continue 
      ilbuhn = 1 
      goto 1517 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1598 ior=1,anze+1 
      bo2(mstr,ior) = vo2(ior) 
      bschlr(mstr,ior) = hschlr(mstr,ior) 
!                                                                       
      tempw(ior) = zwtemp(ior) 
      tiefe(ior) = zwtief(ior) 
      vmitt(ior) = zwvm(ior) 
      vno3(ior) = zwno3(ior) 
      vnh4(ior) = zwnh4(ior) 
      vo2(ior) = zwvo2(ior) 
      nkzs(ior) = zwnkzs(ior) 
      do 2781 nkz = 1,nkzs(ior) 
 2781 vo2z(nkz,ior) = zwo2z(nkz,ior) 
      go2n(ior) = zwgo2n(ior) 
      bsbt(ior) = zwbsbt(ior) 
      dalgki(ior) = zwdalk(ior) 
      dalggr(ior) = zwdalg(ior) 
      dalgbl(ior) = zwdalb(ior) 
      dalgak(ior) = zwdaak(ior) 
      dalgag(ior) = zwdaag(ior) 
      dalgab(ior) = zwdaab(ior) 
      hschlr(mstr,ior) = zwschr(ior) 
      agrnh4(ior) = zwagn4(ior) 
      akinh4(ior) = zwakn4(ior) 
      ablnh4(ior) = zwabn4(ior) 
      agrno3(ior) = zwagn3(ior) 
      akino3(ior) = zwakn3(ior) 
      ablno3(ior) = zwabn3(ior) 
      dzres1(ior) = zwdzr1(ior) 
      dzres2(ior) = zwdzr2(ior) 
      po2p(ior) = zwpo2p(ior) 
      po2r(ior) = zwpo2r(ior) 
      so2ein(ior) = zwso2e(ior) 
      salgo(ior) = zwsalo(ior) 
      dalgo(ior) = zwdalo(ior) 
      dalgao(ior) = zwdago(ior) 
      o2ein1(ior) = zwo2ei(ior) 
      albewg(ior) = zwabwg(ior) 
      alberg(ior) = zwabrg(ior) 
      albewk(ior) = zwabwk(ior) 
      alberk(ior) = zwabrk(ior) 
      abeowg(ior) = zwabwg(ior) 
      abeowk(ior) = zwabwk(ior) 
      abeorg(ior) = zwabrg(ior) 
      abeork(ior) = zwabrk(ior) 
      ro2dr(ior) = zwrodr(ior) 
      zooro2(ior) = zwrzo(ior) 
      ro2HNF(ior) = zwrHNF(ior) 
      hJO2(mstr,ior) = zwJO2(ior) 
!                                                                       
      do21(ior) = bo2(mstr,ior)-vo2(ior) 
!                                                                       
      do22(ior) = vo2(ior)-bo2(mstr,ior) 
!                                                                       
      vo2(ior) = vo2(ior)+hctau1(ior)*do21(ior) 
!                                                                       
      if(hctau2(ior).eq.0.0)goto 1598 
!                                                                       
      bo2(mstr,ior) = bo2(mstr,ior)+hctau2(ior)*do22(ior) 
!                                                                       
 1598 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!                                                                       
!***************Schwebstoffe**************                              
!                                                                       
 1518 continue 
      if(ssalg(1).lt.0.0)goto 1519 
      call SCHWEB(zooind,dorgSS,ss,ssalg,tiefe,rau                      &
     &,tflie,VMITT,flag,elen,ior,anze,ess,qeinl,vabfl                   &
     &,dkimor,dgrmor,abszo,zexki,zexgr                                  &
     &,abl,zexbl,dblmor,drfaeb,jiein                                    &
     &,aki,agr,ssdr,drfaek,drfaeg,drfaes,fssgr,sedss,fssgrs             &
     &,tauscs,ischif,ilbuhn,fkm,ieros,iwied                             &
     &,echla,vkigr,akbcm,agbcm,antbl,abbcm,ezind,GROTe,mstr             &
     &,itrein)                                                          
!                                                                       
      if(nbuhn(mstr).eq.0)goto 1519 
      if(ilbuhn.eq.0)then 
      do 1599 ior=1,anze+1 
      zwtief(ior) = tiefe(ior) 
      zwvm(ior) = vmitt(ior) 
      zwzooi(ior) = zooind(ior) 
      zworgS(ior) = dorgSS(ior) 
      zwss(ior) = ss(ior) 
      zwssa(ior) = ssalg(ior) 
      zwkmor(ior) = dkimor(ior) 
      zwgmor(ior) = dgrmor(ior) 
      zwbmor(ior) = dblmor(ior) 
      zwabsz(ior) = abszo(ior) 
      zwzexk(ior) = zexki(ior) 
      zwzexg(ior) = zexgr(ior) 
      zwzexb(ior) = zexbl(ior) 
      zwaki(ior) = aki(ior) 
      zwagr(ior) = agr(ior) 
      zwabl(ior) = abl(ior) 
      zwkigr(ior) = vkigr(ior) 
      zwantb(ior) = antbl(ior) 
      zwdfak(ior) = drfaek(ior) 
      zwdfag(ior) = drfaeg(ior) 
      zwdfab(ior) = drfaeb(ior) 
      zwdfas(ior) = drfaes(ior) 
      zwssdr(ior) = ssdr(ior) 
      zwfssg(ior) = fssgr(ior) 
      zwsedS(ior) = sedss(ior) 
!                                                                       
!                                                                       
      tiefe(ior) = bh(mstr,ior) 
      vmitt(ior) = vbm(mstr,ior) 
      zooind(ior) = bzooi(mstr,ior) 
      dorgSS(ior) = borgSS(mstr,ior) 
      ss(ior) = bss(mstr,ior) 
      ssalg(ior) = bssalg(mstr,ior) 
      dkimor(ior) = bdkmor(mstr,ior) 
      dgrmor(ior) = bdgmor(mstr,ior) 
      dblmor(ior) = bdbmor(mstr,ior) 
      abszo(ior) = babszo(mstr,ior) 
      zexki(ior) = bzexki(mstr,ior) 
      zexgr(ior) = bzexgr(mstr,ior) 
      zexbl(ior) = bzexbl(mstr,ior) 
      aki(ior) = baki(mstr,ior) 
      agr(ior) = bagr(mstr,ior) 
      abl(ior) = babl(mstr,ior) 
      vkigr(ior) = bvkigr(mstr,ior) 
      antbl(ior) = bantbl(mstr,ior) 
      drfaek(ior) = bdfaek(mstr,ior) 
      drfaeg(ior) = bdfaeg(mstr,ior) 
      drfaeb(ior) = bdfaeb(mstr,ior) 
      drfaes(ior) = bdfaes(mstr,ior) 
      ssdr(ior) = bssdr(mstr,ior) 
      fssgr(ior) = bfssgr(mstr,ior) 
      sedSS(ior) = bsedSS(mstr,ior) 
!                                                                       
 1599 continue 
      ilbuhn = 1 
      goto 1518 
      endif 
!                                                                       
      if(ilbuhn.eq.1)then 
      do 1601 ior=1,anze+1 
      borgSS(mstr,ior) = dorgSS(ior) 
      bss(mstr,ior) = ss(ior) 
      bssalg(mstr,ior) = ssalg(ior) 
      bssdr(mstr,ior) = ssdr(ior) 
      bfssgr(mstr,ior) = fssgr(ior) 
      bsedSS(mstr,ior) = sedSS(ior) 
!                                                                       
      tempw(ior) = zwtemp(ior) 
      tiefe(ior) = zwtief(ior) 
      vmitt(ior) = zwvm(ior) 
      zooind(ior) = zwzooi(ior) 
      dorgSS(ior) = zworgS(ior) 
      ss(ior) = zwss(ior) 
      ssalg(ior) = zwssa(ior) 
      dkimor(ior) = zwkmor(ior) 
      dgrmor(ior) = zwgmor(ior) 
      dblmor(ior) = zwbmor(ior) 
      abszo(ior) = zwabsz(ior) 
      zexki(ior) = zwzexk(ior) 
      zexgr(ior) = zwzexg(ior) 
      zexbl(ior) = zwzexb(ior) 
      aki(ior) = zwaki(ior) 
      agr(ior) = zwagr(ior) 
      abl(ior) = zwabl(ior) 
      vkigr(ior) = zwkigr(ior) 
      antbl(ior) = zwantb(ior) 
      drfaek(ior) = zwdfak(ior) 
      drfaeg(ior) = zwdfag(ior) 
      drfaes(ior) = zwdfas(ior) 
      ssdr(ior) = zwssdr(ior) 
      fssgr(ior) = zwfssg(ior) 
      sedss(ior) = zwsedS(ior) 
!                                                                       
      dss1(ior) = bss(mstr,ior)-ss(ior) 
      dssal1(ior) = bssalg(mstr,ior)-ssalg(ior) 
      dfssg1(ior) = bfssgr(mstr,ior)-fssgr(ior) 
!                                                                       
      dss2(ior) = ss(ior)-bss(mstr,ior) 
      dssal2(ior) = ssalg(ior)-bssalg(mstr,ior) 
      dfssg2(ior) = fssgr(ior)-bfssgr(mstr,ior) 
!                                                                       
      ss(ior) = ss(ior)+hctau1(ior)*dss1(ior) 
      ssalg(ior) = ssalg(ior)+hctau1(ior)*dssal1(ior) 
      fssgr(ior) = fssgr(ior)+hctau1(ior)*dfssg1(ior) 
!                                                                       
      if(hctau2(ior).eq.0.0)goto 1601 
!                                                                       
      bss(mstr,ior) = bss(mstr,ior)+hctau2(ior)*dss2(ior) 
      bssalg(mstr,ior) = bssalg(mstr,ior)+hctau2(ior)*dssal2(ior) 
      bfssgr(mstr,ior) = bfssgr(mstr,ior)+hctau2(ior)*dfssg2(ior) 
 1601 continue 
!                                                                       
      ilbuhn = 0 
      endif 
!                                                                       
!                                                                       
 1519 continue 
!                                                                       
!********Coliform***********                                            
!                                                                       
      if(hcoli(mstr,1).le.0.0)goto 1520 
!                                                                       
      call COLIFORM(tiefe,vmitt,vabfl,elen,flag,tflie,schwi             &
     &,ss,zooind,GRote,Chla,tempw,jiein,ecoli,qeinl,anze                &
     &,ilbuhn,coli,DOSCF,alamda,mstr,itrein)                            
!                                                                       
!**************Erosion*******************                               
!                                                                       
 1520 if(ieros.eq.0)goto 118 
!                                                                       
      call erosion(anze,fkm,ss,ssalg,tflie                              &
     &,ischic,sedh,tausc,sedss,sedalk,sedalg,sedalb                     &
     &,tiefe,rau,vmitt,mstr)                                            
!                                                                       
!....Umspeichern der Sedimentgroessen                                   
!      do 463 ior = 1,anze                                              
!      sedh(mstr,ior) = sedhg(mstr,ior)                                 
!      ischic(mstr,ior) = ischig(mstr,ior)                              
!      do 464 itau = 1,50                                               
!  464 tausc(mstr,ior,itau) = tauscg(mstr,ior,itau)                     
!  463 continue                                                         
!                                                                       
  118 continue 
!                                                                       
      if(iwsim.eq.4)goto 1781 
!                                                                       
      deltat = STRdt(mstr) 
      if(iMAC.eq.1)goto 1112 
!      call cra_NicKoeff(elen,r1,r2,r3,r,r6,flag,dl,deltat,anze)        
!                                                                       
!                                                                       
!     vertikale Diffusion                                               
!                                                                       
 1112 if(I2Ds(mstr).eq.0)goto 112 
!                                                                       
      do 796 ior = 1,anze 
!                                                                       
      if(nkzs(ior).eq.1)goto 796 
!                                                                       
!                                                                       
      call k_eps(tempwz,tiefe,vmitt,rau,dH2D,nkzs,tflie                 &
     &,dtemp,IDWe,WGe,mstr,Dz2D,ior,vo2z,hJO2                           &
     &,BBEI2D,vz1,vNH4z,vNO2z,vNO3z,hJPO4,SiRuek                        &
     &,hJNH4,hJNO3,vx02,gelPz,Siz,iwied,uhrz,FluxT1                     &
     &,akiz,agrz,ablz,chlaz,fkm,Uvert,Breite,geoB,Wlage,hWS,itags)      
!                                                                       
      hDz2D(mstr,ior) = Dz2D(ior) 
!                                                                       
!      call verti_Dz(ior,rau,vmitt,tiefe,tempwz,nkzs,dH2D,Dz            
!     *,dztot,uhrz)                                                     
!                                                                       
!      call vertKonz(ior,Dz,dH2D,tflie,sednz,betn1z,vnh4z               
!     *,vx02,betn2z,vno2z,vno3dz,vno3z,schlrz,betOCz,betO2N,vo2z        
!     *,Saett,BBei,tiefe,tempwz,gelPz,Siz,nkzs,vz11)                    
!                                                                       
!                                                                       
  796 continue 
!                                                                       
      if(nkzs(anze).eq.1)goto 112 
      do 115 nkz = 1,nkzs(anze) 
      tempwz(nkz,anze+1) = tempwz(nkz,anze) 
  115 continue 
!                                                                       
  112 continue 
!                                                                       
 1781 continue 
!                                                                       
! ......Transport...............                                        
!                                                                       
      izeits = STRiz(mstr) 
      deltat = STRdt(mstr) 
      jpoin1 = 0 
!                                                                       
!      goto 717                                                         
!      if(mstr.eq.4)then 
!      do 9869 ior=1,anze+1 
!      write(89,*)mstr,ior,tempw(ior) 
! 9869 continue 
!      endif 
      call Transport(anze,deltat,izeits,vmitt,elen,flag                 &
     &,tempw,vo2,vnh4,vno3,vno2,vx0,vx02,Si,r1,r2,r3,mstr               &
     &,gelP,obsb,ocsb,vbsb,vcsb,CHNF,BVHNF,CD,CP,CM,BAC,O2BSB           &
     &,bl01,bl02,zooind,chla,aki,agr,abl,chlaki,chlagr                  &
     &,chlabl,vkigr,antbl,abrzo1,ssalg,ss,svhemk,svhemg,svhemb          &
     &,akbcm,agbcm,abbcm,fssgr,fbsgr,frfgr,gesN,gesP                    &
     &,nl0,pl0,Q_NK,Q_PK,Q_SK,Q_NG,Q_PG,Q_NB,Q_PB,akiiv,agriv           &
     &,abliv,stind,mw,pw,ca,lf,coli,DOSCF,dlarvn,vph,iph,iwsim          &
     &,htempw,hgesN,hgesP,hbsb,hcsb,hCHNF,hBVHNF                        &
     &,hCD,hCP,hCM,hBAC,hO2BSB,hbl01,hbl02,hnh4,ho2                     &
     &,hno3,hno2,hx0,hx02,hsi,hchla,haki,hagr,habl                      &
     &,hchlak,hchlag,hchlab,hvkigr,hantbl,hssalg,hss,hzooi              &
     &,hgelp,hmw,hpw,hca,hlf,hph,hdlarn,hcoli,hDOSCF,hvbsb,hvcsb        &
     &,SKmor,hSKmor,iflRi,dl,Uvert,iMAC,iwied,nkzs,tflie,jpoin1,itags   &
     &,monats,itrein,uhrz)                                                   
!                                                                       
!      if(mstr.eq.4)then 
!      do 9868 ior=1,anze+1 
!      write(89,*)mstr,ior,ior,tempw(ior) 
! 9868 continue 
!      endif 
!                                                                       
  717 continue 
!                                                                       
      if(iwsim.eq.4)goto 53 
!                                                                       
!      if(itags.eq.3.and.monats.eq.3.and.uhrz.ge.12)then                
!      do 6540 ior=1,anze+1                                             
!        do 6541 nkz=1,nkzs(ior)                                        
!      write(89,*)mstr,ior,nkz,agrz(nkz,ior),akiz(nkz,ior)              
!     *,ablz(nkz,ior)                                                   
! 6541 continue                                                         
! 6540 continue                                                         
!      endif                                                            
      call Transportz(anze,deltat,izeits,vmitt,elen,flag                &
     &,tempwz,vnh4z,vno2z,vno3z,vo2z,gelPz,Siz,akiz,agrz                &
     &,ablz,chlaz,nkzs,dH2D,i2Ds,iwsim,mstr,r1,r2,r3                    &
     &,htempz,ho2z,hnh4z,hno2z,hno3z,hgelPz,hSiz                        &
     &,hakiz,hagrz,hablz,hchlaz,iflRi,dl,iMAC,Uvert,tflie               &
     &,jpoin1,itags,monats,itrein,uhrz)                                      
!      if(itags.eq.3.and.monats.eq.3.and.uhrz.ge.12)then                
!      do 6539 ior=1,anze+1                                             
!      do 6538 nkz=1,nkzs(ior)                                          
!      write(89,*)uhrz,mstr,ior,nkz,agrz(nkz,ior),akiz(nkz,ior)         
!     *,ablz(nkz,ior)                                                   
! 6538 continue                                                         
! 6539 continue                                                         
!      endif                                                            
!                                                                       
!                                                                       
!.....Mittelwertbildung des Sauerstoffgehalts des Chla-Gehaltes der     
!.....Algenbiomassen und der Naehrstoffe bei 2D-Modellierung            
  606 do 603 ior = 1,anze+1 
      if(nkzs(ior).eq.1)goto 603 
      sT = 0.0 
      sO2 = 0.0 
      ski = 0.0 
      sgr = 0.0 
      sbl = 0.0 
      schl = 0.0 
      sN4 = 0.0 
      sN2 = 0.0 
      sN3 = 0.0 
      sP = 0.0 
      sSi = 0.0 
      sumH = 0.0 
      do 604 nkz = 1,nkzs(ior)-1 
      if((nkz+1).eq.nkzs(ior).and.dH2De(ior).gt.0.0)then 
      dH2Db = dH2De(ior) 
      Tend = tempwz(nkz,ior)+(((tempwz(nkz+1,ior)-tempwz(nkz,ior))/     &
     &dH2D)*dH2Db)                                                      
      oend = vo2z(nkz,ior)+(((vo2z(nkz+1,ior)-vo2z(nkz,ior))/           &
     &dH2D)*dH2Db)                                                      
      N4end = vNH4z(nkz,ior)+(((vNH4z(nkz+1,ior)-vNH4z(nkz,ior))/       &
     &dH2D)*dH2Db)                                                      
      N2end = vNO2z(nkz,ior)+(((vNO2z(nkz+1,ior)-vNO2z(nkz,ior))/       &
     &dH2D)*dH2Db)                                                      
      N3end = vNO3z(nkz,ior)+(((vNO3z(nkz+1,ior)-vNO3z(nkz,ior))/       &
     &dH2D)*dH2Db)                                                      
      Pend = gelPz(nkz,ior)+(((gelPz(nkz+1,ior)-gelPz(nkz,ior))/        &
     &dH2D)*dH2Db)                                                      
      Siend = Siz(nkz,ior)+(((Siz(nkz+1,ior)-Siz(nkz,ior))/             &
     &dH2D)*dH2Db)                                                      
      Kiend = akiz(nkz,ior)+(((akiz(nkz+1,ior)-akiz(nkz,ior))/          &
     &dH2D)*dH2Db)                                                      
      Grend = agrz(nkz,ior)+(((agrz(nkz+1,ior)-agrz(nkz,ior))/          &
     &dH2D)*dH2Db)                                                      
      Blend = ablz(nkz,ior)+(((ablz(nkz+1,ior)-ablz(nkz,ior))/          &
     &dH2D)*dH2Db)                                                      
      chlend = chlaz(nkz,ior)+(((chlaz(nkz+1,ior)-chlaz(nkz,ior))/      &
     &dH2D)*dH2Db)                                                      
!                                                                       
      sT = sT+((tempwz(nkz,ior)+Tend)/2.)*dH2Db 
      sO2 = sO2+((vo2z(nkz,ior)+oend)/2.)*dH2Db 
      sN4 = sN4+((vNH4z(nkz,ior)+N4end)/2.)*dH2Db 
      sN2 = sN2+((vNO2z(nkz,ior)+N2end)/2.)*dH2Db 
      sN3 = sN3+((vNO3z(nkz,ior)+N3end)/2.)*dH2Db 
      sP = sP+((gelPz(nkz,ior)+Pend)/2.)*dH2Db 
      sSi = sSi+((Siz(nkz,ior)+Siend)/2.)*dH2Db 
      sKi = sKi+((akiz(nkz,ior)+Kiend)/2.)*dH2Db 
      sGr = sGr+((agrz(nkz,ior)+Grend)/2.)*dH2Db 
      sBl = sBl+((ablz(nkz,ior)+Blend)/2.)*dH2Db 
      sChl = sChl+((chlaz(nkz,ior)+Chlend)/2.)*dH2Db 
      sumH = sumH+dH2Db 
      goto 604 
      endif 
!                                                                       
      sT = sT+((tempwz(nkz,ior)+tempwz(nkz+1,ior))/2.)*dH2D 
      so2 = so2+((vo2z(nkz,ior)+vo2z(nkz+1,ior))/2.)*dH2D 
      ski = ski+((akiz(nkz,ior)+akiz(nkz+1,ior))/2.)*dH2D 
      sgr = sgr+((agrz(nkz,ior)+agrz(nkz+1,ior))/2.)*dH2D 
      sbl = sbl+((ablz(nkz,ior)+ablz(nkz+1,ior))/2.)*dH2D 
      schl = schl+((chlaz(nkz,ior)+chlaz(nkz+1,ior))/2.)*dH2D 
      sN4 = sN4+((vNH4z(nkz,ior)+vNH4z(nkz+1,ior))/2.)*dH2D 
      sN2 = sN2+((vNO2z(nkz,ior)+vNO2z(nkz+1,ior))/2.)*dH2D 
      sN3 = sN3+((vNO3z(nkz,ior)+vNO3z(nkz+1,ior))/2.)*dH2D 
      sP = sP+((gelPz(nkz,ior)+gelPz(nkz+1,ior))/2.)*dH2D 
      sSi = sSi+((Siz(nkz,ior)+Siz(nkz+1,ior))/2.)*dH2D 
      sumH = sumH+dH2D 
  604 continue 
      tempw(ior) = sT/sumH 
      vo2(ior) = so2/sumH 
      aki(ior) = ski/sumH 
      agr(ior) = sgr/sumH 
      abl(ior) = sbl/sumH 
      chla(ior) = schl/sumH 
      vNH4(ior) = sN4/sumH 
      vNO2(ior) = sN2/sumH 
      vNO3(ior) = sN3/sumH 
      gelP(ior) = sP/sumH 
      Si(ior) = sSi/sumH 
  603 continue 
!                                                                       
!.....Belegung des letzten Knoten bei nicht transportierten Groessen bzw
!....(Buhnenfelder)                                                     
!                                                                       
   53 Pfl(anze+1) = Pfl(anze) 
      do 66 ndr = 1,nndr 
      zdrei(anze+1,ndr) = zdrei(anze,ndr) 
      zdreis(anze+1,ndr) = zdreis(anze,ndr) 
   66 gewdr(anze+1,ndr) = gewdr(anze,ndr) 
      abegm2(anze+1) = abegm2(anze) 
      abekm2(anze+1) = abekm2(anze) 
      do 67 ico = 1,5 
      coro(anze+1,ico) = coro(anze,ico) 
   67 coros(anze+1,ico) = coros(anze,ico) 
!                                                                       
!.... Sedimentgroessen                                                  
      sedh(anze+1) = sedh(anze) 
!                                                                       
!     Prozessraten                                                      
!                                                                       
      do 83 ndr=1,nndr 
      idras(anze+1,ndr) = idras(anze,ndr) 
      drmas(anze+1,ndr) = drmas(anze,ndr) 
      drakr(anze+1,ndr) = drakr(anze,ndr) 
      drbar(anze+1,ndr) = drbar(anze,ndr) 
      Rzuwdr(anze+1,ndr) = Rzuwdr(anze,ndr) 
      drmor(anze+1,ndr) = drmor(anze,ndr) 
   83 continue 
!                                                                       
      susn(anze+1) = susn(anze) 
      bettn(anze+1) = bettN(anze) 
      hFluN3(mstr,anze+1) = hFluN3(mstr,anze) 
      hJNO3(mstr,anze+1) = hJNO3(mstr,anze) 
      hJNH4(mstr,anze+1) = hJNH4(mstr,anze) 
      hJPO4(mstr,anze+1) = hJPO4(mstr,anze) 
      hJO2(mstr,anze+1) = hJO2(mstr,anze) 
      don(anze+1) = don(anze) 
      agrnh4(anze+1) = agrnh4(anze) 
      akinh4(anze+1) = akinh4(anze) 
      ablnh4(anze+1) = ablnh4(anze) 
      agrNO3(anze+1) = agrNO3(anze) 
      akiNO3(anze+1) = akiNO3(anze) 
      ablNO3(anze+1) = ablNO3(anze) 
      sedx0(anze+1) = sedx0(anze) 
      susno(anze+1) = susno(anze) 
      sedalg(anze+1) = sedalg(anze) 
      sedalk(anze+1) = sedalk(anze) 
      sedalb(anze+1) = sedalb(anze) 
      algzog(anze+1) = algzog(anze) 
      algzok(anze+1) = algzok(anze) 
      algzob(anze+1) = algzob(anze) 
      algdrg(anze+1) = algdrg(anze) 
      algdrk(anze+1) = algdrk(anze) 
      algdrb(anze+1) = algdrb(anze) 
      algcog(anze+1) = algcog(anze) 
      algcok(anze+1) = algcok(anze) 
      algcob(anze+1) = algcob(anze) 
      volfdr(anze+1) = volfdr(anze) 
      drpfec(anze+1) = drpfec(anze) 
      abeowg(anze+1) = abeowg(anze) 
      abeowk(anze+1) = abeowk(anze) 
      abeorg(anze+1) = abeorg(anze) 
      abeork(anze+1) = abeork(anze) 
      dalggr(anze+1) = dalggr(anze) 
      dalgki(anze+1) = dalgki(anze) 
      dalgbl(anze+1) = dalgbl(anze) 
      dalgag(anze+1) = dalgag(anze) 
      dalgak(anze+1) = dalgak(anze) 
      dalgab(anze+1) = dalgab(anze) 
      dgrmor(anze+1) = dgrmor(anze) 
      dkimor(anze+1) = dkimor(anze) 
      dblmor(anze+1) = dblmor(anze) 
      sgo2n(anze+1) = sgo2n(anze) 
      sdbsb(anze+1) = sdbsb(anze) 
      so2ein(anze+1) = so2ein(anze) 
      salgo(anze+1) = salgo(anze) 
      bsbt(anze+1) = bsbt(anze) 
      dalgo(anze+1) = dalgo(anze) 
      dalgao(anze+1) = dalgao(anze) 
      hschlr(mstr,anze+1) = hschlr(mstr,anze) 
      bsbbet(anze+1) = bsbbet(anze) 
      o2ein1(anze+1) = o2ein1(anze) 
      ro2dr(anze+1) = ro2dr(anze) 
      zooro2(anze+1) = zooro2(anze) 
      po2p(anze+1) = po2p(anze) 
      po2r(anze+1) = po2r(anze) 
      iras(anze+1) = iras(anze) 
      rmuas(anze+1) = rmuas(anze) 
      rakr(anze+1) = rakr(anze) 
      rbar(anze+1) = rbar(anze) 
      akmuea(anze+1) = akmuea(anze) 
      agmuea(anze+1) = agmuea(anze) 
      abmuea(anze+1) = abmuea(anze) 
      ftaaus(anze+1) = ftaaus(anze) 
      fiaus(anze+1) = fiaus(anze) 
      figaus(anze+1) = figaus(anze) 
      fibaus(anze+1) = fibaus(anze) 
      fheaus(anze+1) = fheaus(anze) 
      fhegas(anze+1) = fhegas(anze) 
      fhebas(anze+1) = fhebas(anze) 
      akraus(anze+1) = akraus(anze) 
      agreau(anze+1) = agreau(anze) 
      abreau(anze+1) = abreau(anze) 
      HNFmua(anze+1) = HNFmua(anze) 
      HNFrea(anze+1) = HNFrea(anze) 
      HNFupa(anze+1) = HNFupa(anze) 
      HNFmoa(anze+1) = HNFmoa(anze) 
      HNFexa(anze+1) = HNFexa(anze) 
      HNFdra(anze+1) = HNFdra(anze) 
      HNFza(anze+1) = HNFza(anze) 
      HNFBAC(anze+1) = HNFBAC(anze) 
      BACmua(anze+1) = BACmua(anze) 
      ffood(anze+1) = ffood(anze) 
      extk(anze+1) = extk(anze) 
!...hier auch Belegung für alle anderen Groessen!!!                     
!                                                                       
!..Buhnenfelder                                                         
      if(nbuhn(mstr).eq.0)goto 981 
      bzooi(mstr,anze+1) = bzooi(mstr,anze) 
      bvkigr(mstr,anze+1) = bvkigr(mstr,anze) 
      bchlak(mstr,anze+1) = bchlak(mstr,anze) 
      bchlag(mstr,anze+1) = bchlag(mstr,anze) 
      bchla(mstr,anze+1) = bchla(mstr,anze) 
      baki(mstr,anze+1) = baki(mstr,anze) 
      bagr(mstr,anze+1) = bagr(mstr,anze) 
      bbsb(mstr,anze+1) = bbsb(mstr,anze) 
      bcsb(mstr,anze+1) = bcsb(mstr,anze) 
      bvbsb(mstr,anze+1) = bvbsb(mstr,anze) 
      bvcsb(mstr,anze+1) = bvcsb(mstr,anze) 
      bbl01(mstr,anze+1) = bbl01(mstr,anze) 
      bbl02(mstr,anze+1) = bbl02(mstr,anze) 
      bCD(mstr,1,anze+1) = bCD(mstr,1,anze) 
      bCD(mstr,2,anze+1) = bCD(mstr,2,anze) 
      bCP(mstr,1,anze+1) = bCP(mstr,1,anze) 
      bCP(mstr,2,anze+1) = bCP(mstr,2,anze) 
      bCM(mstr,anze+1) = bCM(mstr,anze) 
      bBAC(mstr,anze+1) = bBAC(mstr,anze) 
      bO2BSB(mstr,anze+1) = bO2BSB(mstr,anze) 
      bfbsgr(mstr,anze+1) = bfbsgr(mstr,anze) 
      bfrfgr(mstr,anze+1) = bfrfgr(mstr,anze) 
      bx0(mstr,anze+1) = bx0(mstr,anze) 
      bx02(mstr,anze+1) = bx02(mstr,anze) 
      bnh4(mstr,anze+1) = bnh4(mstr,anze) 
      bno2(mstr,anze+1) = bno2(mstr,anze) 
      bno3(mstr,anze+1) = bno3(mstr,anze) 
      bnl0(mstr,anze+1) = bnl0(mstr,anze) 
      bgesN(mstr,anze+1) = bgesN(mstr,anze) 
      bmw(mstr,anze+1) = bmw(mstr,anze) 
      bpw(mstr,anze+1) = bpw(mstr,anze) 
      bca(mstr,anze+1) = bca(mstr,anze) 
      blf(mstr,anze+1) = blf(mstr,anze) 
      bph(mstr,anze+1) = bph(mstr,anze) 
      bstind(mstr,anze+1) = bstind(mstr,anze) 
      btempw(mstr,anze+1) = btempw(mstr,anze) 
      bgelp(mstr,anze+1) = bgelp(mstr,anze) 
      bpl0(mstr,anze+1) = bpl0(mstr,anze) 
      bgesP(mstr,anze+1) = bgesP(mstr,anze) 
      bsi(mstr,anze+1) = bsi(mstr,anze) 
      bo2(mstr,anze+1) = bo2(mstr,anze) 
      bss(mstr,anze+1) = bss(mstr,anze) 
      bssalg(mstr,anze+1) = bssalg(mstr,anze) 
      bfssgr(mstr,anze+1) = bfssgr(mstr,anze) 
!                                                                       
      bsvhek(mstr,anze+1) = bsvhek(mstr,anze) 
      bsvheg(mstr,anze+1) = bsvheg(mstr,anze) 
      bsvheb(mstr,anze+1) = bsvheb(mstr,anze) 
      bakbcm(mstr,anze+1) = bakbcm(mstr,anze) 
      bagbcm(mstr,anze+1) = bagbcm(mstr,anze) 
      babbcm(mstr,anze+1) = babbcm(mstr,anze) 
!hier Prozessraten                                                      
!                                                                       
      bdaki(mstr,anze+1) = bdaki(mstr,anze) 
      bdagr(mstr,anze+1) = bdagr(mstr,anze) 
      bdabl(mstr,anze+1) = bdabl(mstr,anze) 
      bdaak(mstr,anze+1) = bdaak(mstr,anze) 
      bdaag(mstr,anze+1) = bdaag(mstr,anze) 
      bdaab(mstr,anze+1) = bdaab(mstr,anze) 
      bsedak(mstr,anze+1) = bsedak(mstr,anze) 
      bsedag(mstr,anze+1) = bsedag(mstr,anze) 
      bsedab(mstr,anze+1) = bsedab(mstr,anze) 
      bazok(mstr,anze+1) = bazok(mstr,anze) 
      bazog(mstr,anze+1) = bazog(mstr,anze) 
      bazob(mstr,anze+1) = bazob(mstr,anze) 
      bdkmor(mstr,anze+1) = bdkmor(mstr,anze) 
      bdgmor(mstr,anze+1) = bdgmor(mstr,anze) 
      bdbmor(mstr,anze+1) = bdbmor(mstr,anze) 
      bvkigr(mstr,anze+1) = bvkigr(mstr,anze) 
      bantbl(mstr,anze+1) = bantbl(mstr,anze) 
      bakbcm(mstr,anze+1) = bakbcm(mstr,anze) 
      bir(mstr,anze+1) = bir(mstr,anze) 
      bsised(mstr,anze+1) = bsised(mstr,anze) 
      badrk(mstr,anze+1) = badrk(mstr,anze) 
      badrg(mstr,anze+1) = badrg(mstr,anze) 
      badrb(mstr,anze+1) = badrb(mstr,anze) 
      bacok(mstr,anze+1) = bacok(mstr,anze) 
      bacog(mstr,anze+1) = bacog(mstr,anze) 
      bacob(mstr,anze+1) = bacob(mstr,anze) 
!                                                                       
      bakmua(mstr,anze+1) = bakmua(mstr,anze) 
      bagmua(mstr,anze+1) = bagmua(mstr,anze) 
      babmua(mstr,anze+1) = babmua(mstr,anze) 
      bftaau(mstr,anze+1) = bftaau(mstr,anze) 
      bfiaus(mstr,anze+1) = bfiaus(mstr,anze) 
      bfigas(mstr,anze+1) = bfigas(mstr,anze) 
      bfibas(mstr,anze+1) = bfibas(mstr,anze) 
      bfheau(mstr,anze+1) = bfheau(mstr,anze) 
      bfhgau(mstr,anze+1) = bfhgau(mstr,anze) 
      bfhbau(mstr,anze+1) = bfhbau(mstr,anze) 
      bakrau(mstr,anze+1) = bakrau(mstr,anze) 
      bagrau(mstr,anze+1) = bagrau(mstr,anze) 
      babrau(mstr,anze+1) = babrau(mstr,anze) 
      btpki(mstr,anze+1) = btpki(mstr,anze) 
      btpgr(mstr,anze+1) = btpgr(mstr,anze) 
      btpbl(mstr,anze+1) = btpbl(mstr,anze) 
      bextk(mstr,anze+1) = bextk(mstr,anze) 
      bFluN3(mstr,anze+1) = bFluN3(mstr,anze) 
      bJNO3(mstr,anze+1) = bJNO3(mstr,anze) 
!                                                                       
!                                                                       
  981 dl(anze+1) = dl(anze) 
      if(nbuhn(mstr).gt.0)tau2(anze+1) = tau2(anze) 
!                                                                       
!                                                                       
!  Speichern von Informationen am Stranganfang und Strangende           
!                                                                       
!                                                                       
  793 ianze(mstr) = anze+1 
      inkzs(mstr,1) = nkzs(1) 
      inkzs(mstr,2) = nkzs(anze) 
      ikanz(1) = 1 
      ikanz(2) = ianze(mstr) 
!                                                                       
      if(iflRi(mstr).eq.-1)then 
      inkzs(mstr,1) = nkzs(anze) 
      inkzs(mstr,2) = nkzs(1) 
      ikanz(1) = ianze(mstr) 
      ikanz(2) = 1 
      endif 
!                                                                       
!                                                                       
!     Mittelwertbildung des ersten Knoten im Strang                     
!...Vertikale Konzentrationsverteilung wird der Konzentrationsverteilung
!     im neuen Zeitschritt gleichgesetzt                                
!                                                                       
!                                                                       
!      if(flag(anze).eq.5)goto 647                                      
      do 651 ke = 1,2 
      do 645 nkz = 1,inkzs(mstr,ke) 
      tzt(mstr,nkz,ke) = tempwz(nkz,ikanz(ke)) 
      o2zt(mstr,nkz,ke) = vo2z(nkz,ikanz(ke)) 
      NH4zt(mstr,nkz,ke) = vNH4z(nkz,ikanz(ke)) 
      NO2zt(mstr,nkz,ke) = vNO2z(nkz,ikanz(ke)) 
      NO3zt(mstr,nkz,ke) = vNO3z(nkz,ikanz(ke)) 
      Pzt(mstr,nkz,ke) = gelPz(nkz,ikanz(ke)) 
      gSizt(mstr,nkz,ke) = Siz(nkz,ikanz(ke)) 
      akizt(mstr,nkz,ke) = akiz(nkz,ikanz(ke)) 
      agrzt(mstr,nkz,ke) = agrz(nkz,ikanz(ke)) 
      ablzt(mstr,nkz,ke) = ablz(nkz,ikanz(ke)) 
      chlazt(mstr,nkz,ke) = chlaz(nkz,ikanz(ke)) 
  645 continue 
!                                                                       
      do 670 nkz = inkzs(mstr,ke),inkzmx 
      tzt(mstr,nkz,ke) = tempwz(inkzs(mstr,ke),ikanz(ke)) 
      o2zt(mstr,nkz,ke) = vo2z(inkzs(mstr,ke),ikanz(ke)) 
      NH4zt(mstr,nkz,ke) = vNH4z(inkzs(mstr,ke),ikanz(ke)) 
      NO2zt(mstr,nkz,ke) = vNO2z(inkzs(mstr,ke),ikanz(ke)) 
      NO3zt(mstr,nkz,ke) = vNO3z(inkzs(mstr,ke),ikanz(ke)) 
      Pzt(mstr,nkz,ke) = gelPz(inkzs(mstr,ke),ikanz(ke)) 
      gSizt(mstr,nkz,ke) = Siz(inkzs(mstr,ke),ikanz(ke)) 
      akizt(mstr,nkz,ke) = akiz(inkzs(mstr,ke),ikanz(ke)) 
      agrzt(mstr,nkz,ke) = agrz(inkzs(mstr,ke),ikanz(ke)) 
      ablzt(mstr,nkz,ke) = ablz(inkzs(mstr,ke),ikanz(ke)) 
      chlazt(mstr,nkz,ke) = chlaz(inkzs(mstr,ke),ikanz(ke)) 
  670 continue 
  651 continue 
      if(flag(anze).ne.5)goto 642 
!      goto 642                                                         
!                                                                       
!....Mittelwertbildung an Wehren                                        
  647 if(inkzs(mstr,2).eq.1)then 
      do 649 nkz = 1,inkzmx 
!      tzt(mstr,nkz,2) = tempwz(1,ikanz(2))                             
!      o2zt(mstr,nkz,2) = vo2z(1,ikanz(2))                              
      NH4zt(mstr,nkz,2) = vnh4z(1,ikanz(2)) 
      NO2zt(mstr,nkz,2) = vno2z(1,ikanz(2)) 
      NO3zt(mstr,nkz,2) = vno3z(1,ikanz(2)) 
      Pzt(mstr,nkz,2) = gelPz(1,ikanz(2)) 
      gSizt(mstr,nkz,2) = Siz(1,ikanz(2)) 
      akizt(mstr,nkz,2) = akiz(1,ikanz(2)) 
      agrzt(mstr,nkz,2) = agrz(1,ikanz(2)) 
      ablzt(mstr,nkz,2) = ablz(1,ikanz(2)) 
      chlazt(mstr,nkz,2) = chlaz(1,ikanz(2)) 
  649 continue 
      goto 642 
      endif 
!                                                                       
      sO2 = 0.0 
      sn4 = 0.0 
      sN2 = 0.0 
      sN3 = 0.0 
      sumT = 0.0 
      sumP = 0.0 
      sSi = 0.0 
      ski = 0.0 
      sgr = 0.0 
      sbl = 0.0 
      schl = 0.0 
      sumH = 0.0 
      do 648 nkz = 1,inkzs(mstr,2)-1 
!      sO2 = sO2+((vo2z(nkz,ikanz(2))+vo2z(nkz+1,ikanz(2)))/2.)         
!     **dH2D                                                            
      sN4 = sN4+((vNH4z(nkz,ikanz(2))+vNH4z(nkz+1,ikanz(2)))/2.)        &
     &*dH2D                                                             
      sN2 = sN2+((vNO2z(nkz,ikanz(2))+vNO2z(nkz+1,ikanz(2)))/2.)        &
     &*dH2D                                                             
      sN3 = sN3+((vNO3z(nkz,ikanz(2))+vNO3z(nkz+1,ikanz(2)))/2.)        &
     &*dH2D                                                             
!      sumT = sumT+((tempwz(nkz,ikanz(2))+tempwz(nkz+1,ikanz(2)))       
!     */2.)*dH2D                                                        
      sumP = sumP+((gelPz(nkz,ikanz(2))+gelPz(nkz+1,ikanz(2)))/2.)      &
     &*dH2D                                                             
      sSi = sSi+((Siz(nkz,ikanz(2))+Siz(nkz+1,ikanz(2)))/2.)*dH2D 
      ski = ski+((akiz(nkz,ikanz(2))+akiz(nkz+1,ikanz(2)))/2.)          &
     &*dH2D                                                             
      sgr = sgr+((agrz(nkz,ikanz(2))+agrz(nkz+1,ikanz(2)))/2.)          &
     &*dH2D                                                             
      sbl = sbl+((ablz(nkz,ikanz(2))+ablz(nkz+1,ikanz(2)))/2.)          &
     &*dH2D                                                             
      schl = schl+((chlaz(nkz,ikanz(2))+chlaz(nkz+1,ikanz(2)))/2.)      &
     &*dH2D                                                             
      sumH = sumH+dH2D 
  648 continue 
!                                                                       
      do 646 nkz = 1,inkzmx 
!      tzt(mstr,nkz,2) = sumT/SumH                                      
!      o2zt(mstr,nkz,2) = sO2/SumH                                      
      NH4zt(mstr,nkz,2) = sN4/SumH 
      NO2zt(mstr,nkz,2) = sN2/SumH 
      NO3zt(mstr,nkz,2) = sN3/SumH 
      Pzt(mstr,nkz,2) = sumP/sumH 
      gSizt(mstr,nkz,2) = sSi/sumH 
      akizt(mstr,nkz,2) = ski/sumH 
      agrzt(mstr,nkz,2) = sgr/sumH 
      ablzt(mstr,nkz,2) = sbl/sumH 
      chlazt(mstr,nkz,2) = schl/sumH 
  646 continue 
!                                                                       
!                                                                       
  642 continue 
!                                                                       
!....Umspeichern der neu berechneten Daten                              
!....Bei Rueckstroemung                                                 
      if(iFlRi(mstr).eq.(-1.))then 
      jR = hanze(mstr)+2 
      istep = -1 
      endif 
!                                                                       
      if(iFlRi(mstr).gt.(-1.))then 
      jR = 0 
      istep = 1 
      endif 
!                                                                       
!                                                                       
  908 continue 
      do 557 ior = 1,hanze(mstr)+1 
!                                                                       
      jR = jR+istep 
      hfkm(mstr,ior) = fkm(jR) 
      hsvhk(mstr,ior) = svhemk(jR) 
      hsvhg(mstr,ior) = svhemg(jR) 
      hsvhb(mstr,ior) = svhemb(jR) 
      hDOSCF(mstr,ior) = DOSCF(jR) 
      hakbcm(mstr,ior) = akbcm(jR) 
      hagbcm(mstr,ior) = agbcm(jR) 
      habbcm(mstr,ior) = abbcm(jR) 
      hfssgr(mstr,ior) = fssgr(jR) 
      hfbsgr(mstr,ior) = fbsgr(jR) 
      hfrfgr(mstr,ior) = frfgr(jR) 
      hnl0(mstr,ior) = nl0(jR) 
      hpl0(mstr,ior) = pl0(jR) 
      hQ_NK(mstr,ior) = Q_NK(jR) 
      hQ_PK(mstr,ior) = Q_PK(jR) 
      hQ_SK(mstr,ior) = Q_SK(jR) 
      hQ_NG(mstr,ior) = Q_NG(jR) 
      hQ_PG(mstr,ior) = Q_PG(jR) 
      hQ_NB(mstr,ior) = Q_NB(jR) 
      hQ_PB(mstr,ior) = Q_PB(jR) 
      htempw(mstr,ior) = tempw(jR) 
      hTsed(mstr,ior) = Tsed(jR) 
      hbsb(mstr,ior) = obsb(jR) 
      hcsb(mstr,ior) = ocsb(jR) 
!                                                                       
      hCHNF(mstr,ior) = CHNF(jR) 
      hBVHNF(mstr,ior) = BVHNF(jR) 
      hCD(mstr,1,ior) = CD(1,jR) 
      hCD(mstr,2,ior) = CD(2,jR) 
      hCP(mstr,1,ior) = CP(1,jR) 
      hCP(mstr,2,ior) = CP(2,jR) 
      hCM(mstr,ior) = CM(jR) 
      hBAC(mstr,ior) = BAC(jR) 
      hO2BSB(mstr,ior) = O2BSB(jR) 
      hbl01(mstr,ior) = bl01(jR) 
      hbl02(mstr,ior) = bl02(jR) 
!                                                                       
      hnh4(mstr,ior) = vnh4(jR) 
      ho2(mstr,ior) = vo2(jR) 
      hno3(mstr,ior) = vno3(jR) 
      hno2(mstr,ior) = vno2(jR) 
      hgesN(mstr,ior) = gesN(jR) 
      hx0(mstr,ior) = vx0(jR) 
      hx02(mstr,ior) = vx02(jR) 
      hsi(mstr,ior) = si(jR) 
      hchla(mstr,ior) = chla(jR) 
      haki(mstr,ior) = aki(jR) 
      hagr(mstr,ior) = agr(jR) 
      habl(mstr,ior) = abl(jR) 
      hchlak(mstr,ior) = chlaki(jR) 
      hchlag(mstr,ior) = chlagr(jR) 
      hchlab(mstr,ior) = chlabl(jR) 
      hvkigr(mstr,ior) = vkigr(jR) 
      hantbl(mstr,ior) = antbl(jR) 
      htpki(mstr,ior) = tpki(jR) 
      htpgr(mstr,ior) = tpgr(jR) 
      htpbl(mstr,ior) = tpbl(jR) 
      habrz1(mstr,ior) = abrzo1(jR) 
      hssalg(mstr,ior) = ssalg(jR) 
      hss(mstr,ior) = ss(jR) 
      hzooi(mstr,ior) = zooind(jR) 
      hgelp(mstr,ior) = gelp(jR) 
      hgesP(mstr,ior) = gesP(jR) 
      hmw(mstr,ior) = mw(jR) 
      hpw(mstr,ior) = pw(jR) 
      hca(mstr,ior) = ca(jR) 
      hlf(mstr,ior) = lf(jR) 
      hcoli(mstr,ior) = coli(jR) 
      hdlarn(mstr,ior) = dlarvn(jR) 
      hph(mstr,ior) = vph(jR) 
      hvbsb(mstr,ior) = vbsb(jR) 
      hvcsb(mstr,ior) = vcsb(jR) 
      hstind(mstr,ior) = stind(jR) 
!                                                                       
      hpfmnl(mstr,ior) = pflmin(jR) 
      hpfmxl(mstr,ior) = pflmax(jR) 
      hpfl(mstr,ior) = pfl(jR) 
      hischf(mstr,ior) = ischif(jR) 
      do 664 ndr = 1,nndr 
      hzdrel(mstr,ior,ndr) = zdrei(jR,ndr) 
      hzdrsl(mstr,ior,ndr) = zdreis(jR,ndr) 
  664 hgwdrl(mstr,ior,ndr) = gewdr(jR,ndr) 
      hdlmx(mstr,ior) = dlmax(jR) 
      hdlmxs(mstr,ior) = dlmaxs(jR) 
      hgwdmx(mstr,ior) = gwdmax(jR) 
      hsgwmu(mstr,ior) = sgwmue(jR) 
      habgml(mstr,ior) = abegm2(jR) 
      habkml(mstr,ior) = abekm2(jR) 
      do 665 ico = 1,5 
      hcoro2(mstr,ior,ico) = coro(jR,ico) 
  665 hcos2(mstr,ior,ico) = coros(jR,ico) 
!                                                                       
!.....Ufervegetation                                                    
      Do 851 iV = 1,14 
  851 VTYPH(mstr,ior,iV) = VTYP(jR,iV) 
      VALTLH(mstr,ior) = VALTBL(jR) 
      EDUFLH(mstr,ior) = EDUFBL(jR) 
      VALTRH(mstr,ior) = VALTBR(jR) 
      EDUFRH(mstr,ior) = EDUFBR(jR) 
!                                                                       
      if(ieros.eq.0)goto 467 
!....Umdrehen der Sedimentgroessen                                      
      sedhg(mstr,ior) = sedh(jR) 
      ischig(mstr,ior) = ischic(jR) 
      do 466 itau = 1,50 
  466 tauscg(mstr,ior,itau) = tausc(jR,itau) 
!                                                                       
!     Prozessraten                                                      
!                                                                       
  467 continue 
      do 181 ndr=1,nndr 
      hidras(mstr,ior,ndr) = idras(jR,ndr) 
      hdrmas(mstr,ior,ndr) = drmas(jR,ndr) 
      hdrakr(mstr,ior,ndr) = drakr(jR,ndr) 
      hdrbar(mstr,ior,ndr) = drbar(jR,ndr) 
      hRzuwd(mstr,ior,ndr) = Rzuwdr(jR,ndr) 
      hdrmor(mstr,ior,ndr) = drmor(jR,ndr) 
  181 continue 
!                                                                       
      hsusn(mstr,ior) = susn(jR) 
      hbettN(mstr,ior) = bettn(jR) 
      hdon(mstr,ior) = don(jR) 
      hagnh4(mstr,ior) = agrnh4(jR) 
      haknh4(mstr,ior) = akinh4(jR) 
      habnh4(mstr,ior) = ablnh4(jR) 
      halNO3(mstr,ior) = agrNO3(jR)+akiNO3(jR)+ablNO3(jR) 
      hsedx0(mstr,ior) = sedx0(jR) 
      hsusno(mstr,ior) = susno(jR) 
      hsedag(mstr,ior) = sedalg(jR) 
      hsedak(mstr,ior) = sedalk(jR) 
      hsedab(mstr,ior) = sedalb(jR) 
      halgzg(mstr,ior) = algzog(jR) 
      halgzk(mstr,ior) = algzok(jR) 
      halgzb(mstr,ior) = algzob(jR) 
      halgdg(mstr,ior) = algdrg(jR) 
      halgdk(mstr,ior) = algdrk(jR) 
      halgdb(mstr,ior) = algdrb(jR) 
      halgcg(mstr,ior) = algcog(jR) 
      halgck(mstr,ior) = algcok(jR) 
      halgcb(mstr,ior) = algcob(jR) 
      hvolfd(mstr,ior) = volfdr(jR) 
      hdrpfe(mstr,ior) = drpfec(jR) 
      habowg(mstr,ior) = abeowg(jR) 
      habowk(mstr,ior) = abeowk(jR) 
      haborg(mstr,ior) = abeorg(jR) 
      habork(mstr,ior) = abeork(jR) 
      hdalgg(mstr,ior) = dalggr(jR) 
      hdalgk(mstr,ior) = dalgki(jR) 
      hdalgb(mstr,ior) = dalgbl(jR) 
      hdalag(mstr,ior) = dalgag(jR) 
      hdalak(mstr,ior) = dalgak(jR) 
      hdalab(mstr,ior) = dalgab(jR) 
      hdgmor(mstr,ior) = dgrmor(jR) 
      hdkmor(mstr,ior) = dkimor(jR) 
      hdbmor(mstr,ior) = dblmor(jR) 
      hsgo2n(mstr,ior) = sgo2n(jR) 
      hsdbsb(mstr,ior) = sdbsb(jR) 
      hsoein(mstr,ior) = so2ein(jR) 
      hsalgo(mstr,ior) = salgo(jR) 
      hbsbt(mstr,ior)  = bsbt(jR) 
      hdalgo(mstr,ior) = dalgo(jR) 
      hdalao(mstr,ior) = dalgao(jR) 
      hSedOM(mstr,ior) = hSedOM(mstr,jR) 
      hw2(mstr,ior) = hw2(mstr,jR) 
      hdkorn(mstr,ior) = hdkorn(mstr,jR) 
      hbsbbe(mstr,ior) = bsbbet(jR) 
      hoein1(mstr,ior) = o2ein1(jR) 
      hro2dr(mstr,ior) = ro2dr(jR) 
      hzoro2(mstr,ior) = zooro2(jR) 
      hpo2p(mstr,ior) = po2p(jR) 
      hpo2r(mstr,ior) = po2r(jR) 
      hiras(mstr,ior) = iras(jR) 
      hrmuas(mstr,ior) = rmuas(jR) 
      hrakr(mstr,ior) = rakr(jR) 
      hrbar(mstr,ior) = rbar(jR) 
      hkmuea(mstr,ior) = akmuea(jR) 
      hgmuea(mstr,ior) = agmuea(jR) 
      hbmuea(mstr,ior) = abmuea(jR) 
      hftaau(mstr,ior) = ftaaus(jR) 
      hfiaus(mstr,ior) = fiaus(jR) 
      hfigau(mstr,ior) = figaus(jR) 
      hfibau(mstr,ior) = fibaus(jR) 
      hfheau(mstr,ior) = fheaus(jR) 
      hfhega(mstr,ior) = fhegas(jR) 
      hfheba(mstr,ior) = fhebas(jR) 
      hakrau(mstr,ior) = akraus(jR) 
      hagrau(mstr,ior) = agreau(jR) 
      habrau(mstr,ior) = abreau(jR) 
      hHNFmu(mstr,ior) = HNFmua(jR) 
      hHNFre(mstr,ior) = HNFrea(jR) 
      hHNFup(mstr,ior) = HNFupa(jR) 
      hHNFmo(mstr,ior) = HNFmoa(jR) 
      hHNFex(mstr,ior) = HNFexa(jR) 
      hHNFdr(mstr,ior) = HNFdra(jR) 
      hHNFza(mstr,ior) = HNFza(jR) 
      hHNFBA(mstr,ior) = HNFBAC(jR) 
      hBAmua(mstr,ior) = BACmua(jR) 
      hffood(mstr,ior) = ffood(jR) 
      hextk(mstr,ior) = extk(jR) 
      hSKmor(mstr,ior) = SKmor(jR) 
      hJNO3(mstr,ior) = hJNO3(mstr,jR) 
      hJNH4(mstr,ior) = hJNH4(mstr,jR) 
      hJPO4(mstr,ior) = hJPO4(mstr,jR) 
      hJO2(mstr,ior) = hJO2(mstr,jR) 
!                                                                       
      hdl(mstr,ior) = dl(jR) 
      htiefe(mstr,ior) = tiefe(jR) 
!                                                                       
!....nur Tracer                                                         
!  2D-Modellierung                                                      
      hnkzs(mstr,ior) = nkzs(jR) 
      hdH2de(mstr,ior) = dH2De(jR) 
      if(iwsim.eq.4)goto 704 
      do 814 nkz=1,nkzs(jR) 
      htempz(mstr,nkz,ior) = tempwz(nkz,jR) 
      hnh4z(mstr,nkz,ior) = vnh4z(nkz,jR) 
      hno2z(mstr,nkz,ior) = vno2z(nkz,jR) 
      hno3z(mstr,nkz,ior) = vno3z(nkz,jR) 
      ho2z(mstr,nkz,ior) = vo2z(nkz,jR) 
      hgelPz(mstr,nkz,ior) = gelPz(nkz,jR) 
      hSiz(mstr,nkz,ior) = Siz(nkz,jR) 
      hakiz(mstr,nkz,ior) = akiz(nkz,jR) 
      hagrz(mstr,nkz,ior) = agrz(nkz,jR) 
      hablz(mstr,nkz,ior) = ablz(nkz,jR) 
      hchlaz(mstr,nkz,ior) = chlaz(nkz,jR) 
  814 continue 
!                                                                       
!                                                                       
  704 continue 
      znkzs(mstr,ior) = hnkzs(mstr,ior) 
!                                                                       
  557 continue 
!                                                                       
!....Umdrehen der Strecken mit Linieneinleiter                          
      if(iflRi(mstr).eq.-1)then 
      ieinL = 0 
      do 677 kein=ieinLs(mstr),1,-1 
      ieinL = ieinL+1 
      iorLa(ieinL) = anze+1-iorLeh(mstr,kein) 
  677 iorLe(ieinL) = anze+1-iorLah(mstr,kein) 
      endif 
!                                                                       
!                                                                       
!.....Ende Strangschleife                                               
 8888 continue 
!                                                                       
 7777 continue 
! iwied = 0 : allererster Zeitschritt, danach iwied = 1                 
! ilang = 0 : Vorlauf (1d) wird nicht abgelegt, danach ilang = 1        
      if(iwied.eq.0)then 
      itagv = itags 
      monatv = monats 
      jahrv = jahrs 
      iwied = 1 
      endif 
!                                                                       
      if(jlauf.eq.0)then 
!....Berechnung der neuen Uhrzeit und des neuen Datums                  
      Uhrz = Uhrz+tflie*24. 
      if((24.-Uhrz).lt.0.0001)Uhrz = 24. 
      if(Uhrz.ge.24.)then 
      Uhrz = Uhrz-24. 
      if(jtag.ne.1)itags = itags+1 
      endif 
!                                                                       
      call anztag(monats,jahrs,jtage) 
      if(itags.gt.jtage)then 
      itags = 1 
      monats = monats+1 
      endif 
      if(monats.gt.12)then 
      monats = 1. 
      jahrs = jahrs+1 
      endif 
       endif 
!....Ende Datumsberechnung                                              
!                                                                       
!....Vorlauf ilang = 0; Werte werden nicht abgelegt!!                   
      if(ilang.eq.0.and.ij.lt.itime)then 
      ij = ij+1 
      istr = 0 
      goto 9191 
      endif 
                                                                        
      if(ilang.eq.0.and.ij.eq.itime)then 
      itags = itagv 
      monats = monatv 
      jahrs = jahrv 
      itime = itimea 
      ianfan = 1 
      ij = 1 
      rewind(110) 
      read(110,'(A40)')MODNAME 
      read(110,'(A40)')ERENAME 
!                                                                       
      rewind (97) 
      read(97,'(A40)')MODNAME 
      read(97,'(A40)')ERENAME 
      endif 
                                                                      
                                                                     
      if(ij.eq.1.and.jlauf.eq.0)then 
      if(itags.eq.itage.and.monats.eq.monate.and.jahrs.eq.jahre)        &
     &itime = itimee                                                    
       endif 
!                                                                       
      if(ilang.eq.1.and.jlauf.eq.0)then 
      call funkstar(abfls,vbsbs,vcsbs,vnh4s,vno2s,vno3s,gesNs           &
     &,vx0s,vx02s,gelps,gesPs,sis,chlas,vkigrs,antbls,zooins            &
     &,vphs,mws,cas,lfs,ssalgs,tempws,vo2s                              &
     &,CHNFs,BVHNFs,colis,waers,istund,uhrz,RBtyp,NRSCHr                &
     &,itags,monats,jahrs,cpfad,iwsim,ilang,iwied,mstrRB)               
      jlauf = 1 
      istr = 0 
      goto 9191 
      endif 
!                                                                       
      if(ilang.eq.0)then 
      ilang = 1 
      jtag = 1 
      goto 9999 
      endif 
!                                                                       
      if(jlauf.eq.1)then 
      ij = ij+1 
      jlauf = 0 
      jtag = 0 
      hconU = abs(uhren-uhrz) 
      if(hconU.lt.0.001)Uhrz = uhren 
      if(itags.eq.itage.and.monats.eq.monate.and.jahrs.eq.jahre         &
     &.and.uhren.eq.uhrz.and.ilang.eq.1)iend = 1                        
      endif 
!                                                                       
      if(ij.gt.itime)then
!      if(itime.eq.itimea)itime = itimeh 
      maus = 1 
      endif 
!                                                                       
!     *********************************************************         
!                                                                       
!     Summenbildung Minimum und Maximum beim Hauptlauf                  
!     Ausschreiben von Ergebnissen                                      
      if(ij.gt.2)goto 247 
!                                                                       
      do 94 azStr = 1,azStrs 
      mstr = mstra(azStr) 
      do 91 ior=1,mStas(mstr) 
      mitemp(mstr,ior) = 999999.9 
      mxtemp(mstr,ior) = 0.0 
      minh4(mstr,ior) = 999999.9 
      mxnh4(mstr,ior) = 0.0 
      migsP(mstr,ior) = 99999.9 
      migsN(mstr,ior) = 99999.9 
      mxgsP(mstr,ior) = 0.0 
      mxgsN(mstr,ior) = 0.0 
      mib5(mstr,ior) = 999999.9 
      mxb5(mstr,ior) = 0.0 
      mics(mstr,ior) = 999999.9 
      mxcs(mstr,ior) = 0.0 
      michla(mstr,ior) = 9999999.9 
      mxchla(mstr,ior) = 0.0 
      miaki(mstr,ior) = 999999.9 
      mxaki(mstr,ior) = 0.0 
      miagr(mstr,ior) = 999999.9 
      mxagr(mstr,ior) = 0.0 
      miabl(mstr,ior) = 999999.9 
      mxabl(mstr,ior) = 0.0 
      mio2(mstr,ior) = 9999999.9 
      mxo2(mstr,ior) = 0.0 
      mizo(mstr,ior) = 99999999.9 
      mxzo(mstr,ior) = 0.0 
      mivph(mstr,ior) = 9999999.9 
      mxvph(mstr,ior) = 0.0 
      mivno3(mstr,ior) = 999999.9 
      mxvno3(mstr,ior) = 0.0 
      migp(mstr,ior) = 999999.9 
      mxgp(mstr,ior) = 0.0 
      misi(mstr,ior) = 999999.9 
      mxsi(mstr,ior) = 0.0 
      mivno2(mstr,ior) = 999999.9 
      mxvno2(mstr,ior) = 0.0 
      mica(mstr,ior) = 9999999.9 
      mxca(mstr,ior) = 0.0 
      mimw(mstr,ior) = 999999.9 
      mxmw(mstr,ior) = 0.0 
      milf(mstr,ior) = 999999.9 
      mxlf(mstr,ior) = 0.0 
      micoli(mstr,ior) = 999999.9 
      mxcoli(mstr,ior) = 0.0 
      midlan(mstr,ior) = 99999999.9 
      mxdlan(mstr,ior) = 0.0 
      miSS(mstr,ior) = 99999999.9 
      mxSS(mstr,ior) = 0.0 
!                                                                       
      if(nbuhn(mstr).eq.1)then 
!      Buhnenfelder                                                     
!                                                                       
      bmxtem(mstr,ior) = 0.0 
      bmitem(mstr,ior) = 9999999.9 
      bmxno3(mstr,ior) = 0.0 
      bmino3(mstr,ior) = 999999.9 
      bmxno2(mstr,ior) = 0.0 
      bmino2(mstr,ior) = 999999.9 
      bmxnh4(mstr,ior) = 0.0 
      bminh4(mstr,ior) = 999999.9 
      bmxbsb(mstr,ior) = 0.0 
      bmibsb(mstr,ior) = 999999.9 
      bmxcsb(mstr,ior) = 0.0 
      bmicsb(mstr,ior) = 999999.9 
      bmxglp(mstr,ior) = 0.0 
      bmiglp(mstr,ior) = 999999.9 
      bmxchl(mstr,ior) = 0.0 
      bmichl(mstr,ior) = 9999999.9 
      bmxssa(mstr,ior) = 0.0 
      bmissa(mstr,ior) = 999999.9 
      bmxsi(mstr,ior) = 0.0 
      bmisi(mstr,ior) = 9999999.9 
      bmxzoo(mstr,ior) = 0.0 
      bmizoo(mstr,ior) = 9999999.9 
      bmxgsP(mstr,ior) = 0.0 
      bmigsP(mstr,ior) = 9999999.9 
      bmxgsN(mstr,ior) = 0.0 
      bmigsN(mstr,ior) = 9999999.9 
      bmxaki(mstr,ior) = 0.0 
      bmiaki(mstr,ior) = 9999999.9 
      bmxagr(mstr,ior) = 0.0 
      bmiagr(mstr,ior) = 9999999.9 
      bmxo2(mstr,ior) = 0.0 
      bmio2(mstr,ior) = 9999999.9 
      bmxmw(mstr,ior) = 0.0 
      bmimw(mstr,ior) = 9999999.9 
      bmxlf(mstr,ior) = 0.0 
      bmilf(mstr,ior) = 9999999.9 
      bmxca(mstr,ior) = 0.0 
      bmica(mstr,ior) = 9999999.9 
      bmxph(mstr,ior) = 0.0 
      bmiph(mstr,ior) = 9999999.9 
!                                                                       
      endif 
!                                                                       
!.....Null setzen der Summen fr Mittelwertberechnung der Ausgaben      
!                                                                       
      sumte(mstr,ior) = 0.0 
      sCHNF(mstr,ior) = 0.0 
      sBVHNF(mstr,ior) = 0.0 
      sCD(mstr,1,ior) = 0.0 
      sCD(mstr,2,ior) = 0.0 
      sCP(mstr,1,ior) = 0.0 
      sCP(mstr,2,ior) = 0.0 
      sCM(mstr,ior) = 0.0 
      sBAC(mstr,ior) = 0.0 
      sgsP(mstr,ior) = 0.0 
      sgsN(mstr,ior) = 0.0 
      sumb5(mstr,ior) = 0.0 
      sumcs(mstr,ior) = 0.0 
      sumn4(mstr,ior) = 0.0 
      sumo2(mstr,ior) = 0.0 
      sumca(mstr,ior) = 0.0 
      sumcak(mstr,ior) = 0.0 
      sumcag(mstr,ior) = 0.0 
      sumcab(mstr,ior) = 0.0 
      svkigr(mstr,ior) = 0.0 
      santbl(mstr,ior) = 0.0 
      sumaki(mstr,ior) = 0.0 
      sumagr(mstr,ior) = 0.0 
      sumabl(mstr,ior) = 0.0 
      sumzo(mstr,ior) = 0.0 
      sumvph(mstr,ior) = 0.0 
      sumno3(mstr,ior) = 0.0 
      sumno2(mstr,ior) = 0.0 
      sumgp(mstr,ior) = 0.0 
      sumsi(mstr,ior) = 0.0 
      summsl(mstr,ior) = 0.0 
      sumcal(mstr,ior) = 0.0 
      summw(mstr,ior) = 0.0 
      sumlf(mstr,ior) = 0.0 
      scoli(mstr,ior) = 0.0 
      sumdln( mstr,ior) = 0.0 
!....Dreissena                                                          
      do 836 ndr=1,nndr 
      sidras(mstr,ior,ndr) = 0.0 
      sdrmas(mstr,ior,ndr) = 0.0 
      sdrakr(mstr,ior,ndr) = 0.0 
      sdrbar(mstr,ior,ndr) = 0.0 
      sdrmor(mstr,ior,ndr) = 0.0 
      szdrg(mstr,ior,ndr) = 0.0 
      szdrsg(mstr,ior,ndr) = 0.0 
  836 sgwdrg(mstr,ior,ndr) = 0.0 
!                                                                       
      scorIg(mstr,ior) = 0.0 
      scoIsg(mstr,ior) = 0.0 
!                                                                       
      sumpfl(mstr,ior) = 0.0 
      sumss(mstr,ior) = 0.0 
      sumbal(mstr,ior) = 0.0 
!                                                                       
!.....Raten                                                             
!                                                                       
      ssusn(mstr,ior) = 0.0 
      sbettn(mstr,ior) = 0.0 
      sdon(mstr,ior) = 0.0 
      salgn(mstr,ior) = 0.0 
      salNO3(mstr,ior) = 0.0 
      sFluN3(mstr,ior) = 0.0 
      sJNO3(mstr,ior) = 0.0 
      sJNH4(mstr,ior) = 0.0 
      sJPO4(mstr,ior) = 0.0 
      sJO2(mstr,ior) = 0.0 
      svx0(mstr,ior) = 0.0 
      svx02(mstr,ior) = 0.0 
      ssedx0(mstr,ior) = 0.0 
      ssusno(mstr,ior) = 0.0 
      ssedal(mstr,ior) = 0.0 
      salgzo(mstr,ior) = 0.0 
      salgdr(mstr,ior) = 0.0 
      salgco(mstr,ior) = 0.0 
      svoldr(mstr,ior) = 0.0 
      sdrpfe(mstr,ior) = 0.0 
      sabeow(mstr,ior) = 0.0 
      sabeor(mstr,ior) = 0.0 
      sdalg(mstr,ior) = 0.0 
      sdalga(mstr,ior) = 0.0 
      salmor(mstr,ior) = 0.0 
      sblmor(mstr,ior) = 0.0 
      ssgo2n(mstr,ior) = 0.0 
      ssdbsb(mstr,ior) = 0.0 
      ssoein(mstr,ior) = 0.0 
      ssalgo(mstr,ior) = 0.0 
      sbsbt(mstr,ior) = 0.0 
      s2algo(mstr,ior) = 0.0 
      s2algao(mstr,ior) = 0.0 
      sschlr(mstr,ior) = 0.0 
      sbsbbe(mstr,ior) = 0.0 
      so2phy(mstr,ior) = 0.0 
      sro2dr(mstr,ior) = 0.0 
      szooro(mstr,ior) = 0.0 
      spo2p(mstr,ior) = 0.0 
      spo2r(mstr,ior) = 0.0 
      sir(mstr,ior) = 0.0 
      srmue(mstr,ior) = 0.0 
      srakr(mstr,ior) = 0.0 
      srbar(mstr,ior) = 0.0 
      sffood(mstr,ior) = 0.0 
      sfik(mstr,ior) = 0.0 
      sfig(mstr,ior) = 0.0 
      sfib(mstr,ior) = 0.0 
      sakmua(mstr,ior) = 0.0 
      sagmua(mstr,ior) = 0.0 
      sabmua(mstr,ior) = 0.0 
      sfheka(mstr,ior) = 0.0 
      sfhega(mstr,ior) = 0.0 
      sfheba(mstr,ior) = 0.0 
      sakrau(mstr,ior) = 0.0 
      sagrea(mstr,ior) = 0.0 
      sabrea(mstr,ior) = 0.0 
      sHNFmu(mstr,ior) = 0.0 
      sHNFre(mstr,ior) = 0.0 
      sHNFup(mstr,ior) = 0.0 
      sHNFmo(mstr,ior) = 0.0 
      sHNFex(mstr,ior) = 0.0 
      sHNFdr(mstr,ior) = 0.0 
      sHNFz(mstr,ior) = 0.0 
      sBACmu(mstr,ior) = 0.0 
      sHNFBA(mstr,ior) = 0.0 
      snl0(mstr,ior) = 0.0 
      spl0(mstr,ior) = 0.0 
      snaehr(mstr,ior) = 0.0 
!                                                                       
!                                                                       
!     Buhnenfelder                                                      
!                                                                       
      if(nbuhn(mstr).eq.1)then 
      bste(mstr,ior) = 0.0 
      bsno3(mstr,ior) = 0.0 
      bsno2(mstr,ior) = 0.0 
      bsn4(mstr,ior) = 0.0 
      bsgelp(mstr,ior) = 0.0 
      bschla(mstr,ior) = 0.0 
      bsaki(mstr,ior) = 0.0 
      bsagr(mstr,ior) = 0.0 
      bsabl(mstr,ior) = 0.0 
      bsssal(mstr,ior) = 0.0 
      bssi(mstr,ior) = 0.0 
      bszooi(mstr,ior) = 0.0 
      bsvbsb(mstr,ior) = 0.0 
      bsvcsb(mstr,ior) = 0.0 
      bsgsP(mstr,ior) = 0.0 
      bsgsN(mstr,ior) = 0.0 
      bso2(mstr,ior) = 0.0 
      bsmw(mstr,ior) = 0.0 
      bslf(mstr,ior) = 0.0 
      bsca(mstr,ior) = 0.0 
      bsph(mstr,ior) = 0.0 
      bsnl0(mstr,ior) = 0.0 
      bspl0(mstr,ior) = 0.0 
!                                                                       
!......Raten                                                            
!                                                                       
      bsdalg(mstr,ior) = 0.0 
      bsvkg(mstr,ior) = 0.0 
      bsdaa(mstr,ior) = 0.0 
      bsseda(mstr,ior) = 0.0 
      bsalgz(mstr,ior) = 0.0 
      bsamor(mstr,ior) = 0.0 
      bsadr(mstr,ior) = 0.0 
!...Pseudofaces = 0.0 da keine Dreissena in Buhnenfeld                  
      bsalco(mstr,ior) = 0.0 
      bsfik(mstr,ior) = 0.0 
      bsfig(mstr,ior) = 0.0 
      bskmue(mstr,ior) = 0.0 
      bsgmue(mstr,ior) = 0.0 
      bsbmue(mstr,ior) = 0.0 
      bshek(mstr,ior) = 0.0 
      bsheg(mstr,ior) = 0.0 
      bskre(mstr,ior) = 0.0 
      bsgre(mstr,ior) = 0.0 
      bsbre(mstr,ior) = 0.0 
      bschlk(mstr,ior) = 0.0 
      bschlg(mstr,ior) = 0.0 
      bschlb(mstr,ior) = 0.0 
      bnaehr(mstr,ior) = 0.0 
      bsFlN3(mstr,ior) = 0.0 
      bsbetN(mstr,ior) = 0.0 
      bsJNO3(mstr,ior) = 0.0 
      endif 
!                                                                       
   91 continue 
   94 continue 
!                                                                       
  247 continue 
!                                                                       
!                                                                       
!**************************************************                     
!     Belegung des Ausgabegitters                                       
!**************************************************                     
!                                                                       
!                                                                       
 4545 continue 
!                                                                       
      if(iergeb.eq.1)goto 190 
      open(unit=45, DEFAULTFILE=cpfad, file='ERGEBM.txt') 
      open(unit=155, DEFAULTFILE=cpfad, file='ERGEBT.txt') 
      open(unit=255, DEFAULTFILE=cpfad, file='ERGEB2D.txt') 
      write(45,'(a50)')modell 
      write(45,'(a50)')versio 
      write(45,'(a50)')cEreig 
      write(155,'(a50)')modell 
      write(155,'(a50)')versio 
      write(155,'(a50)')cEreig 
      write(255,'(a50)')modell 
      write(255,'(a50)')versio 
      write(255,'(a50)')cEreig 
!                                                                       
      iergeb = 1 
!                                                                       
  190 continue 
                                                                        
      do 734 azStr = 1,azStrs 
      mstr = mstra(azStr) 
      do 849 iior=1,mStas(mstr) 
!                                                                       
      tiefey(iior) = htiefe(mstr,ior1(mstr,iior)) 
      tempwy(iior) = htempw(mstr,ior1(mstr,iior)) 
      if(iwsim.eq.4)then 
      tracer(iior) = tempwy(iior) 
      if(tracer(iior).lt.0.001)tracer(iior) = 0.0 
      endif 
      CHNFy(iior) = hCHNF(mstr,ior1(mstr,iior)) 
      BVHNFy(iior) = hBVHNF(mstr,ior1(mstr,iior)) 
      CDy(1,iior) = hCD(mstr,1,ior1(mstr,iior)) 
      CDy(2,iior) = hCD(mstr,2,ior1(mstr,iior)) 
      CPy(1,iior) = hCP(mstr,1,ior1(mstr,iior)) 
      CPy(2,iior) = hCP(mstr,2,ior1(mstr,iior)) 
      CMy(iior) = hCM(mstr,ior1(mstr,iior)) 
      BACy(iior) = hBAC(mstr,ior1(mstr,iior)) 
      O2BSBy(iior) = hO2BSB(mstr,ior1(mstr,iior)) 
      bl01y(iior) = hbl01(mstr,ior1(mstr,iior)) 
      bl02y(iior) = hbl02(mstr,ior1(mstr,iior)) 
!                                                                       
      vbsby(iior) = hvbsb(mstr,ior1(mstr,iior)) 
      vcsby(iior) = hvcsb(mstr,ior1(mstr,iior)) 
      vnh4y(iior) = hnh4(mstr,ior1(mstr,iior)) 
      vo2y(iior) = ho2(mstr,ior1(mstr,iior)) 
      vno3y(iior) = hno3(mstr,ior1(mstr,iior)) 
      vno2y(iior) = hno2(mstr,ior1(mstr,iior)) 
      vx0y(iior) = hx0(mstr,ior1(mstr,iior)) 
      vx02y(iior) = hx02(mstr,ior1(mstr,iior)) 
      siy(iior) = hsi(mstr,ior1(mstr,iior)) 
      chlay(iior) = hchla(mstr,ior1(mstr,iior)) 
      chlaky(iior) = hchlak(mstr,ior1(mstr,iior)) 
      chlagy(iior) = hchlag(mstr,ior1(mstr,iior)) 
      chlaby(iior) = hchlab(mstr,ior1(mstr,iior)) 
      akiy(iior) = haki(mstr,ior1(mstr,iior)) 
      agry(iior) = hagr(mstr,ior1(mstr,iior)) 
      ably(iior) = habl(mstr,ior1(mstr,iior)) 
!                                                                       
!                                                                       
      do 702 ndr=1,nndr 
      idrasy(iior,ndr) = hidras(mstr,ior1(mstr,iior),ndr) 
      drmasy(iior,ndr) = hdrmas(mstr,ior1(mstr,iior),ndr) 
      drakry(iior,ndr) = hdrakr(mstr,ior1(mstr,iior),ndr) 
      drbary(iior,ndr) = hdrbar(mstr,ior1(mstr,iior),ndr) 
      Rzuwdy(iior,ndr) = hRzuwd(mstr,ior1(mstr,iior),ndr) 
                                                                        
      dreiy(iior,ndr) = hzdrel(mstr,ior1(mstr,iior),ndr) 
      dreisy(iior,ndr) = hzdrsl(mstr,ior1(mstr,iior),ndr) 
      gwdrly(iior,ndr) = hgwdrl(mstr,ior1(mstr,iior),ndr) 
!                                                                       
  702 drmory(iior,ndr) = hdrmor(mstr,ior1(mstr,iior),ndr) 
!...Makrophythen                                                        
      pfly(iior) = hpfl(mstr,ior1(mstr,iior)) 
!...benthische Algen                                                    
      alby(iior) = habgml(mstr,ior1(mstr,iior))                         &
     &+habkml(mstr,ior1(mstr,iior))                                     
!                                                                       
      coroy(iior) = hcoro2(mstr,ior1(mstr,iior),1)                      &
     &+hcoro2(mstr,ior1(mstr,iior),2)                                   &
     &+hcoro2(mstr,ior1(mstr,iior),3)                                   &
     &+hcoro2(mstr,ior1(mstr,iior),4)                                   &
     &+hcoro2(mstr,ior1(mstr,iior),5)                                   
!                                                                       
      corosy(iior) = hcos2(mstr,ior1(mstr,iior),1)                      &
     &+hcos2(mstr,ior1(mstr,iior),2)                                    &
     &+hcos2(mstr,ior1(mstr,iior),3)                                    &
     &+hcos2(mstr,ior1(mstr,iior),4)                                    &
     &+hcos2(mstr,ior1(mstr,iior),5)                                    
!                                                                       
                                                                        
      ssalgy(iior) = hssalg(mstr,ior1(mstr,iior)) 
      zooiny(iior) = hzooi(mstr,ior1(mstr,iior)) 
      gelpy(iior) = hgelp(mstr,ior1(mstr,iior)) 
      mwy(iior) = hmw(mstr,ior1(mstr,iior)) 
      cay(iior) = hca(mstr,ior1(mstr,iior)) 
      vphy(iior) = hph(mstr,ior1(mstr,iior)) 
      coliy(iior) = hcoli(mstr,ior1(mstr,iior)) 
      lfy(iior) = hlf(mstr,ior1(mstr,iior)) 
      dlarny(iior) = hdlarn(mstr,ior1(mstr,iior)) 
!                                                                       
      susny(iior) = hsusn(mstr,ior1(mstr,iior)) 
      bettny(iior) = hbettn(mstr,ior1(mstr,iior)) 
      dony(iior) = hdon(mstr,ior1(mstr,iior)) 
      akin4y(iior) = haknh4(mstr,ior1(mstr,iior)) 
      agrn4y(iior) = hagnh4(mstr,ior1(mstr,iior)) 
      abln4y(iior) = habnh4(mstr,ior1(mstr,iior)) 
      alNO3y(iior) = halNO3(mstr,ior1(mstr,iior)) 
      FluN3y(iior) = hFluN3(mstr,ior1(mstr,iior)) 
      sedx0y(iior) = hsedx0(mstr,ior1(mstr,iior)) 
      susnoy(iior) = hsusno(mstr,ior1(mstr,iior)) 
      sedaky(iior) = hsedak(mstr,ior1(mstr,iior)) 
      sedagy(iior) = hsedag(mstr,ior1(mstr,iior)) 
      sedaby(iior) = hsedab(mstr,ior1(mstr,iior)) 
      algzky(iior) = halgzk(mstr,ior1(mstr,iior)) 
      algzgy(iior) = halgzg(mstr,ior1(mstr,iior)) 
      algzby(iior) = halgzb(mstr,ior1(mstr,iior)) 
      algdky(iior) = halgdk(mstr,ior1(mstr,iior)) 
      algdgy(iior) = halgdg(mstr,ior1(mstr,iior)) 
      algdby(iior) = halgdb(mstr,ior1(mstr,iior)) 
      algcky(iior) = halgck(mstr,ior1(mstr,iior)) 
      algcgy(iior) = halgcg(mstr,ior1(mstr,iior)) 
      algcby(iior) = halgcb(mstr,ior1(mstr,iior)) 
      volfdy(iior) = hvolfd(mstr,ior1(mstr,iior)) 
      drpfey(iior) = hdrpfe(mstr,ior1(mstr,iior)) 
      abowgy(iior) = habowg(mstr,ior1(mstr,iior)) 
      abowky(iior) = habowk(mstr,ior1(mstr,iior)) 
      aborgy(iior) = haborg(mstr,ior1(mstr,iior)) 
      aborky(iior) = habork(mstr,ior1(mstr,iior)) 
      dalggy(iior) = hdalgg(mstr,ior1(mstr,iior)) 
      dalgky(iior) = hdalgk(mstr,ior1(mstr,iior)) 
      dalgby(iior) = hdalgb(mstr,ior1(mstr,iior)) 
      dalagy(iior) = hdalag(mstr,ior1(mstr,iior)) 
      dalaby(iior) = hdalab(mstr,ior1(mstr,iior)) 
      dalaky(iior) = hdalak(mstr,ior1(mstr,iior)) 
      dgmory(iior) = hdgmor(mstr,ior1(mstr,iior)) 
      dkmory(iior) = hdkmor(mstr,ior1(mstr,iior)) 
      dbmory(iior) = hdbmor(mstr,ior1(mstr,iior)) 
      sgo2ny(iior) = hsgo2n(mstr,ior1(mstr,iior)) 
      sdbsby(iior) = hsdbsb(mstr,ior1(mstr,iior)) 
      so2eiy(iior) = hsoein(mstr,ior1(mstr,iior)) 
      salgoy(iior) = hsalgo(mstr,ior1(mstr,iior)) 
      bsbty(iior) = hbsbt(mstr,ior1(mstr,iior)) 
      dalgoy(iior) = hdalgo(mstr,ior1(mstr,iior)) 
      dalaoy(iior) = hdalao(mstr,ior1(mstr,iior)) 
      schlry(iior) = hschlr(mstr,ior1(mstr,iior)) 
      bsbbey(iior) = hbsbbe(mstr,ior1(mstr,iior)) 
      o2ei1y(iior) = hoein1(mstr,ior1(mstr,iior)) 
      ro2dry(iior) = hro2dr(mstr,ior1(mstr,iior)) 
      zoro2y(iior) = hzoro2(mstr,ior1(mstr,iior)) 
      po2py(iior) = hpo2p(mstr,ior1(mstr,iior)) 
      po2ry(iior) = hpo2r(mstr,ior1(mstr,iior)) 
      iry(iior) = hiras(mstr,ior1(mstr,iior)) 
      rmuasy(iior) = hrmuas(mstr,ior1(mstr,iior)) 
      rakry(iior) = hrakr(mstr,ior1(mstr,iior)) 
      rbary(iior) = hrbar(mstr,ior1(mstr,iior)) 
      ffoody(iior) = hffood(mstr,ior1(mstr,iior)) 
      nl0y(iior) = hnl0(mstr,ior1(mstr,iior)) 
      pl0y(iior) = hpl0(mstr,ior1(mstr,iior)) 
      Q_NKy(iior) = hQ_NK(mstr,ior1(mstr,iior)) 
      Q_PKy(iior) = hQ_PK(mstr,ior1(mstr,iior)) 
      Q_SKy(iior) = hQ_SK(mstr,ior1(mstr,iior)) 
      Q_NGy(iior) = hQ_NG(mstr,ior1(mstr,iior)) 
      Q_PGy(iior) = hQ_PG(mstr,ior1(mstr,iior)) 
      Q_NBy(iior) = hQ_NB(mstr,ior1(mstr,iior)) 
      Q_PBy(iior) = hQ_PB(mstr,ior1(mstr,iior)) 
!                                                                       
!++++++++++++++++++++++++++                                             
      akmuey(iior) = hkmuea(mstr,ior1(mstr,iior)) 
      agmuey(iior) = hgmuea(mstr,ior1(mstr,iior)) 
      abmuey(iior) = hbmuea(mstr,ior1(mstr,iior)) 
      ftay(iior) = hftaau(mstr,ior1(mstr,iior)) 
      fiy(iior) = hfiaus(mstr,ior1(mstr,iior)) 
      figy(iior) = hfigau(mstr,ior1(mstr,iior)) 
      fiby(iior) = hfibau(mstr,ior1(mstr,iior)) 
      fhey(iior) = hfheau(mstr,ior1(mstr,iior)) 
      fhegy(iior) = hfhega(mstr,ior1(mstr,iior)) 
      fheby(iior) = hfheba(mstr,ior1(mstr,iior)) 
      akry(iior) = hakrau(mstr,ior1(mstr,iior)) 
      agrey(iior) = hagrau(mstr,ior1(mstr,iior)) 
      abrey(iior) = habrau(mstr,ior1(mstr,iior)) 
      extky(iior) = hextk(mstr,ior1(mstr,iior)) 
!                                                                       
      tpkiy(iior) = htpki(mstr,ior1(mstr,iior)) 
      tpgry(iior) = htpgr(mstr,ior1(mstr,iior)) 
      tpbly(iior) = htpbl(mstr,ior1(mstr,iior)) 
      vkigry(iior) = hvkigr(mstr,ior1(mstr,iior)) 
      antbly(iior) = hantbl(mstr,ior1(mstr,iior)) 
      HNFmuy(iior) = hHNFmu(mstr,ior1(mstr,iior)) 
      HNFrey(iior) = hHNFre(mstr,ior1(mstr,iior)) 
      HNFupy(iior) = hHNFup(mstr,ior1(mstr,iior)) 
      HNFmoy(iior) = hHNFmo(mstr,ior1(mstr,iior)) 
      HNFexy(iior) = hHNFex(mstr,ior1(mstr,iior)) 
      HNFdry(iior) = hHNFdr(mstr,ior1(mstr,iior)) 
      HNFzy(iior) = hHNFza(mstr,ior1(mstr,iior)) 
      BACmuy(iior) = hBAmua(mstr,ior1(mstr,iior)) 
      JNO3y(iior) = hJNO3(mstr,ior1(mstr,iior)) 
      JNH4y(iior) = hJNH4(mstr,ior1(mstr,iior)) 
      JPO4y(iior) = hJPO4(mstr,ior1(mstr,iior)) 
      JO2y(iior) = hJO2(mstr,ior1(mstr,iior)) 
      SedOM(mstr,iior) = hSedOM(mstr,ior1(mstr,iior)) 
      w2(mstr,iior) = hw2(mstr,ior1(mstr,iior)) 
      dkorn(mstr,iior) = hdkorn(mstr,ior1(mstr,iior)) 
!                                                                       
      dly(iior) = hdl(mstr,ior1(mstr,iior)) 
                                                                        
!....sedhy = Sedimentdicke in mm                                        
      sedhy(mstr,iior) = -1. 
      if(ieros.eq.1)                                                    &
     &sedhy(mstr,iior) = sedhg(mstr,ior1(mstr,iior))                    &
     &*1000.                                                            
!                                                                       
      gsPy(iior) = hgesP(mstr,ior1(mstr,iior)) 
      gsNy(iior) = hgesN(mstr,ior1(mstr,iior)) 
!                                                                       
      if(BACy(iior).le.0.0)goto 718 
      HNFBAy(iior) = hHNFBA(mstr,ior1(mstr,iior))/BACy(iior) 
!                                                                       
!     Buhnenfelder                                                      
!                                                                       
  718 if(nbuhn(mstr).eq.1)then 
      btempy(iior) = btempw(mstr,ior1(mstr,iior)) 
      if(iwsim.eq.4)then 
      btracer(iior) = btempy(iior) 
      if(btracer(iior).lt.0.001)btracer(iior) = 0.0 
      endif 
      bno3y(iior) = bno3(mstr,ior1(mstr,iior)) 
      bno2y(iior) = bno2(mstr,ior1(mstr,iior)) 
      bnh4y(iior) = bnh4(mstr,ior1(mstr,iior)) 
      bgelpy(iior) = bgelp(mstr,ior1(mstr,iior)) 
      bchlay(iior) = bchla(mstr,ior1(mstr,iior)) 
      bchlky(iior) = bchlak(mstr,ior1(mstr,iior)) 
      bchlgy(iior) = bchlag(mstr,ior1(mstr,iior)) 
      bchlby(iior) = bchlab(mstr,ior1(mstr,iior)) 
      bssaly(iior) = bssalg(mstr,ior1(mstr,iior)) 
      bsiy(iior) = bsi(mstr,ior1(mstr,iior)) 
      bakiy(iior) = baki(mstr,ior1(mstr,iior)) 
      bagry(iior) = bagr(mstr,ior1(mstr,iior)) 
      bably(iior) = babl(mstr,ior1(mstr,iior)) 
      bzooiy(iior) = bzooi(mstr,ior1(mstr,iior)) 
      bvbsby(iior) = bvbsb(mstr,ior1(mstr,iior)) 
      bvcsby(iior) = bvcsb(mstr,ior1(mstr,iior)) 
      bbl01y(iior) = bbl01(mstr,ior1(mstr,iior)) 
      bbl02y(iior) = bbl02(mstr,ior1(mstr,iior)) 
      bCDy(1,iior) = bCD(mstr,1,ior1(mstr,iior)) 
      bCDy(2,iior) = bCD(mstr,2,ior1(mstr,iior)) 
      bCPy(1,iior) = bCP(mstr,1,ior1(mstr,iior)) 
      bCPy(2,iior) = bCP(mstr,2,ior1(mstr,iior)) 
      bCMy(iior) = bCM(mstr,ior1(mstr,iior)) 
      bBACy(iior) = bBAC(mstr,ior1(mstr,iior)) 
      bo2y(iior) = bo2(mstr,ior1(mstr,iior)) 
      bmwy(iior) = bmw(mstr,ior1(mstr,iior)) 
      blfy(iior) = blf(mstr,ior1(mstr,iior)) 
      bcay(iior) = bca(mstr,ior1(mstr,iior)) 
      bphy(iior) = bph(mstr,ior1(mstr,iior)) 
!                                                                       
      bdakiy(iior) = bdaki(mstr,ior1(mstr,iior)) 
      bdagry(iior) = bdagr(mstr,ior1(mstr,iior)) 
      bdably(iior) = bdabl(mstr,ior1(mstr,iior)) 
      bdaaky(iior) = bdaak(mstr,ior1(mstr,iior)) 
      bdaagy(iior) = bdaag(mstr,ior1(mstr,iior)) 
      bdaaby(iior) = bdaab(mstr,ior1(mstr,iior)) 
      bsedky(iior) = bsedak(mstr,ior1(mstr,iior)) 
      bsedgy(iior) = bsedag(mstr,ior1(mstr,iior)) 
      bsedby(iior) = bsedab(mstr,ior1(mstr,iior)) 
      bazoky(iior) = bazok(mstr,ior1(mstr,iior)) 
      bazogy(iior) = bazog(mstr,ior1(mstr,iior)) 
      bazoby(iior) = bazob(mstr,ior1(mstr,iior)) 
      bkmory(iior) = bdkmor(mstr,ior1(mstr,iior)) 
      bgmory(iior) = bdgmor(mstr,ior1(mstr,iior)) 
      bbmory(iior) = bdbmor(mstr,ior1(mstr,iior)) 
      bkigry(iior) = bvkigr(mstr,ior1(mstr,iior)) 
      bantby(iior) = bantbl(mstr,ior1(mstr,iior)) 
      bkbcmy(iior) = bakbcm(mstr,ior1(mstr,iior)) 
      biry(iior) = bir(mstr,ior1(mstr,iior)) 
      bsisdy(iior) = bsised(mstr,ior1(mstr,iior)) 
      badrky(iior) = badrk(mstr,ior1(mstr,iior)) 
      badrgy(iior) = badrg(mstr,ior1(mstr,iior)) 
      badrby(iior) = badrb(mstr,ior1(mstr,iior)) 
      bacoky(iior) = bacok(mstr,ior1(mstr,iior)) 
      bacogy(iior) = bacog(mstr,ior1(mstr,iior)) 
      bacoby(iior) = bacob(mstr,ior1(mstr,iior)) 
!                                                                       
      bkmuay(iior) = bakmua(mstr,ior1(mstr,iior)) 
      bgmuay(iior) = bagmua(mstr,ior1(mstr,iior)) 
      bbmuay(iior) = babmua(mstr,ior1(mstr,iior)) 
      bftkay(iior) = bftaau(mstr,ior1(mstr,iior)) 
      bfikay(iior) = bfiaus(mstr,ior1(mstr,iior)) 
      bfigay(iior) = bfigas(mstr,ior1(mstr,iior)) 
      bfibay(iior) = bfibas(mstr,ior1(mstr,iior)) 
      bfhkay(iior) = bfheau(mstr,ior1(mstr,iior)) 
      bfhgay(iior) = bfhgau(mstr,ior1(mstr,iior)) 
      bfhbay(iior) = bfhbau(mstr,ior1(mstr,iior)) 
      bkray(iior) = bakrau(mstr,ior1(mstr,iior)) 
      bgray(iior) = bagrau(mstr,ior1(mstr,iior)) 
      bbray(iior) = babrau(mstr,ior1(mstr,iior)) 
      bnl0y(iior) = bnl0(mstr,ior1(mstr,iior)) 
      bpl0y(iior) = bpl0(mstr,ior1(mstr,iior)) 
      bOBSBy(iior) = bO2BSB(mstr,ior1(mstr,iior)) 
      btpkiy(iior) = btpki(mstr,ior1(mstr,iior)) 
      btpgry(iior) = btpgr(mstr,ior1(mstr,iior)) 
      btpbly(iior) = btpbl(mstr,ior1(mstr,iior)) 
      bextky(iior) = bextk(mstr,ior1(mstr,iior)) 
      bbetNy(iior) = bbettn(mstr,ior1(mstr,iior)) 
      bJNO3y(iior) = bJNO3(mstr,ior1(mstr,iior)) 
      bJNH4y(iior) = bJNH4(mstr,ior1(mstr,iior)) 
      bJPO4y(iior) = bJPO4(mstr,ior1(mstr,iior)) 
      bJO2y(iior) = bJO2(mstr,ior1(mstr,iior)) 
!                                                                       
      bgsPy(iior) = bgesP(mstr,ior1(mstr,iior)) 
      bgsNy(iior) = bgesN(mstr,ior1(mstr,iior)) 
      bFlN3y(iior) = bFluN3(mstr,ior1(mstr,iior)) 
      tau2y(iior) = htau2(mstr,ior1(mstr,iior)) 
      SedOMb(mstr,iior) = bSedOM(mstr,ior1(mstr,iior)) 
      w2b(mstr,iior) = bw2(mstr,ior1(mstr,iior)) 
      dkornb(mstr,iior) = bdkorn(mstr,ior1(mstr,iior)) 
!                                                                       
!                                                                       
      endif 
!                                                                       
!                                                                       
!...2D-Modellierung                                                     
      nkzsy(iior) = nkzsSt(mstr,iior) 
!                                                                       
      Tend = 0.0 
      vN4end = 0.0 
      vN2end = 0.0 
      vN3end = 0.0 
      vo2end = 0.0 
      vgPend = 0.0 
      Siend = 0.0 
      akiend = 0.0 
      agrend = 0.0 
      ablend = 0.0 
      chlend = 0.0 
!                                                                       
      if(hdH2De(mstr,ior1(mstr,iior)).gt.0.0)then 
      tend = htempz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior)) &
     &-((htempz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))     &
     &-htempz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)))/dH2D)  &
     &*hdH2De(mstr,ior1(mstr,iior))                                     
      vN4end = hNH4z(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))&
     &-((hNH4z(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))      &
     &-hNH4z(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)))         &
     &/dH2D)*hdH2De(mstr,ior1(mstr,iior))                               
      vN2end = hNO2z(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))&
     &-((hNO2z(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))      &
     &-hNO2z(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)))         &
     &/dH2D)*hdH2De(mstr,ior1(mstr,iior))                               
      vN3end = hNO3z(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))&
     &-((hNO3z(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))      &
     &-hNO3z(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)))         &
     &/dH2D)*hdH2De(mstr,ior1(mstr,iior))                               
      vO2end = hO2z(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior)) &
     &-((hO2z(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))       &
     &-hO2z(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)))          &
     &/dH2D)*hdH2De(mstr,ior1(mstr,iior))                               
      vgPend = hgelPz(mstr,hnkzs(mstr,ior1(mstr,iior))-1                &
     &,ior1(mstr,iior))                                                 &
     &-((hgelPz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))     &
     &-hgelPz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)))        &
     &/dH2D)*hdH2De(mstr,ior1(mstr,iior))                               
      Siend = hSiz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))  &
     &-((hSiz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))       &
     &-hSiz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)))          &
     &/dH2D)*hdH2De(mstr,ior1(mstr,iior))                               
                                                                        
      akiend = hakiz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))&
     &-((hakiz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))      &
     &-hakiz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)))         &
     &/dH2D)*hdH2De(mstr,ior1(mstr,iior))                               
      agrend = hagrz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))&
     &-((hagrz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))      &
     &-hagrz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)))         &
     &/dH2D)*hdH2De(mstr,ior1(mstr,iior))                               
      ablend = hablz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))&
     &-((hablz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))      &
     &-hablz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)))         &
     &/dH2D)*hdH2De(mstr,ior1(mstr,iior))                               
      chlend = hchlaz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior)&
     &)-((hchlaz(mstr,hnkzs(mstr,ior1(mstr,iior))-1,ior1(mstr,iior))    &
     &-hchlaz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)))        &
     &/dH2D)*hdH2De(mstr,ior1(mstr,iior))                               
      endif 
!                                                                       
      if(nkzsy(iior).eq.hnkzs(mstr,ior1(mstr,iior)))goto 853 
      if(nkzsy(iior).lt.hnkzs(mstr,ior1(mstr,iior)))goto 854 
      if(nkzsy(iior).gt.hnkzs(mstr,ior1(mstr,iior)))goto 855 
!                                                                       
  854 continue 
      do 1815 nkz = 1,nkzsy(iior)-1 
      tempzy(nkz,iior) = htempz(mstr,nkz,ior1(mstr,iior)) 
      vnh4zy(nkz,iior) = hnh4z(mstr,nkz,ior1(mstr,iior)) 
      vNO2zy(nkz,iior) = hno2z(mstr,nkz,ior1(mstr,iior)) 
      vNO3zy(nkz,iior) = hno3z(mstr,nkz,ior1(mstr,iior)) 
      vO2zy(nkz,iior) = ho2z(mstr,nkz,ior1(mstr,iior)) 
      gelPzy(nkz,iior) = hgelPz(mstr,nkz,ior1(mstr,iior)) 
      Sizy(nkz,iior) = hSiz(mstr,nkz,ior1(mstr,iior)) 
      akizy(nkz,iior) = hakiz(mstr,nkz,ior1(mstr,iior)) 
      agrzy(nkz,iior) = hagrz(mstr,nkz,ior1(mstr,iior)) 
      ablzy(nkz,iior) = hablz(mstr,nkz,ior1(mstr,iior)) 
      chlazy(nkz,iior) = hchlaz(mstr,nkz,ior1(mstr,iior)) 
 1815 continue 
!                                                                       
      sO2 = 0.0 
      sn4 = 0.0 
      sN2 = 0.0 
      sN3 = 0.0 
      sumT = 0.0 
      sumP = 0.0 
      sSi = 0.0 
      ski = 0.0 
      sgr = 0.0 
      sbl = 0.0 
      schl = 0.0 
      sumH = 0.0 
      do 1816 nkz = nkzsy(iior),hnkzs(mstr,ior1(mstr,iior))-1 
      sO2 = sO2+((ho2z(mstr,nkz,ior1(mstr,iior))                        &
     &+ho2z(mstr,nkz+1,ior1(mstr,iior)))/2.)*dH2D                       
      sN4 = sN4+((hnh4z(mstr,nkz,ior1(mstr,iior))                       &
     &+hnh4z(mstr,nkz+1,ior1(mstr,iior)))/2.)*dH2D                      
      sN2 = sN2+((hno2z(mstr,nkz,ior1(mstr,iior))                       &
     &+hno2z(mstr,nkz+1,ior1(mstr,iior)))/2.)*dH2D                      
      sN3 = sN3+((hno3z(mstr,nkz,ior1(mstr,iior))                       &
     &+hno3z(mstr,nkz+1,ior1(mstr,iior)))/2.)*dH2D                      
      sumT = sumT+((htempz(mstr,nkz,ior1(mstr,iior))                    &
     &+htempz(mstr,nkz+1,ior1(mstr,iior)))/2.)*dH2D                     
      sumP = sumP+((hgelPz(mstr,nkz,ior1(mstr,iior))                    &
     &+hgelPz(mstr,nkz+1,ior1(mstr,iior)))/2.)*dH2D                     
      sSi = sSi+((hSiz(mstr,nkz,ior1(mstr,iior))                        &
     &+hSiz(mstr,nkz+1,ior1(mstr,iior)))/2.)*dH2D                       
      ski = ski+((hakiz(mstr,nkz,ior1(mstr,iior))                       &
     &+hakiz(mstr,nkz+1,ior1(mstr,iior)))/2.)*dH2D                      
      sgr = sgr+((hagrz(mstr,nkz,ior1(mstr,iior))                       &
     &+hagrz(mstr,nkz+1,ior1(mstr,iior)))/2.)*dH2D                      
      sbl = sbl+((hablz(mstr,nkz,ior1(mstr,iior))                       &
     &+hablz(mstr,nkz+1,ior1(mstr,iior)))/2.)*dH2D                      
      schl = schl+((hchlaz(mstr,nkz,ior1(mstr,iior))                    &
     &+hchlaz(mstr,nkz+1,ior1(mstr,iior)))/2.)*dH2D                     
      sumH = sumH+dH2D 
 1816 continue 
!                                                                       
      tempzy(nkzsy(iior),iior) = sumT/sumH 
      vnh4zy(nkzsy(iior),iior) = sN4/sumH 
      vNO2zy(nkzsy(iior),iior) = sN2/sumH 
      vNO3zy(nkzsy(iior),iior) = sN3/sumH 
      vO2zy(nkzsy(iior),iior) = so2/sumH 
      gelPzy(nkzsy(iior),iior) = sumP/sumH 
      Sizy(nkzsy(iior),iior) = sSi/sumH 
      akizy(nkzsy(iior),iior) = ski/sumH 
      agrzy(nkzsy(iior),iior) = sgr/sumH 
      ablzy(nkzsy(iior),iior) = sbl/sumH 
      chlazy(nkzsy(iior),iior) = schl/sumH 
!                                                                       
      goto 849 
!                                                                       
  855 continue 
!                                                                       
      do 1817 nkz = 1,hnkzs(mstr,ior1(mstr,iior))-1 
      tempzy(nkz,iior) = htempz(mstr,nkz,ior1(mstr,iior)) 
      vnh4zy(nkz,iior) = hnh4z(mstr,nkz,ior1(mstr,iior)) 
      vNO2zy(nkz,iior) = hno2z(mstr,nkz,ior1(mstr,iior)) 
      vNO3zy(nkz,iior) = hno3z(mstr,nkz,ior1(mstr,iior)) 
      vO2zy(nkz,iior) = ho2z(mstr,nkz,ior1(mstr,iior)) 
      gelPzy(nkz,iior) = hgelPz(mstr,nkz,ior1(mstr,iior)) 
      Sizy(nkz,iior) = hSiz(mstr,nkz,ior1(mstr,iior)) 
      akizy(nkz,iior) = hakiz(mstr,nkz,ior1(mstr,iior)) 
      agrzy(nkz,iior) = hagrz(mstr,nkz,ior1(mstr,iior)) 
      ablzy(nkz,iior) = hablz(mstr,nkz,ior1(mstr,iior)) 
      chlazy(nkz,iior) = hchlaz(mstr,nkz,ior1(mstr,iior)) 
 1817 continue 
!                                                                       
                                                                        
      if(hdH2De(mstr,ior1(mstr,iior)).eq.0.0)then 
      Tend = htempz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)) 
      vN4end = hnh4z(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)) 
      vN2end = hno2z(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)) 
      vN3end = hno3z(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)) 
      vo2end = ho2z(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)) 
      vgPend = hgelPz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)) 
      Siend =  hSiz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)) 
      akiend =  hakiz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)) 
      agrend =  hagrz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)) 
      ablend =  hablz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)) 
      chlend =  hchlaz(mstr,hnkzs(mstr,ior1(mstr,iior)),ior1(mstr,iior)) 
      endif 
!                                                                       
      do 1818 nkz = hnkzs(mstr,ior1(mstr,iior)),nkzsy(iior) 
      tempzy(nkz,iior) = Tend 
      vnh4zy(nkz,iior) = vN4end 
      vNO2zy(nkz,iior) = vN2end 
      vNO3zy(nkz,iior) = vN3end 
      vO2zy(nkz,iior) = vo2end 
      gelPzy(nkz,iior) = vgPend 
      Sizy(nkz,iior) = Siend 
      akizy(nkz,iior) = akiend 
      agrzy(nkz,iior) = agrend 
      ablzy(nkz,iior) = ablend 
      chlazy(nkz,iior) = chlend 
 1818 continue 
      goto 849 
!                                                                       
!                                                                       
  853 do 1814 nkz = 1,nkzsy(iior) 
      tempzy(nkz,iior) = htempz(mstr,nkz,ior1(mstr,iior)) 
      vnh4zy(nkz,iior) = hnh4z(mstr,nkz,ior1(mstr,iior)) 
      vNO2zy(nkz,iior) = hno2z(mstr,nkz,ior1(mstr,iior)) 
      vNO3zy(nkz,iior) = hno3z(mstr,nkz,ior1(mstr,iior)) 
      vO2zy(nkz,iior) = ho2z(mstr,nkz,ior1(mstr,iior)) 
      gelPzy(nkz,iior) = hgelPz(mstr,nkz,ior1(mstr,iior)) 
      Sizy(nkz,iior) = hSiz(mstr,nkz,ior1(mstr,iior)) 
      akizy(nkz,iior) = hakiz(mstr,nkz,ior1(mstr,iior)) 
      agrzy(nkz,iior) = hagrz(mstr,nkz,ior1(mstr,iior)) 
      ablzy(nkz,iior) = hablz(mstr,nkz,ior1(mstr,iior)) 
      chlazy(nkz,iior) = hchlaz(mstr,nkz,ior1(mstr,iior)) 
 1814 continue 
      if(hdH2De(mstr,ior1(mstr,iior)).gt.0.0)then 
      tempzy(nkzsy(iior),iior) = Tend 
      vNH4zy(nkzsy(iior),iior) = vN4end 
      vNO2zy(nkzsy(iior),iior) = vN2end 
      vNO3zy(nkzsy(iior),iior) = vN3end 
      vO2zy(nkzsy(iior),iior) = vO2end 
      gelPzy(nkzsy(iior),iior) = vgPend 
      Sizy(nkzsy(iior),iior) = Siend 
      akizy(nkzsy(iior),iior) = akiend 
      agrzy(nkzsy(iior),iior) = agrend 
      ablzy(nkzsy(iior),iior) = ablend 
      chlazy(nkzsy(iior),iior) = chlend 
      endif 
!                                                                       
  849 continue 
!                                                                       
      do 748 iior = 1,mStas(mstr) 
!                                                                       
!....Ausschreiben der Stndlichen Werte (FALLS imitt = 1)               
!                                                                       
!                                                                       
                                                                        
      if(imitt.eq.0)Goto 618 
      if(iwsim.lt.4)tracer = -1. 
      if(iwsim.eq.4)then 
      vbsby(iior) = -1. 
      vcsby(iior) = -1. 
      vnh4y(iior) = -1. 
      vno2y(iior) = -1. 
      vno3y(iior) = -1. 
      gsNy(iior) = -1. 
      gelpy(iior) = -.1 
      gsPy(iior) = -1. 
      Siy(iior) = -1. 
      chlay(iior) = -1. 
      zooiny(iior) = -1. 
      vphy(iior) = -1. 
      mwy(iior) = -1. 
      cay(iior) = -1. 
      lfy(iior) = -1. 
      ssalgy(iior) = -1. 
      vo2y(iior) = -1. 
      CHNFy(iior) = -1. 
      coliy(iior) = -1. 
      tempwy(iior) = -1. 
      endif 
!                                                                       
!...Umrechnung der Uhrz in h.mm                                         
!                                                                       
                                                                        
      Stunde = int(Uhrz) 
      hcmin = (Uhrz-Stunde)*60. 
      minute = nint(hcmin) 
      if(minute.eq.60)then 
        minute = 0 
        Stunde = Stunde+1 
      endif 
      rmin = minute/100. 
      Uhrhm = Stunde+rmin 
                                                                        
      write(155,5103)itags,monats,jahrs,uhrhm                           &
     &,mstr,Stakm(mstr,iior),STRID(mstr)                                
      write(155,5105)vbsby(iior),vcsby(iior)                            &
     &,vnh4y(iior),vno2y(iior),vno3y(iior),gsNy(iior),gelpy(iior)       &
     &,gsPy(iior),Siy(iior),chlay(iior),zooiny(iior),vphy(iior)         &
     &,mwy(iior),cay(iior),lfy(iior),ssalgy(iior),tempwy(iior)          &
     &,vo2y(iior),CHNFy(iior),coliy(iior),Dly(iior),sedhy(mstr,iior)    &
     &,tracer(iior)                                                     
!                                                                       
!Umrechnung von Zeitschrittweite auf pro Stunde                         
      hcUmt = 60./(tflie*1440.) 
!                                                                       
      write(155,5205)(bsbty(iior)*hcUmt),(susNOy(iior)*hcUmt)           &
     &,(O2ei1y(iior)*hcUmt)                                             &
     &,(dalgoy(iior)*hcUmt),(zoro2y(iior)*hcUmt)                        &
     &,(schlry(iior)*hcUmt),(bettny(iior)*hcUmt)                        
!                                                                       
      if(nbuhn(mstr).eq.1.and.iwsim.lt.4)goto 617 
      btempy(iior) = -1. 
      bvbsby(iior) = -1. 
      bvcsby(iior) = -1 
      bnh4y(iior) = -1. 
      bno2y(iior) = -.1 
      bno3y(iior) = -1. 
      bgsNy(iior) = -1. 
      bgelpy(iior) = -.1 
      bgsPy(iior) = -1. 
      bsiy(iior) = -1. 
      bchlay(iior) = -1. 
      bzooiy(iior) = -1. 
      bphy(iior) = -1. 
      bmwy(iior) = -1. 
      bcay(iior) = -1. 
      blfy(iior) = -1. 
      bssaly(iior) = -1. 
      btempy(iior) = -1. 
      bo2y(iior) = -1. 
      if(nbuhn(mstr).eq.0)tau2y(iior) = -1. 
!                                                                       
  617 bcoliy = -1. 
      bHNFy = -1. 
      if(nbuhn(mstr).eq.1.and.iwsim.eq.4)goto 620 
      btracer = -1. 
!                                                                       
  620 write(155,5115)bvbsby(iior),bvcsby(iior),bnh4y(iior)              &
     &,bno2y(iior),bno3y(iior),bgsNy(iior),bgelpy(iior),bgsPy(iior)     &
     &,bsiy(iior),bchlay(iior),bzooiy(iior),bphy(iior),bmwy(iior)       &
     &,bcay(iior),blfy(iior),bssaly(iior),btempy(iior),bo2y(iior)       &
     &,bHNFy,bcoliy,tau2y(iior),btracer(iior)                           
!                                                                       
!                                                                       
 5103 FORMAT(i2,2X,i2,2x,i4,2x,f5.2,2x,i5,2x,f8.3,2x,I5) 
 5104 FORMAT(i2,2X,i2,2x,i4,2x,f5.2,2x,i5,2x,f8.3,2x,I2                 &
     &,2x,I2,2x,I5)                                                     
 5105 FORMAT(f6.2,2x,f6.2,2x,f6.2,2x,f6.3,2x,f9.6,2x,f5.2,2x,f6.3       &
     &,2x,f5.2,2x,f5.2,2x,f6.2,2x,f7.1,2x,f5.2,2x,f5.2,2x,f5.1          &
     &,2x,f8.1,2x,f6.2,2x,f5.2,2x,f5.2,2x,f8.1,2x,f8.0,2x,f7.2          &
     &,2x,f12.6,2x,f7.3)                                                
!                                                                       
 5115 FORMAT(f6.2,2x,f6.2,2x,f6.2,2x,f6.3,2x,f9.6,2x,f5.2,2x,f5.3       &
     &,2x,f5.2,2x,f5.2,2x,f6.2,2x,f7.1,2x,f5.2,2x,f5.2,2x,f5.1          &
     &,2x,f6.1,2x,f6.2,2x,f5.2,2x,f5.2,2x,f8.1,2x,f8.0,2x,f7.3          &
     &,2x,f7.3)                                                         
!                                                                       
 5205 Format(f8.6,2x,f8.6,2x,f8.6,2x,f8.6,2x,F8.6,2x,f10.8,2x,f8.6) 
!                                                                       
!...Ausgabe der Ergebnisse der 2D-Modellierung                          
!                                                                       
  618 continue 
      if(i2Daus.eq.0.or.iwsim.eq.4)goto 619 
      ztiefa = 0.0 
      zPara0 = -.1 
                                                                        
!...Umrechnung der Uhrz in h.mm                                         
!                                                                       
                                                                        
      Stunde = int(Uhrz) 
      hcmin = (Uhrz-Stunde)*60. 
      minute = nint(hcmin) 
      if(minute.eq.60)then 
        minute = 0 
        Stunde = Stunde+1 
      endif 
      rmin = minute/100. 
      Uhrhm = Stunde+rmin 
!                                                                       
      write(255,5104)itags,monats,jahrs,Uhrhm                           &
     &,mstr,Stakm(mstr,iior),nkzmx(mstr,iior),nkzsy(iior),STRID(mstr)   
!                                                                       
      do 1810 nkz = 1,nkzsy(iior) 
      if(vNO2zy(nkz,iior).le.0.0)vNO2zy(nkz,iior) = 0.001 
      if(gelPzy(nkz,iior).lt.0.0)gelPzy(nkz,iior) = -.10 
      if(ztiefa.gt.tiefey(iior))ztiefa = tiefey(iior) 
      write(255,5107)ztiefa,vNH4zy(nkz,iior),vNO2zy(nkz,iior)           &
     &,vNO3zy(nkz,iior),gelPzy(nkz,iior),Sizy(nkz,iior)                 &
     &,tempzy(nkz,iior),vO2zy(nkz,iior),chlazy(nkz,iior)                
      ztiefa = ztiefa+dH2D 
!                                                                       
!     Ermittlung der min- und max-Werte der einzelnen Parameter für die 
!                                                                       
      if(vNH4zy(nkz,iior).gt.Ymax(mstr,161))                            &
     &Ymax(mstr,161) = vNH4zy(nkz,iior)                                 
      if(vNH4zy(nkz,iior).lt.Ymin(mstr,161))                            &
     &Ymin(mstr,161) = vNH4zy(nkz,iior)                                 
      if(vNO2zy(nkz,iior).gt.Ymax(mstr,162))                            &
     &Ymax(mstr,162) = vNO2zy(nkz,iior)                                 
      if(vNO2zy(nkz,iior).lt.Ymin(mstr,162))                            &
     &Ymin(mstr,162) = vNO2zy(nkz,iior)                                 
      if(vNO3zy(nkz,iior).gt.Ymax(mstr,163))                            &
     &Ymax(mstr,163) = vNO3zy(nkz,iior)                                 
      if(vNO3zy(nkz,iior).lt.Ymin(mstr,163))                            &
     &Ymin(mstr,163) = vNO3zy(nkz,iior)                                 
      if(gelPzy(nkz,iior).gt.Ymax(mstr,164))                            &
     &Ymax(mstr,164) = gelPzy(nkz,iior)                                 
      if(gelPzy(nkz,iior).lt.Ymin(mstr,164))                            &
     &Ymin(mstr,164) = gelPzy(nkz,iior)                                 
      if(Sizy(nkz,iior).gt.Ymax(mstr,165))                              &
     &Ymax(mstr,165) = Sizy(nkz,iior)                                   
      if(Sizy(nkz,iior).lt.Ymin(mstr,165))                              &
     &Ymin(mstr,165) = Sizy(nkz,iior)                                   
      if(tempzy(nkz,iior).gt.Ymax(mstr,166))                            &
     &Ymax(mstr,166) = tempzy(nkz,iior)                                 
      if(tempzy(nkz,iior).lt.Ymin(mstr,166))                            &
     &Ymin(mstr,166) = tempzy(nkz,iior)                                 
      if(vO2zy(nkz,iior).gt.Ymax(mstr,167))                             &
     &Ymax(mstr,167) = vO2zy(nkz,iior)                                  
      if(vO2zy(nkz,iior).lt.Ymin(mstr,167))                             &
     &Ymin(mstr,167) = vO2zy(nkz,iior)                                  
      if(chlazy(nkz,iior).gt.Ymax(mstr,172))                            &
     &Ymax(mstr,172) = chlazy(nkz,iior)                                 
      if(chlazy(nkz,iior).lt.Ymin(mstr,172))                            &
     &Ymin(mstr,172) = chlazy(nkz,iior)                                 
!                                                                       
 1810 continue 
!                                                                       
      do 1811 nkz = nkzsy(iior)+1,nkzmx(mstr,iior) 
      write(255,5107)zPara0,zPara0,zPara0,zPara0                        &
     &,zPara0,zPara0,zPara0,zPara0,zPara0                               
 1811 continue 
!                                                                       
 5107 FORMAT(f5.2,2x,f6.2,2x,f5.3,2x,f9.6,2x,f5.3,2x,f5.2,2x,f5.2       &
     &,2x,f5.2,2x,f6.2)                                                 
!                                                                       
  619 continue 
!                                                                       
!                                                                       
! Summenbildung fuer Ausgabe                                            
!                                                                       
      sumte(mstr,iior) = sumte(mstr,iior)+tempwy(iior) 
      if(tempwy(iior).gt.mxtemp(mstr,iior))                             &
     &mxtemp(mstr,iior) = tempwy(iior)                                  
      if(tempwy(iior).lt.mitemp(mstr,iior))                             &
     &mitemp(mstr,iior) = tempwy(iior)                                  
!                                                                       
      sCHNF(mstr,iior) = sCHNF(mstr,iior)+CHNFy(iior) 
      sBVHNF(mstr,iior) = sBVHNF(mstr,iior)+BVHNFy(iior) 
      sCD(mstr,1,iior) = sCD(mstr,1,iior)+CDy(1,iior) 
      sCD(mstr,2,iior) = sCD(mstr,2,iior)+CDy(2,iior) 
      sCP(mstr,1,iior) = sCP(mstr,1,iior)+CPy(1,iior) 
      sCP(mstr,2,iior) = sCP(mstr,2,iior)+CPy(2,iior) 
      sCM(mstr,iior) = sCM(mstr,iior)+CMy(iior) 
      sBAC(mstr,iior) = sBAC(mstr,iior)+BACy(iior) 
!                                                                       
      sgsP(mstr,iior) = sgsP(mstr,iior)+gsPy(iior) 
      if(gsPy(iior).gt.mxgsP(mstr,iior))mxgsP(mstr,iior) = gsPy(iior) 
      if(gsPy(iior).lt.migsP(mstr,iior))migsP(mstr,iior) = gsPy(iior) 
!                                                                       
      sgsN(mstr,iior) = sgsN(mstr,iior)+gsNy(iior) 
      if(gsNy(iior).gt.mxgsN(mstr,iior))mxgsN(mstr,iior) = gsNy(iior) 
      if(gsNy(iior).lt.migsN(mstr,iior))migsN(mstr,iior) = gsNy(iior) 
      sumb5(mstr,iior) = sumb5(mstr,iior)+vbsby(iior) 
      if(vbsby(iior).gt.mxb5(mstr,iior))mxb5(mstr,iior) = vbsby(iior) 
      if(vbsby(iior).lt.mib5(mstr,iior))mib5(mstr,iior) = vbsby(iior) 
      sumcs(mstr,iior) = sumcs(mstr,iior)+vcsby(iior) 
      if(vcsby(iior).gt.mxcs(mstr,iior))mxcs(mstr,iior) = vcsby(iior) 
      if(vcsby(iior).lt.mics(mstr,iior))mics(mstr,iior) = vcsby(iior) 
      sumn4(mstr,iior) = sumn4(mstr,iior)+vnh4y(iior) 
      if(vnh4y(iior).gt.mxnh4(mstr,iior))mxnh4(mstr,iior) = vnh4y(iior) 
      if(vnh4y(iior).lt.minh4(mstr,iior))minh4(mstr,iior) = vnh4y(iior) 
      sumo2(mstr,iior) = sumo2(mstr,iior)+vo2y(iior) 
      if(vo2y(iior).gt.mxo2(mstr,iior))mxo2(mstr,iior) = vo2y(iior) 
      if(vo2y(iior).lt.mio2(mstr,iior))mio2(mstr,iior) = vo2y(iior) 
      sumca(mstr,iior) = sumca(mstr,iior)+chlay(iior) 
      sumcak(mstr,iior) = sumcak(mstr,iior)+chlaky(iior) 
      sumcag(mstr,iior) = sumcag(mstr,iior)+chlagy(iior) 
      sumcab(mstr,iior) = sumcab(mstr,iior)+chlaby(iior) 
      if(chlay(iior).gt.mxchla(mstr,iior))                              &
     &mxchla(mstr,iior) = chlay(iior)                                   
      if(chlay(iior).lt.michla(mstr,iior))                              &
     &michla(mstr,iior) = chlay(iior)                                   
      svkigr(mstr,iior) = svkigr(mstr,iior)+vkigry(iior) 
      santbl(mstr,iior) = santbl(mstr,iior)+antbly(iior) 
!                                                                       
      sumaki(mstr,iior) = sumaki(mstr,iior)+akiy(iior) 
      if(akiy(iior).gt.mxaki(mstr,iior))mxaki(mstr,iior) = akiy(iior) 
      if(akiy(iior).lt.miaki(mstr,iior))miaki(mstr,iior) = akiy(iior) 
      sumagr(mstr,iior) = sumagr(mstr,iior)+agry(iior) 
      if(agry(iior).gt.mxagr(mstr,iior))mxagr(mstr,iior) = agry(iior) 
      if(agry(iior).lt.miagr(mstr,iior))miagr(mstr,iior) = agry(iior) 
      sumabl(mstr,iior) = sumabl(mstr,iior)+ably(iior) 
      if(ably(iior).gt.mxabl(mstr,iior))mxabl(mstr,iior) = ably(iior) 
      if(ably(iior).lt.miabl(mstr,iior))miabl(mstr,iior) = ably(iior) 
!                                                                       
      sumzo(mstr,iior) = sumzo(mstr,iior)+zooiny(iior) 
      if(zooiny(iior).gt.mxzo(mstr,iior))mxzo(mstr,iior) = zooiny(iior) 
      if(zooiny(iior).lt.mizo(mstr,iior))mizo(mstr,iior) = zooiny(iior) 
      sumvph(mstr,iior) = sumvph(mstr,iior)+vphy(iior) 
      if(vphy(iior).gt.mxvph(mstr,iior))mxvph(mstr,iior) = vphy(iior) 
      if(vphy(iior).lt.mivph(mstr,iior))mivph(mstr,iior) = vphy(iior) 
      sumno3(mstr,iior) = sumno3(mstr,iior)+vno3y(iior) 
      if(vno3y(iior).gt.mxvno3(mstr,iior))                              &
     &mxvno3(mstr,iior) = vno3y(iior)                                   
      if(vno3y(iior).lt.mivno3(mstr,iior))                              &
     &mivno3(mstr,iior) = vno3y(iior)                                   
      sumno2(mstr,iior) = sumno2(mstr,iior)+vno2y(iior) 
      if(vno2(iior).gt.mxvno2(mstr,iior))mxvno2(mstr,iior) = vno2y(iior) 
      if(vno2(iior).lt.mivno2(mstr,iior))mivno2(mstr,iior) = vno2y(iior) 
      sumgp(mstr,iior) = sumgp(mstr,iior)+gelpy(iior) 
      if(gelpy(iior).gt.mxgp(mstr,iior))mxgp(mstr,iior) = gelpy(iior) 
      if(gelpy(iior).lt.migp(mstr,iior))migp(mstr,iior) = gelpy(iior) 
      sumsi(mstr,iior) = sumsi(mstr,iior)+siy(iior) 
      if(siy(iior).gt.mxsi(mstr,iior))mxsi(mstr,iior) = siy(iior) 
      if(siy(iior).lt.misi(mstr,iior))misi(mstr,iior) = siy(iior) 
      sumcal(mstr,iior) = sumcal(mstr,iior)+cay(iior) 
      if(cay(iior).gt.mxca(mstr,iior))mxca(mstr,iior) = cay(iior) 
      if(cay(iior).lt.mica(mstr,iior))mica(mstr,iior) = cay(iior) 
      summw(mstr,iior) = summw(mstr,iior)+mwy(iior) 
      if(mwy(iior).gt.mxmw(mstr,iior))mxmw(mstr,iior) = mwy(iior) 
      if(mwy(iior).lt.mimw(mstr,iior))mimw(mstr,iior) = mwy(iior) 
      sumlf(mstr,iior) = sumlf(mstr,iior)+lfy(iior) 
      if(lfy(iior).gt.mxlf(mstr,iior))mxlf(mstr,iior) = lfy(iior) 
      if(lfy(iior).lt.milf(mstr,iior))milf(mstr,iior) = lfy(iior) 
      sumss(mstr,iior) = sumss(mstr,iior)+ssalgy(iior) 
      if(ssalgy(iior).gt.mxSS(mstr,iior))mxSS(mstr,iior) = ssalgy(iior) 
      if(ssalgy(iior).lt.miSS(mstr,iior))miSS(mstr,iior) = ssalgy(iior) 
      scoli(mstr,iior) = scoli(mstr,iior)+coliy(iior) 
      if(coliy(iior).gt.mxcoli(mstr,iior))                              &
     &mxcoli(mstr,iior) = coliy(iior)                                   
      if(coliy(iior).lt.micoli(mstr,iior))                              &
     &micoli(mstr,iior) = coliy(iior)                                   
                                                                        
                                                                        
      sumdln(mstr,iior) = sumdln(mstr,iior)+dlarny(iior) 
      if(dlarny(iior).gt.mxdlan(mstr,iior))                             &
     &mxdlan(mstr,iior) = dlarny(iior)                                  
      if(dlarny(iior).lt.midlan(mstr,iior))                             &
     &midlan(mstr,iior) = dlarny(iior)                                  
!....Dreissena                                                          
      do 838 ndr=1,nndr 
      sidras(mstr,iior,ndr) = sidras(mstr,iior,ndr)+idrasy(iior,ndr) 
      sdrmas(mstr,iior,ndr) = sdrmas(mstr,iior,ndr)+drmasy(iior,ndr) 
      sdrakr(mstr,iior,ndr) = sdrakr(mstr,iior,ndr)+drakry(iior,ndr) 
      sdrbar(mstr,iior,ndr) = sdrbar(mstr,iior,ndr)+drbary(iior,ndr) 
      sdrmor(mstr,iior,ndr) = sdrmor(mstr,iior,ndr)+drmory(iior,ndr) 
      szdrg(mstr,iior,ndr) = szdrg(mstr,iior,ndr)+dreiy(iior,ndr) 
      szdrsg(mstr,iior,ndr) = szdrsg(mstr,iior,ndr)+dreisy(iior,ndr) 
  838 sgwdrg(mstr,iior,ndr) = sgwdrg(mstr,iior,ndr)+gwdrly(iior,ndr) 
!                                                                       
      scorIg(mstr,iior) = scorIg(mstr,iior)+coroy(iior) 
      scoIsg(mstr,iior) = scoIsg(mstr,iior)+corosy(iior) 
!                                                                       
      sumpfl(mstr,iior) = sumpfl(mstr,iior)+pfly(iior) 
      sumbal(mstr,iior) = sumbal(mstr,iior)+alby(iior) 
!                                                                       
      snaehr(mstr,iior) = snaehr(mstr,iior)+tpkiy(iior)*vkigry(iior)    &
     &+tpgry(iior)*(1.-vkigry(iior)-antbly(iior))                       &
     &+tpbly(iior)*antbly(iior)                                         
!                                                                       
      ssusn(mstr,iior) = ssusn(mstr,iior)+susny(iior) 
      sbettn(mstr,iior) = sbettn(mstr,iior)+bettny(iior) 
      sdon(mstr,iior) = sdon(mstr,iior)+dony(iior) 
      salgn(mstr,iior) = salgn(mstr,iior)+agrn4y(iior)                  &
     &+akin4y(iior)+abln4y(iior)                                        
      salNO3(mstr,iior) = salNO3(mstr,iior)+alNO3y(iior) 
      sFluN3(mstr,iior) = sFluN3(mstr,iior)+FluN3y(iior) 
      sJNO3(mstr,iior) = sJNO3(mstr,iior)+JNO3y(iior) 
      sJNH4(mstr,iior) = sJNH4(mstr,iior)+JNH4y(iior) 
      sJPO4(mstr,iior) = sJPO4(mstr,iior)+JPO4y(iior) 
      sJO2(mstr,iior) = sJO2(mstr,iior)+JO2y(iior) 
      svx0(mstr,iior) = svx0(mstr,iior)+vx0y(iior) 
      svx02(mstr,iior) = svx02(mstr,iior)+vx02y(iior) 
      ssedx0(mstr,iior) = ssedx0(mstr,iior)+sedx0y(iior) 
      ssusno(mstr,iior) = ssusno(mstr,iior)+susnoy(iior) 
      ssedal(mstr,iior) = ssedal(mstr,iior)+sedagy(iior)                &
     &+sedaky(iior)+sedaby(iior)                                        
      salgzo(mstr,iior) = salgzo(mstr,iior)+algzgy(iior)                &
     &+algzky(iior)+algzby(iior)                                        
      salgdr(mstr,iior) = salgdr(mstr,iior)+algdgy(iior)                &
     &+algdky(iior)+algdby(iior)                                        
      salgco(mstr,iior) = salgco(mstr,iior)+algcgy(iior)                &
     &+algcky(iior)+algcby(iior)                                        
      svoldr(mstr,iior) = svoldr(mstr,iior)+volfdy(iior) 
      sdrpfe(mstr,iior) = sdrpfe(mstr,iior)+drpfey(iior) 
      sabeow(mstr,iior) = sabeow(mstr,iior)+abowgy(iior)+abowky(iior) 
      sabeor(mstr,iior) = sabeor(mstr,iior)+aborgy(iior)+aborky(iior) 
      sdalg(mstr,iior) = sdalg(mstr,iior)+dalggy(iior)+dalgky(iior)     &
     &+dalgby(iior)                                                     
      sdalga(mstr,iior) = sdalga(mstr,iior)+dalagy(iior)+dalaky(iior)   &
     &+dalaby(iior)                                                     
      salmor(mstr,iior) = salmor(mstr,iior)+dgmory(iior)+dkmory(iior)   &
     &+dbmory(iior)                                                     
      sblmor(mstr,iior) = sblmor(mstr,iior)+dbmory(iior) 
      ssgo2n(mstr,iior) = ssgo2n(mstr,iior)+sgo2ny(iior) 
      ssdbsb(mstr,iior) = ssdbsb(mstr,iior)+sdbsby(iior) 
      ssoein(mstr,iior) = ssoein(mstr,iior)+so2eiy(iior) 
      ssalgo(mstr,iior) = ssalgo(mstr,iior)+salgoy(iior) 
      sbsbt(mstr,iior) = sbsbt(mstr,iior)+bsbty(iior) 
      s2algo(mstr,iior) = s2algo(mstr,iior)+dalgoy(iior) 
      s2algao(mstr,iior) = s2algao(mstr,iior)+dalaoy(iior) 
      sschlr(mstr,iior) = sschlr(mstr,iior)+schlry(iior) 
      sbsbbe(mstr,iior) = sbsbbe(mstr,iior)+bsbbey(iior) 
      so2phy(mstr,iior) = so2phy(mstr,iior)+o2ei1y(iior) 
      sro2dr(mstr,iior) = sro2dr(mstr,iior)+ro2dry(iior) 
      szooro(mstr,iior) = szooro(mstr,iior)+zoro2y(iior) 
      spo2p(mstr,iior) = spo2p(mstr,iior)+po2py(iior) 
      spo2r(mstr,iior) = spo2r(mstr,iior)+po2ry(iior) 
      sir(mstr,iior) = sir(mstr,iior)+iry(iior) 
      srmue(mstr,iior) = srmue(mstr,iior)+rmuasy(iior) 
      srakr(mstr,iior) = srakr(mstr,iior)+rakry(iior) 
      srbar(mstr,iior) = srbar(mstr,iior)+rbary(iior) 
      sffood(mstr,iior) = sffood(mstr,iior)+ffoody(iior) 
!.....sfik enthaelt die mittlere Produktionsraten der Algen             
!...fuer die 3 Algengruppen                                             
      sfik(mstr,iior) = sfik(mstr,iior)+fiy(iior)*vkigry(iior)          &
     &+figy(iior)*(1.-vkigry(iior)-antbly(iior))                        &
     &+fiby(iior)*antbly(iior)                                          
!                                                                       
!.....sfig wird mit dem Extinktionskoeffizient belegt                   
!                                                                       
      sfig(mstr,iior) = sfig(mstr,iior)+extky(iior) 
!.....sfib wird nicht mehr erzeugt                                      
      sfib(mstr,iior) = -1. 
      sakmua(mstr,iior) = sakmua(mstr,iior)+akmuey(iior) 
      sagmua(mstr,iior) = sagmua(mstr,iior)+agmuey(iior) 
      sabmua(mstr,iior) = sabmua(mstr,iior)+abmuey(iior) 
      sfheka(mstr,iior) = sfheka(mstr,iior)+fhey(iior) 
      sfhega(mstr,iior) = sfhega(mstr,iior)+fhegy(iior) 
      sfheba(mstr,iior) = sfheba(mstr,iior)+fheby(iior) 
      sakrau(mstr,iior) = sakrau(mstr,iior)+akry(iior) 
      sagrea(mstr,iior) = sagrea(mstr,iior)+agrey(iior) 
      sabrea(mstr,iior) = sabrea(mstr,iior)+abrey(iior) 
      sHNFmu(mstr,iior) = sHNFmu(mstr,iior)+HNFmuy(iior) 
      sHNFre(mstr,iior) = sHNFre(mstr,iior)+HNFrey(iior) 
      sHNFup(mstr,iior) = sHNFup(mstr,iior)+HNFupy(iior) 
      sHNFmo(mstr,iior) = sHNFmo(mstr,iior)+HNFmoy(iior) 
      sHNFex(mstr,iior) = sHNFex(mstr,iior)+HNFexy(iior) 
      sHNFdr(mstr,iior) = sHNFdr(mstr,iior)+HNFdry(iior) 
      sHNFz(mstr,iior) = sHNFz(mstr,iior)+HNFzy(iior) 
      sBACmu(mstr,iior) = sBACmu(mstr,iior)+BACmuy(iior) 
      sHNFBA(mstr,iior) = sHNFBA(mstr,iior)+HNFBAy(iior) 
      snl0(mstr,iior) = snl0(mstr,iior)+nl0y(iior) 
      spl0(mstr,iior) = spl0(mstr,iior)+pl0y(iior) 
!                                                                       
!                                                                       
!     Buhnenfelder                                                      
!                                                                       
      if(nbuhn(mstr).eq.1)then 
      bste(mstr,iior) = bste(mstr,iior)+btempy(iior) 
      if(btempy(iior).gt.bmxtem(mstr,iior))                             &
     &bmxtem(mstr,iior) = btempy(iior)                                  
      if(btempy(iior).lt.bmitem(mstr,iior))                             &
     &bmitem(mstr,iior) = btempy(iior)                                  
      bsno3(mstr,iior) = bsno3(mstr,iior)+bno3y(iior) 
      if(bno3y(iior).gt.bmxno3(mstr,iior))                              &
     &bmxno3(mstr,iior) = bno3y(iior)                                   
      if(bno3y(iior).lt.bmino3(mstr,iior))                              &
     &bmino3(mstr,iior) = bno3y(iior)                                   
      bsno2(mstr,iior) = bsno2(mstr,iior)+bno2y(iior) 
      if(bno2y(iior).gt.bmxno2(mstr,iior))                              &
     &bmxno2(mstr,iior) = bno2y(iior)                                   
      if(bno2y(iior).lt.bmino2(mstr,iior))                              &
     &bmino2(mstr,iior) = bno2y(iior)                                   
      bsn4(mstr,iior) = bsn4(mstr,iior)+bnh4y(iior) 
      if(bnh4y(iior).gt.bmxnh4(mstr,iior))                              &
     &bmxnh4(mstr,iior) = bnh4y(iior)                                   
      if(bnh4y(iior).lt.bminh4(mstr,iior))                              &
     &bminh4(mstr,iior) = bnh4y(iior)                                   
      bsgelp(mstr,iior) = bsgelp(mstr,iior)+bgelpy(iior) 
      if(bgelpy(iior).gt.bmxglp(mstr,iior))                             &
     &bmxglp(mstr,iior) = bgelpy(iior)                                  
      if(bgelpy(iior).lt.bmiglp(mstr,iior))                             &
     &bmiglp(mstr,iior) = bgelpy(iior)                                  
      bschla(mstr,iior) = bschla(mstr,iior)+bchlay(iior) 
      if(bchlay(iior).gt.bmxchl(mstr,iior))                             &
     &bmxchl(mstr,iior) = bchlay(iior)                                  
      if(bchlay(iior).lt.bmichl(mstr,iior))                             &
     &bmichl(mstr,iior) = bchlay(iior)                                  
      bsaki(mstr,iior) = bsaki(mstr,iior)+bakiy(iior) 
      if(bakiy(iior).gt.bmxaki(mstr,iior))                              &
     &bmxaki(mstr,iior) = bakiy(iior)                                   
      if(bakiy(iior).lt.bmiaki(mstr,iior))                              &
     &bmiaki(mstr,iior) = bakiy(iior)                                   
      bsagr(mstr,iior) = bsagr(mstr,iior)+bagry(iior) 
      if(bagry(iior).gt.bmxagr(mstr,iior))                              &
     &bmxagr(mstr,iior) = bagry(iior)                                   
      if(bagry(iior).lt.bmiagr(mstr,iior))                              &
     &bmiagr(mstr,iior) = bagry(iior)                                   
      bsabl(mstr,iior) = bsabl(mstr,iior)+bably(iior) 
      bsssal(mstr,iior) = bsssal(mstr,iior)+bssaly(iior) 
      if(bssaly(iior).gt.bmxssa(mstr,iior))                             &
     &bmxssa(mstr,iior) = bssaly(iior)                                  
      if(bssaly(iior).lt.bmissa(mstr,iior))                             &
     &bmissa(mstr,iior) = bssaly(iior)                                  
      bssi(mstr,iior) = bssi(mstr,iior)+bsiy(iior) 
      if(bsiy(iior).gt.bmxsi(mstr,iior))bmxsi(mstr,iior) = bsiy(iior) 
      if(bsiy(iior).lt.bmisi(mstr,iior))bmisi(mstr,iior) = bsiy(iior) 
      bszooi(mstr,iior) = bszooi(mstr,iior)+bzooiy(iior) 
      if(bzooiy(iior).gt.bmxzoo(mstr,iior))                             &
     &bmxzoo(mstr,iior) = bzooiy(iior)                                  
      if(bzooiy(iior).lt.bmizoo(mstr,iior))                             &
     &bmizoo(mstr,iior) = bzooiy(iior)                                  
      bsvbsb(mstr,iior) = bsvbsb(mstr,iior)+bvbsby(iior) 
      if(bvbsby(iior).gt.bmxbsb(mstr,iior))                             &
     &bmxbsb(mstr,iior) = bvbsby(iior)                                  
      if(bvbsby(iior).lt.bmibsb(mstr,iior))                             &
     &bmibsb(mstr,iior) = bvbsby(iior)                                  
      bsvcsb(mstr,iior) = bsvcsb(mstr,iior)+bvcsby(iior) 
      if(bvcsby(iior).gt.bmxcsb(mstr,iior))                             &
     &bmxcsb(mstr,iior) = bvcsby(iior)                                  
      if(bvcsby(iior).lt.bmicsb(mstr,iior))                             &
     &bmicsb(mstr,iior) = bvcsby(iior)                                  
      bsgsP(mstr,iior) = bsgsP(mstr,iior)+bgsPy(iior) 
      if(bgsPy(iior).gt.bmxgsP(mstr,iior))                              &
     &bmxgsP(mstr,iior) = bgsPy(iior)                                   
      if(bgsPy(iior).lt.bmigsP(mstr,iior))                              &
     &bmigsP(mstr,iior) = bgsPy(iior)                                   
      bsgsN(mstr,iior) = bsgsN(mstr,iior)+bgsNy(iior) 
      if(bgsNy(iior).gt.bmxgsN(mstr,iior))                              &
     &bmxgsN(mstr,iior) = bgsNy(iior)                                   
      if(bgsNy(iior).lt.bmigsN(mstr,iior))                              &
     &bmigsN(mstr,iior) = bgsNy(iior)                                   
      bso2(mstr,iior) = bso2(mstr,iior)+bo2y(iior) 
      if(bo2y(iior).gt.bmxo2(mstr,iior))bmxo2(mstr,iior) = bo2y(iior) 
      if(bo2y(iior).lt.bmio2(mstr,iior))bmio2(mstr,iior) = bo2y(iior) 
      bsmw(mstr,iior) = bsmw(mstr,iior)+bmwy(iior) 
      if(bmwy(iior).gt.bmxmw(mstr,iior))bmxmw(mstr,iior) = bmwy(iior) 
      if(bmwy(iior).lt.bmimw(mstr,iior))bmimw(mstr,iior) = bmwy(iior) 
      bslf(mstr,iior) = bslf(mstr,iior)+blfy(iior) 
      if(blfy(iior).gt.bmxlf(mstr,iior))bmxlf(mstr,iior) = blfy(iior) 
      if(blfy(iior).lt.bmilf(mstr,iior))bmilf(mstr,iior) = blfy(iior) 
      bsca(mstr,iior) = bsca(mstr,iior)+bcay(iior) 
      if(bcay(iior).gt.bmxca(mstr,iior))bmxca(mstr,iior) = bcay(iior) 
      if(bcay(iior).lt.bmica(mstr,iior))bmica(mstr,iior) = bcay(iior) 
      bsph(mstr,iior) = bsph(mstr,iior)+bphy(iior) 
      if(bphy(iior).gt.bmxph(mstr,iior))bmxph(mstr,iior) = bphy(iior) 
      if(bphy(iior).lt.bmiph(mstr,iior))bmiph(mstr,iior) = bphy(iior) 
      bsnl0(mstr,iior) = bsnl0(mstr,iior)+bnl0y(iior) 
      bspl0(mstr,iior) = bspl0(mstr,iior)+bpl0y(iior) 
!                                                                       
!......Raten                                                            
!                                                                       
      bnaehr(mstr,iior) = bnaehr(mstr,iior)+ btpkiy(iior)*bkigry(iior)  &
     &+btpgry(iior)*(1.-bkigry(iior)-bantby(iior))                      &
     &+btpbly(iior)*bantby(iior)                                        
!                                                                       
      bsdalg(mstr,iior) = bsdalg(mstr,iior)+bdakiy(iior)+bdagry(iior)   &
     &+bdably(iior)                                                     
      bsvkg(mstr,iior) = bsvkg(mstr,iior)+bkigry(iior) 
      bsantb(mstr,iior) = bsantb(mstr,iior)+bantby(iior) 
      bsdaa(mstr,iior) = bsdaa(mstr,iior)+bdaaky(iior)+bdaagy(iior)     &
     &+bdaaby(iior)                                                     
      bsseda(mstr,iior) = bsseda(mstr,iior)+bsedky(iior)+bsedgy(iior)   &
     &+bsedby(iior)                                                     
      bsalgz(mstr,iior) = bsalgz(mstr,iior)+bazoky(iior)+bazogy(iior)   &
     &+bazoby(iior)                                                     
      bsamor(mstr,iior) = bsamor(mstr,iior)+bkmory(iior)+bgmory(iior)   &
     &+bbmory(iior)                                                     
      bsadr(mstr,iior) = bsadr(mstr,iior)+badrky(iior)+badrgy(iior)     &
     &+badrby(iior)                                                     
!...Pseudofaces = 0.0 da keine Dreissena in Buhnenfeld                  
      bsalco(mstr,iior) = bsalco(mstr,iior)+bacoky(iior)+bacogy(iior)   &
     &+bacoby(iior)                                                     
!.....sfik enthaelt die mittlere Produktionsraten der Algen             
!...fuer die 3 Algengruppen                                             
      bsfik(mstr,iior) = bsfik(mstr,iior)+bfikay(iior)*bkigry(iior)     &
     &+bfigay(iior)*(1.-bkigry(iior)-bantby(iior))                      &
     &+bfibay(iior)*bantby(iior)                                        
!                                                                       
!....bsfig: Summenbildung des extiktionskoeffizients                    
      bsfig(mstr,iior) = bsfig(mstr,iior)+bextky(iior) 
      bskmue(mstr,iior) = bskmue(mstr,iior)+bkmuay(iior) 
      bsgmue(mstr,iior) = bsgmue(mstr,iior)+bgmuay(iior) 
      bsbmue(mstr,iior) = bsbmue(mstr,iior)+bbmuay(iior) 
      bshek(mstr,iior) = bshek(mstr,iior)+bfhkay(iior) 
      bsheg(mstr,iior) = bsheg(mstr,iior)+bfhgay(iior) 
      bsheb(mstr,iior) = bsheb(mstr,iior)+bfhbay(iior) 
      bskre(mstr,iior) = bskre(mstr,iior)+bkray(iior) 
      bsgre(mstr,iior) = bsgre(mstr,iior)+bgray(iior) 
      bsbre(mstr,iior) = bsbre(mstr,iior)+bbray(iior) 
      bschlk(mstr,iior) = bschlk(mstr,iior)+bchlky(iior) 
      bschlg(mstr,iior) = bschlg(mstr,iior)+bchlgy(iior) 
      bschlb(mstr,iior) = bschlb(mstr,iior)+bchlby(iior) 
      bsFlN3(mstr,iior) = bsFlN3(mstr,iior)+bFlN3y(iior) 
      bsBetN(mstr,iior) = bsBetN(mstr,iior)+bbetNy(iior) 
      bsJNO3(mstr,iior) = bsJNO3(mstr,iior)+bJNO3y(iior) 
      bsJNH4(mstr,iior) = bsJNH4(mstr,iior)+bJNH4y(iior) 
      bsJPO4(mstr,iior) = bsJPO4(mstr,iior)+bJPO4y(iior) 
      bsJO2(mstr,iior) = bsJO2(mstr,iior)+bJO2y(iior) 
!                                                                       
      endif 
!                                                                       
!...Ymax/Ymin-Bildung für grafische Ausgabe                             
!                                                                       
!                                                                       
      if(vbsby(iior).gt.Ymax(mstr,1))Ymax(mstr,1) = vbsby(iior) 
      if(vbsby(iior).lt.Ymin(mstr,1))Ymin(mstr,1) = vbsby(iior) 
      if(vcsby(iior).gt.Ymax(mstr,2))Ymax(mstr,2) = vcsby(iior) 
      if(vcsby(iior).lt.Ymin(mstr,2))Ymin(mstr,2) = vcsby(iior) 
      if(vnh4y(iior).gt.Ymax(mstr,3))Ymax(mstr,3) = vnh4y(iior) 
      if(vnh4y(iior).lt.Ymin(mstr,3))Ymin(mstr,3) = vnh4y(iior) 
      if(vno2y(iior).gt.Ymax(mstr,4))Ymax(mstr,4) = vno2y(iior) 
      if(vno2y(iior).lt.Ymin(mstr,4))Ymin(mstr,4) = vno2y(iior) 
      if(vno3y(iior).gt.Ymax(mstr,5))Ymax(mstr,5) = vno3y(iior) 
      if(vno3y(iior).lt.Ymin(mstr,5))Ymin(mstr,5) = vno3y(iior) 
      if(gsNy(iior).gt.Ymax(mstr,6))Ymax(mstr,6) = gsNy(iior) 
      if(gsNy(iior).lt.Ymin(mstr,6))Ymin(mstr,6) = gsNy(iior) 
      if(gelpy(iior).gt.Ymax(mstr,7))Ymax(mstr,7) = gelpy(iior) 
      if(gelpy(iior).lt.Ymin(mstr,7))Ymin(mstr,7) = gelpy(iior) 
      if(gsPy(iior).gt.Ymax(mstr,8))Ymax(mstr,8) = gsPy(iior) 
      if(gsPy(iior).lt.Ymin(mstr,8))Ymin(mstr,8) = gsPy(iior) 
      if(siy(iior).gt.Ymax(mstr,9))Ymax(mstr,9) = siy(iior) 
      if(siy(iior).lt.Ymin(mstr,9))Ymin(mstr,9) = siy(iior) 
      if(chlay(iior).gt.Ymax(mstr,10))Ymax(mstr,10) = chlay(iior) 
      if(chlay(iior).lt.Ymin(mstr,10))Ymin(mstr,10) = chlay(iior) 
      if(zooiny(iior).gt.Ymax(mstr,11))Ymax(mstr,11) = zooiny(iior) 
      if(zooiny(iior).lt.Ymin(mstr,11))Ymin(mstr,11) = zooiny(iior) 
      if(vphy(iior).gt.Ymax(mstr,12))Ymax(mstr,12) = vphy(iior) 
      if(vphy(iior).lt.Ymin(mstr,12))Ymin(mstr,12) = vphy(iior) 
      if(mwy(iior).gt.Ymax(mstr,13))Ymax(mstr,13) = mwy(iior) 
      if(mwy(iior).lt.Ymin(mstr,13))Ymin(mstr,13) = mwy(iior) 
      if(cay(iior).gt.Ymax(mstr,14))Ymax(mstr,14) = cay(iior) 
      if(cay(iior).lt.Ymin(mstr,14))Ymin(mstr,14) = cay(iior) 
      if(lfy(iior).gt.Ymax(mstr,15))Ymax(mstr,15) = lfy(iior) 
      if(lfy(iior).lt.Ymin(mstr,15))Ymin(mstr,15) = lfy(iior) 
      if(ssalgy(iior).gt.Ymax(mstr,16))Ymax(mstr,16) = ssalgy(iior) 
      if(ssalgy(iior).lt.Ymin(mstr,16))Ymin(mstr,16) = ssalgy(iior) 
      if(tempwy(iior).gt.Ymax(mstr,17))Ymax(mstr,17) = tempwy(iior) 
      if(tempwy(iior).lt.Ymin(mstr,17))Ymin(mstr,17) = tempwy(iior) 
      if(vo2y(iior).gt.Ymax(mstr,18))Ymax(mstr,18) = vo2y(iior) 
      if(vo2y(iior).lt.Ymin(mstr,18))Ymin(mstr,18) = vo2y(iior) 
      if(coliy(iior).gt.Ymax(mstr,19))Ymax(mstr,19) = coliy(iior) 
      if(coliy(iior).lt.Ymin(mstr,19))Ymin(mstr,19) = coliy(iior) 
      if(CHNFy(iior).le.0.0)then 
      Ymax(mstr,20) = -1. 
      Ymin(mstr,20) = -1 
      goto 139 
      endif 
      if(CHNFy(iior).gt.Ymax(mstr,20))Ymax(mstr,20) = CHNFy(iior) 
      if(CHNFy(iior).lt.Ymin(mstr,20))Ymin(mstr,20) = CHNFy(iior) 
  139 if(dly(iior).gt.Ymax(mstr,21))Ymax(mstr,21) = Dly(iior) 
      if(dly(iior).lt.Ymin(mstr,21))Ymin(mstr,21) = Dly(iior) 
      if(sedhy(mstr,iior).gt.Ymax(mstr,22))                             &
     &Ymax(mstr,22) = sedhy(mstr,iior)                                  
      if(sedhy(mstr,iior).lt.Ymin(mstr,22))                             &
     &Ymin(mstr,22) = sedhy(mstr,iior)                                  
      if(hpfl(mstr,iior).gt.Ymax(mstr,23))                              &
     &Ymax(mstr,23) = hpfl(mstr,iior)                                   
      if(hpfl(mstr,iior).lt.Ymin(mstr,23))                              &
     &Ymin(mstr,23) = hpfl(mstr,iior)                                   
      sbal = habgml(mstr,iior)+habkml(mstr,iior) 
      if(sbal.gt.Ymax(mstr,24))Ymax(mstr,24) = sbal 
      if(sbal.lt.Ymin(mstr,24))Ymin(mstr,24) = sbal 
      IF(hzdrel(mstr,iior,1).gt.Ymax(mstr,25))                          &
     &Ymax(mstr,25) = hzdrel(mstr,iior,1)                               
      if(hzdrsl(mstr,iior,1).gt.Ymax(mstr,25))                          &
     &Ymax(mstr,25) = hzdrsl(mstr,iior,1)                               
      IF(hzdrel(mstr,iior,1).lt.Ymin(mstr,25))                          &
     &Ymin(mstr,25) = hzdrel(mstr,iior,1)                               
      if(hzdrsl(mstr,iior,1).lt.Ymin(mstr,25))                          &
     &Ymin(mstr,25) = hzdrsl(mstr,iior,1)                               
      if(hgwdrl(mstr,iior,1).gt.Ymax(mstr,26))                          &
     &Ymax(mstr,26) = hgwdrl(mstr,iior,1)                               
      if(hgwdrl(mstr,iior,1).lt.Ymin(mstr,26))                          &
     &Ymin(mstr,26) = hgwdrl(mstr,iior,1)                               
      IF(hzdrel(mstr,iior,2).gt.Ymax(mstr,27))                          &
     &Ymax(mstr,27) = hzdrel(mstr,iior,2)                               
      if(hzdrsl(mstr,iior,2).gt.Ymax(mstr,27))                          &
     &Ymax(mstr,27) = hzdrsl(mstr,iior,2)                               
      IF(hzdrel(mstr,iior,2).lt.Ymin(mstr,27))                          &
     &Ymin(mstr,27) = hzdrel(mstr,iior,2)                               
      if(hzdrsl(mstr,iior,2).lt.Ymin(mstr,27))                          &
     &Ymin(mstr,27) = hzdrsl(mstr,iior,2)                               
      if(hgwdrl(mstr,iior,2).gt.Ymax(mstr,28))                          &
     &Ymax(mstr,28) = hgwdrl(mstr,iior,2)                               
      if(hgwdrl(mstr,iior,2).lt.Ymin(mstr,28))                          &
     &Ymin(mstr,28) = hgwdrl(mstr,iior,2)                               
      if(dlarny(iior).gt.Ymax(mstr,29))Ymax(mstr,29) = dlarny(iior) 
      if(dlarny(iior).lt.Ymin(mstr,29))Ymin(mstr,29) = dlarny(iior) 
      if(idrasy(iior,1).gt.Ymax(mstr,30))Ymax(mstr,30) = idrasy(iior,1) 
      if(idrasy(iior,1).lt.Ymin(mstr,30))Ymin(mstr,30) = idrasy(iior,1) 
      if(idrasy(iior,2).gt.Ymax(mstr,31))Ymax(mstr,31) = idrasy(iior,2) 
      if(idrasy(iior,2).lt.Ymin(mstr,31))Ymin(mstr,31) = idrasy(iior,2) 
      if(drmasy(iior,1).gt.Ymax(mstr,32))Ymax(mstr,32) = drmasy(iior,1) 
      if(drmasy(iior,1).lt.Ymin(mstr,32))Ymin(mstr,32) = drmasy(iior,1) 
      if(drmasy(iior,2).gt.Ymax(mstr,33))Ymax(mstr,33) = drmasy(iior,2) 
      if(drmasy(iior,2).lt.Ymin(mstr,33))Ymin(mstr,33) = drmasy(iior,2) 
      if(volfdy(iior).gt.Ymax(mstr,34))Ymax(mstr,34) = volfdy(iior) 
      if(volfdy(iior).lt.Ymin(mstr,34))Ymin(mstr,34) = volfdy(iior) 
      if(drakry(iior,1).gt.Ymax(mstr,35))Ymax(mstr,35) = drakry(iior,1) 
      if(drakry(iior,1).lt.Ymin(mstr,35))Ymin(mstr,35) = drakry(iior,1) 
      if(drakry(iior,2).gt.Ymax(mstr,36))Ymax(mstr,36) = drakry(iior,2) 
      if(drakry(iior,2).lt.Ymin(mstr,36))Ymin(mstr,36) = drakry(iior,2) 
      if(drbary(iior,1).gt.Ymax(mstr,37))Ymax(mstr,37) = drbary(iior,1) 
      if(drbary(iior,1).lt.Ymin(mstr,37))Ymin(mstr,37) = drbary(iior,1) 
      if(drbary(iior,2).gt.Ymax(mstr,38))Ymax(mstr,38) = drbary(iior,2) 
      if(drbary(iior,2).lt.Ymin(mstr,38))Ymin(mstr,38) = drbary(iior,2) 
      if(drmory(iior,1).gt.Ymax(mstr,39))Ymax(mstr,39) = drmory(iior,1) 
      if(drmory(iior,1).lt.Ymin(mstr,39))Ymin(mstr,39) = drmory(iior,1) 
      if(drmory(iior,2).gt.Ymax(mstr,40))Ymax(mstr,40) = drmory(iior,2) 
      if(drmory(iior,2).lt.Ymin(mstr,40))Ymin(mstr,40) = drmory(iior,2) 
      if(ffoody(iior).gt.Ymax(mstr,41))Ymax(mstr,41) = ffoody(iior) 
      if(ffoody(iior).lt.Ymin(mstr,41))Ymin(mstr,41) = ffoody(iior) 
      sco = hcoro2(mstr,iior,1)+hcoro2(mstr,iior,2)+hcoro2(mstr,iior,3) &
     &+hcoro2(mstr,iior,4)+hcoro2(mstr,iior,5)                          
      if(sco.gt.Ymax(mstr,42))Ymax(mstr,42) = sco 
      if(sco.lt.Ymin(mstr,42))Ymin(mstr,42) = sco 
      scoS = hcos2(mstr,iior,1)+hcos2(mstr,iior,2)+hcos2(mstr,iior,3)   &
     &+hcos2(mstr,iior,4)+hcos2(mstr,iior,5)                            
      if(scoS.gt.Ymax(mstr,43))Ymax(mstr,43) = scoS 
      if(scoS.lt.Ymin(mstr,43))Ymin(mstr,43) = scoS 
      salC = akiy(iior)*Caki+ably(iior)*Cabl+agry(iior)*Cagr 
      if(salC.gt.Ymax(mstr,44))Ymax(mstr,44) = salC 
      if(salC.lt.Ymin(mstr,44))Ymin(mstr,44) = salC 
      if((akiy(iior)+agry(iior)+ably(iior)).gt.0.0)                     &
     &salw = ((dalggy(iior)+dalgky(iior)+dalgby(iior))*24.)             &
     &/(akiy(iior)+agry(iior)+ably(iior))                               
      if(salw.gt.Ymax(mstr,45))Ymax(mstr,45) = salw 
      if(salw.lt.Ymin(mstr,45))Ymin(mstr,45) = salw 
      salR = ((dalagy(iior)+dalaky(iior)+dalaby(iior))*24.) 
                                                                        
      if(salR.gt.Ymax(mstr,46))Ymax(mstr,46) = salR 
      if(salR.lt.Ymin(mstr,46))Ymin(mstr,46) = salR 
      if((akiy(iior)+agry(iior)+ably(iior)).gt.0.0)                     &
     &salM = ((dgmory(iior)+dkmory(iior)+dbmory(iior))*24.)             &
     &/(akiy(iior)+agry(iior)+ably(iior))                               
      if(salM.gt.Ymax(mstr,47))Ymax(mstr,47) = salM 
      if(salM.lt.Ymin(mstr,47))Ymin(mstr,47) = salM 
      if((akiy(iior)+agry(iior)+ably(iior)).gt.0.0)                     &
     &salS = ((sedagy(iior)+sedaky(iior)+sedaby(iior))*24.)             &
     &/(akiy(iior)+agry(iior)+ably(iior))                               
      if(salS.gt.Ymax(mstr,48))Ymax(mstr,48) = salS 
      if(salS.lt.Ymin(mstr,48))Ymin(mstr,48) = salS 
      if((akiy(iior)+agry(iior)+ably(iior)).gt.0.0)                     &
     &salZ = ((algzgy(iior)+algzky(iior)+algzby(iior))*24.)             &
     &/(akiy(iior)+agry(iior)+ably(iior))                               
      if(salZ.gt.Ymax(mstr,49))Ymax(mstr,49) = salZ 
      if(salZ.lt.Ymin(mstr,49))Ymin(mstr,49) = salZ 
      if((akiy(iior)+agry(iior)+ably(iior)).gt.0.0)                     &
     &salD = ((algdgy(iior)+algdky(iior)+algdby(iior))*24.)             &
     &/(akiy(iior)+agry(iior)+ably(iior))                               
      if(salD.gt.Ymax(mstr,50))Ymax(mstr,50) = salD 
      if(salD.lt.Ymin(mstr,50))Ymin(mstr,50) = salD 
      if(drpfey(iior).gt.Ymax(mstr,51))Ymax(mstr,51) = drpfey(iior) 
      if(drpfey(iior).lt.Ymin(mstr,51))Ymin(mstr,51) = drpfey(iior) 
      ztp = tpkiy(iior)*vkigry(iior)+tpgry(iior)                        &
     &*(1.-vkigry(iior)-antbly(iior))+tpbly(iior)*antbly(iior)          
      if(ztp.gt.Ymax(mstr,52))Ymax(mstr,52) = ztp 
      if(ztp.lt.Ymin(mstr,52))Ymin(mstr,52) = ztp 
      if(vkigry(iior).gt.Ymax(mstr,53))Ymax(mstr,53) = vkigry(iior) 
      if(vkigry(iior).lt.Ymin(mstr,53))Ymin(mstr,53) = vkigry(iior) 
      if(antbly(iior).gt.Ymax(mstr,54))Ymax(mstr,54) = antbly(iior) 
      if(antbly(iior).lt.Ymin(mstr,54))Ymin(mstr,54) = antbly(iior) 
      if((akiy(iior)+agry(iior)+ably(iior)).gt.0.0)                     &
     &salco = ((algcgy(iior)+algcky(iior)+algcby(iior))*24.)            &
     &/(akiy(iior)+agry(iior)+ably(iior))                               
      if(salco.gt.Ymax(mstr,55))Ymax(mstr,55) = salco 
      if(salco.lt.Ymin(mstr,55))Ymin(mstr,55) = salco 
      if(fiy(iior).gt.Ymax(mstr,56))Ymax(mstr,56) = fiy(iior) 
      if(fiy(iior).lt.Ymin(mstr,56))Ymin(mstr,56) = fiy(iior) 
      if(extky(iior).gt.Ymax(mstr,57))Ymax(mstr,57) = extky(iior) 
      if(extky(iior).lt.Ymin(mstr,57))Ymin(mstr,57) = extky(iior) 
      if(fiby(iior).gt.Ymax(mstr,58))Ymax(mstr,58) = fiby(iior) 
      if(fiby(iior).lt.Ymin(mstr,58))Ymin(mstr,58) = fiby(iior) 
      if(akmuey(iior).gt.Ymax(mstr,59))Ymax(mstr,59) = akmuey(iior) 
      if(akmuey(iior).lt.Ymin(mstr,59))Ymin(mstr,59) = akmuey(iior) 
      if(agmuey(iior).gt.Ymax(mstr,60))Ymax(mstr,60) = agmuey(iior) 
      if(agmuey(iior).lt.Ymin(mstr,60))Ymin(mstr,60) = agmuey(iior) 
      if(abmuey(iior).gt.Ymax(mstr,61))Ymax(mstr,61) = abmuey(iior) 
      if(abmuey(iior).lt.Ymin(mstr,61))Ymin(mstr,61) = abmuey(iior) 
      if(fhey(iior).gt.Ymax(mstr,62))Ymax(mstr,62) = fhey(iior) 
      if(fhey(iior).lt.Ymin(mstr,62))Ymin(mstr,62) = fhey(iior) 
      if(fhegy(iior).gt.Ymax(mstr,63))Ymax(mstr,63) = fhegy(iior) 
      if(fhegy(iior).lt.Ymin(mstr,63))Ymin(mstr,63) = fhegy(iior) 
      if(fheby(iior).gt.Ymax(mstr,64))Ymax(mstr,64) = fheby(iior) 
      if(fheby(iior).lt.Ymin(mstr,64))Ymin(mstr,64) = fheby(iior) 
      if(akry(iior).gt.Ymax(mstr,65))Ymax(mstr,65) = akry(iior) 
      if(akry(iior).lt.Ymin(mstr,65))Ymin(mstr,65) = akry(iior) 
      if(agrey(iior).gt.Ymax(mstr,66))Ymax(mstr,66) = agrey(iior) 
      if(agrey(iior).lt.Ymin(mstr,66))Ymin(mstr,66) = agrey(iior) 
      if(abrey(iior).gt.Ymax(mstr,67))Ymax(mstr,67) = abrey(iior) 
      if(abrey(iior).lt.Ymin(mstr,67))Ymin(mstr,67) = abrey(iior) 
      if(chlaky(iior).gt.Ymax(mstr,68))Ymax(mstr,68) = chlaky(iior) 
      if(chlaky(iior).lt.Ymin(mstr,68))Ymin(mstr,68) = chlaky(iior) 
      if(chlagy(iior).gt.Ymax(mstr,69))Ymax(mstr,69) = chlagy(iior) 
      if(chlagy(iior).lt.Ymin(mstr,69))Ymin(mstr,69) = chlagy(iior) 
      if(chlaby(iior).gt.Ymax(mstr,70))Ymax(mstr,70) = chlaby(iior) 
      if(chlaby(iior).lt.Ymin(mstr,70))Ymin(mstr,70) = chlaby(iior) 
      if(iry(iior).gt.Ymax(mstr,71))Ymax(mstr,71) = iry(iior) 
      if(iry(iior).lt.Ymin(mstr,71))Ymin(mstr,71) = iry(iior) 
      if(rmuasy(iior).gt.Ymax(mstr,72))Ymax(mstr,72) = rmuasy(iior) 
      if(rmuasy(iior).lt.Ymin(mstr,72))Ymin(mstr,72) = rmuasy(iior) 
      if(rakry(iior).gt.Ymax(mstr,73))Ymax(mstr,73) = rakry(iior) 
      if(rakry(iior).lt.Ymin(mstr,73))Ymin(mstr,73) = rakry(iior) 
      if(rbary(iior).gt.Ymax(mstr,74))Ymax(mstr,74) = rbary(iior) 
      if(rbary(iior).lt.Ymin(mstr,74))Ymin(mstr,74) = rbary(iior) 
      cbsbab = vbsby(iior)-((chlay(iior)*vkigry(iior)*bsbki             &
     &+chlay(iior)*antbly(iior)*bsbbl+chlay(iior)                       &
     &*(1.-vkigry(iior)-antbly(iior))*bsbgr)+zooiny(iior)               &
     &*(GRote/1000.)*1.35)                                              
      if(cbsbab.gt.Ymax(mstr,75))Ymax(mstr,75) = cbsbab 
      if(cbsbab.lt.Ymin(mstr,75))Ymin(mstr,75) = cbsbab 
      abbau = -.1 
      if(iwsim.eq.3)abbau = vbsby(iior)/vcsby(iior) 
      if(abbau.gt.Ymax(mstr,76))Ymax(mstr,76) = abbau 
      if(abbau.lt.Ymin(mstr,76))Ymin(mstr,76) = abbau 
      if(CMy(iior).gt.Ymax(mstr,77))Ymax(mstr,77) = CMy(iior) 
      if(CMy(iior).lt.Ymin(mstr,77))Ymin(mstr,77) = CMy(iior) 
      if(BACy(iior).gt.Ymax(mstr,78))Ymax(mstr,78) = BACy(iior) 
      if(BACy(iior).lt.Ymin(mstr,78))Ymin(mstr,78) = BACy(iior) 
      if(CDy(1,iior).gt.Ymax(mstr,79))Ymax(mstr,79) = CDy(1,iior) 
      if(CDy(1,iior).lt.Ymin(mstr,79))Ymin(mstr,79) = CDy(1,iior) 
      if(CDy(2,iior).gt.Ymax(mstr,80))Ymax(mstr,80) = CDy(2,iior) 
      if(CDy(2,iior).lt.Ymin(mstr,80))Ymin(mstr,80) = CDy(2,iior) 
      if(CPy(1,iior).gt.Ymax(mstr,81))Ymax(mstr,81) = CPy(1,iior) 
      if(CPy(1,iior).lt.Ymin(mstr,81))Ymin(mstr,81) = CPy(1,iior) 
      if(CPy(2,iior).gt.Ymax(mstr,82))Ymax(mstr,82) = CPy(2,iior) 
      if(CPy(2,iior).lt.Ymin(mstr,82))Ymin(mstr,82) = CPy(2,iior) 
      if(BACmuy(iior).gt.Ymax(mstr,83))Ymax(mstr,83) = BACmuy(iior) 
      if(BACmuy(iior).lt.Ymin(mstr,83))Ymin(mstr,83) = BACmuy(iior) 
      if(HNFBAy(iior).gt.Ymax(mstr,84))Ymax(mstr,84) = HNFBAy(iior) 
      if(HNFBAy(iior).lt.Ymin(mstr,84))Ymin(mstr,84) = HNFBAy(iior) 
      if(BVHNFy(iior).le.0.0)then 
      Ymax(mstr,85) = -1 
      Ymin(mstr,85) = -1 
      goto 791 
      endif 
      HNFin = CHNFy(iior)*1.e6/(BVHNFy(iior)*0.22) 
      if(HNFin.gt.Ymax(mstr,85))Ymax(mstr,85) = HNFin 
      if(HNFin.lt.Ymin(mstr,85))Ymin(mstr,85) = HNFin 
  791 if(HNFupy(iior).gt.Ymax(mstr,86))Ymax(mstr,86) = HNFupy(iior) 
      if(HNFupy(iior).lt.Ymin(mstr,86))Ymin(mstr,86) = HNFupy(iior) 
      if(HNFrey(iior).gt.Ymax(mstr,87))Ymax(mstr,87) = HNFrey(iior) 
      if(HNFrey(iior).lt.Ymin(mstr,87))Ymin(mstr,87) = HNFrey(iior) 
      if(HNFexy(iior).gt.Ymax(mstr,88))Ymax(mstr,88) = HNFexy(iior) 
      if(HNFexy(iior).lt.Ymin(mstr,88))Ymin(mstr,88) = HNFexy(iior) 
      if(HNFmoy(iior).gt.Ymax(mstr,89))Ymax(mstr,89) = HNFmoy(iior) 
      if(HNFmoy(iior).lt.Ymin(mstr,89))Ymin(mstr,89) = HNFmoy(iior) 
      if(HNFmuy(iior).gt.Ymax(mstr,90))Ymax(mstr,90) = HNFmuy(iior) 
      if(HNFmuy(iior).lt.Ymin(mstr,90))Ymin(mstr,90) = HNFmuy(iior) 
      if(HNFzy(iior).gt.Ymax(mstr,91))Ymax(mstr,91) = HNFzy(iior) 
      if(HNFzy(iior).lt.Ymin(mstr,91))Ymin(mstr,91) = HNFzy(iior) 
      if(HNFdry(iior).gt.Ymax(mstr,92))Ymax(mstr,92) = HNFdry(iior) 
      if(HNFdry(iior).lt.Ymin(mstr,92))Ymin(mstr,92) = HNFdry(iior) 
      if(susny(iior).gt.Ymax(mstr,93))Ymax(mstr,93) = susny(iior) 
      if(susny(iior).lt.Ymin(mstr,93))Ymin(mstr,93) = susny(iior) 
      if(bettny(iior).gt.Ymax(mstr,94))Ymax(mstr,94) = bettny(iior) 
      if(bettny(iior).lt.Ymin(mstr,94))Ymin(mstr,94) = bettny(iior) 
      if(dony(iior).gt.Ymax(mstr,95))Ymax(mstr,95) = dony(iior) 
      if(dony(iior).lt.Ymin(mstr,95))Ymin(mstr,95) = dony(iior) 
      saN = agrn4y(iior)+akin4y(iior)+abln4y(iior) 
      if(saN.gt.Ymax(mstr,96))Ymax(mstr,96) = saN 
      if(saN.lt.Ymin(mstr,96))Ymin(mstr,96) = saN 
      if(FluN3y(iior).gt.Ymax(mstr,97))Ymax(mstr,97) = FluN3y(iior) 
      if(FluN3y(iior).lt.Ymin(mstr,97))Ymin(mstr,97) = FluN3y(iior) 
      vx0mue = vx0y(iior)*1000. 
      if(vx0mue.lt.0.0)vx0mue = -1. 
      if(vx0mue.gt.Ymax(mstr,98))Ymax(mstr,98) = vx0mue 
      if(vx0mue.lt.Ymin(mstr,98))Ymin(mstr,98) = vx0mue 
      if(sedx0y(iior).gt.Ymax(mstr,99))Ymax(mstr,99) = sedx0y(iior) 
      if(sedx0y(iior).lt.Ymin(mstr,99))Ymin(mstr,99) = sedx0y(iior) 
      vx02mu = vx02y(iior)*1000. 
      if(vx02mu.lt.0.0)vx02mu = -1. 
      if(vx02mu.gt.Ymax(mstr,100))ymax(mstr,100) = vx02mu 
      if(vx02mu.lt.Ymin(mstr,100))ymin(mstr,100) = vx02mu 
      Ymax(mstr,101) = (Ymax(mstr,93)+Ymax(mstr,94))*4.33 
      Ymin(mstr,101) = (Ymin(mstr,93)+Ymin(mstr,94))*4.33 
      if(dalgoy(iior).gt.Ymax(mstr,102))Ymax(mstr,102) = dalgoy(iior) 
      if(dalgoy(iior).lt.Ymin(mstr,102))Ymin(mstr,102) = dalgoy(iior) 
      if(dalaoy(iior).gt.Ymax(mstr,103))Ymax(mstr,103) = dalaoy(iior) 
      if(dalaoy(iior).lt.Ymin(mstr,103))Ymin(mstr,103) = dalaoy(iior) 
      if(bsbty(iior).gt.Ymax(mstr,104))Ymax(mstr,104) = bsbty(iior) 
      if(bsbty(iior).lt.Ymin(mstr,104))Ymin(mstr,104) = bsbty(iior) 
      if(schlry(iior).gt.Ymax(mstr,105))Ymax(mstr,105) = schlry(iior) 
      if(schlry(iior).lt.Ymin(mstr,105))Ymin(mstr,105) = schlry(iior) 
      if(bFlN3y(iior).gt.Ymax(mstr,106))Ymax(mstr,106) = bFlN3y(iior) 
      if(bFlN3y(iior).lt.Ymin(mstr,106))Ymin(mstr,106) = bFLN3y(iior) 
      if(bsbbey(iior).gt.Ymax(mstr,107))Ymax(mstr,107) = bsbbey(iior) 
      if(bsbbey(iior).lt.Ymin(mstr,107))Ymin(mstr,107) = bsbbey(iior) 
      if(o2ei1y(iior).gt.Ymax(mstr,108))Ymax(mstr,108) = o2ei1y(iior) 
      if(o2ei1y(iior).lt.Ymin(mstr,108))Ymin(mstr,108) = o2ei1y(iior) 
      sabow = abowgy(iior)+abowky(iior) 
      sabor = aborgy(iior)+aborky(iior) 
      if(sabow.gt.Ymax(mstr,109))Ymax(mstr,109) = sabow 
      if(sabow.lt.Ymin(mstr,109))Ymin(mstr,109) = sabow 
      if(sabor.gt.Ymax(mstr,110))Ymax(mstr,110) = sabor 
      if(sabor.lt.Ymin(mstr,110))Ymin(mstr,110) = sabor 
      if(ro2dry(iior).gt.Ymax(mstr,111))Ymax(mstr,111) = ro2dry(iior) 
      if(ro2dry(iior).lt.Ymin(mstr,111))Ymin(mstr,111) = ro2dry(iior) 
      if(zoro2y(iior).gt.Ymax(mstr,112))Ymax(mstr,112) = zoro2y(iior) 
      if(zoro2y(iior).lt.Ymin(mstr,112))Ymin(mstr,112) = zoro2y(iior) 
      if(po2py(iior).gt.Ymax(mstr,113))Ymax(mstr,113) = po2py(iior) 
      if(po2py(iior).lt.Ymin(mstr,113))Ymin(mstr,113) = po2py(iior) 
      if(po2ry(iior).gt.Ymax(mstr,114))Ymax(mstr,114) = po2ry(iior) 
      if(po2ry(iior).lt.Ymin(mstr,114))Ymin(mstr,114) = po2ry(iior) 
      if(tracer(iior).gt.Ymax(mstr,169))Ymax(mstr,169) = tracer(iior) 
      if(tracer(iior).lt.Ymin(mstr,169))Ymin(mstr,169) = tracer(iior) 
      if(bvbsby(iior).gt.Ymax(mstr,115))Ymax(mstr,115) = bvbsby(iior) 
      if(bvbsby(iior).lt.Ymin(mstr,115))Ymin(mstr,115) = bvbsby(iior) 
      if(bvcsby(iior).gt.Ymax(mstr,116))Ymax(mstr,116) = bvcsby(iior) 
      if(bvcsby(iior).lt.Ymin(mstr,116))Ymin(mstr,116) = bvcsby(iior) 
      if(bnh4y(iior).gt.Ymax(mstr,117))Ymax(mstr,117) = bnh4y(iior) 
      if(bnh4y(iior).lt.Ymin(mstr,117))Ymin(mstr,117) = bnh4y(iior) 
      if(bno2y(iior).gt.Ymax(mstr,118))Ymax(mstr,118) = bno2y(iior) 
      if(bno2y(iior).lt.Ymin(mstr,118))Ymin(mstr,118) = bno2y(iior) 
      if(bno3y(iior).gt.Ymax(mstr,119))Ymax(mstr,119) = bno3y(iior) 
      if(bno3y(iior).lt.Ymin(mstr,119))Ymin(mstr,119) = bno3y(iior) 
      if(bgsNy(iior).gt.Ymax(mstr,120))Ymax(mstr,120) = bgsNy(iior) 
      if(bgsNy(iior).lt.Ymin(mstr,120))Ymin(mstr,120) = bgsNy(iior) 
      if(bgelpy(iior).gt.Ymax(mstr,121))Ymax(mstr,121) = bgelpy(iior) 
      if(bgelpy(iior).lt.Ymin(mstr,121))Ymin(mstr,121) = bgelpy(iior) 
      if(bgsPy(iior).gt.Ymax(mstr,122))Ymax(mstr,122) = bgsPy(iior) 
      if(bgsPy(iior).lt.Ymin(mstr,122))Ymin(mstr,122) = bgsPy(iior) 
      if(bsiy(iior).gt.Ymax(mstr,123))Ymax(mstr,123) = bsiy(iior) 
      if(bsiy(iior).lt.Ymin(mstr,123))Ymin(mstr,123) = bsiy(iior) 
      if(bchlay(iior).gt.Ymax(mstr,124))Ymax(mstr,124) = bchlay(iior) 
      if(bchlay(iior).lt.Ymin(mstr,124))Ymin(mstr,124) = bchlay(iior) 
      if(bzooiy(iior).gt.Ymax(mstr,125))Ymax(mstr,125) = bzooiy(iior) 
      if(bzooiy(iior).lt.Ymin(mstr,125))Ymin(mstr,125) = bzooiy(iior) 
      if(bphy(iior).gt.Ymax(mstr,126))Ymax(mstr,126) = bphy(iior) 
      if(bphy(iior).lt.Ymin(mstr,126))Ymin(mstr,126) = bphy(iior) 
      if(bmwy(iior).gt.Ymax(mstr,127))Ymax(mstr,127) = bmwy(iior) 
      if(bmwy(iior).lt.Ymin(mstr,127))Ymin(mstr,127) = bmwy(iior) 
      if(bcay(iior).gt.Ymax(mstr,128))Ymax(mstr,128) = bcay(iior) 
      if(bcay(iior).lt.Ymin(mstr,128))Ymin(mstr,128) = bcay(iior) 
      if(blfy(iior).gt.Ymax(mstr,129))Ymax(mstr,129) = blfy(iior) 
      if(blfy(iior).lt.Ymin(mstr,129))Ymin(mstr,129) = blfy(iior) 
      if(bssaly(iior).gt.Ymax(mstr,130))Ymax(mstr,130) = bssaly(iior) 
      if(bssaly(iior).lt.Ymin(mstr,130))Ymin(mstr,130) = bssaly(iior) 
      if(btempy(iior).gt.Ymax(mstr,131))Ymax(mstr,131) = btempy(iior) 
      if(btempy(iior).lt.Ymin(mstr,131))Ymin(mstr,131) = btempy(iior) 
      if(bo2y(iior).gt.Ymax(mstr,132))Ymax(mstr,132) = bo2y(iior) 
      if(bo2y(iior).lt.Ymin(mstr,132))Ymin(mstr,132) = bo2y(iior) 
      Ymax(mstr,133) = -1. 
      Ymin(mstr,133) = -1. 
      if(bakiy(iior).le.0.0)bakiy(iior) = 0.0000000001 
      if(bagry(iior).le.0.0)bagry(iior) = 0.0000000001 
      if(bably(iior).le.0.0)bably(iior) = 0.0000000001 
      bakg = bakiy(iior)*Caki+bagry(iior)*Cagr+bably(iior)*Cabl 
      if(bakg.gt.Ymax(mstr,134))Ymax(mstr,134) = bakg 
      if(bakg.lt.Ymin(mstr,134))Ymin(mstr,134) = bakg 
      bdaW = (bdakiy(iior)+bdagry(iior)+bdably(iior))*24.               &
     &/(bakiy(iior)+bagry(iior)+bably(iior))                            
      if(bdaW.gt.Ymax(mstr,135))Ymax(mstr,135) = bdaW 
      if(bdaW.lt.Ymin(mstr,135))Ymin(mstr,135) = bdaW 
      bdaR = (bdaaky(iior)+bdaagy(iior)+bdaagy(iior))*24.               &
     &/(bakiy(iior)+bagry(iior)+bably(iior))                            
      if(bdaR.gt.Ymax(mstr,136))Ymax(mstr,136) = bdaR 
      if(bdaR.lt.Ymin(mstr,136))Ymin(mstr,136) = bdaR 
      baM = (bkmory(iior)+bgmory(iior)+bbmory(iior))*24.                &
     &/(bakiy(iior)+bagry(iior)+bably(iior))                            
      if(baM.gt.Ymax(mstr,137))Ymax(mstr,137) = baM 
      if(baM.lt.Ymin(mstr,137))Ymin(mstr,137) = baM 
      baS = (bsedky(iior)+bsedgy(iior)+bsedby(iior))*24.                &
     &/(bakiy(iior)+bagry(iior)+bably(iior))                            
      if(baS.gt.Ymax(mstr,138))Ymax(mstr,138) = baS 
      if(baS.lt.Ymin(mstr,138))Ymin(mstr,138) = baS 
      baZ = (bazoky(iior)+bazogy(iior)+bazoby(iior))*24.                &
     &/(bakiy(iior)+bagry(iior)+bably(iior))                            
      if(baZ.gt.Ymax(mstr,139))Ymax(mstr,139) = baZ 
      if(baZ.lt.Ymin(mstr,139))Ymin(mstr,139) = baZ 
      Ymax(mstr,140) = -1. 
      Ymin(mstr,140) = -1. 
      Ymax(mstr,141) = -1. 
      Ymin(mstr,141) = -1. 
      ztp = btpkiy(iior)*bkigry(iior)+btpgry(iior)                      &
     &*(1.-bkigry(iior)-bantby(iior))+btpbly(iior)*bantby(iior)         
      if(ztp.gt.Ymax(mstr,142))Ymax(mstr,142) = ztp 
      if(ztp.lt.Ymin(mstr,142))Ymin(mstr,142) = ztp 
      if(bkigry(iior).gt.Ymax(mstr,143))Ymax(mstr,143) = bkigry(iior) 
      if(bkigry(iior).lt.Ymin(mstr,143))Ymin(mstr,143) = bkigry(iior) 
      if(bantby(iior).gt.Ymax(mstr,144))Ymax(mstr,144) = bantby(iior) 
      if(bantby(iior).lt.Ymin(mstr,144))Ymin(mstr,144) = bantby(iior) 
      sBco = (bacoky(iior)+bacogy(iior)+bacoby(iior))*24. 
      if(sBco.gt.Ymax(mstr,145))Ymax(mstr,145) = sBco 
      if(sBco.lt.Ymin(mstr,145))Ymin(mstr,145) = sBco 
      if(bfikay(iior).gt.Ymax(mstr,146))Ymax(mstr,146) = bfikay(iior) 
      if(bfikay(iior).lt.Ymin(mstr,146))Ymin(mstr,146) = bfikay(iior) 
      if(bextky(iior).gt.Ymax(mstr,147))Ymax(mstr,147) = bextky(iior) 
      if(bextky(iior).lt.Ymin(mstr,147))Ymin(mstr,147) = bextky(iior) 
      if(bfibay(iior).gt.Ymax(mstr,148))Ymax(mstr,148) = bfibay(iior) 
      if(bfibay(iior).lt.Ymin(mstr,148))Ymin(mstr,148) = bfibay(iior) 
      if(bkmuay(iior).gt.Ymax(mstr,149))Ymax(mstr,149) = bkmuay(iior) 
      if(bkmuay(iior).lt.Ymin(mstr,149))Ymin(mstr,149) = bkmuay(iior) 
      if(bgmuay(iior).gt.Ymax(mstr,150))Ymax(mstr,150) = bgmuay(iior) 
      if(bgmuay(iior).lt.Ymin(mstr,150))Ymin(mstr,150) = bgmuay(iior) 
      if(bbmuay(iior).gt.Ymax(mstr,151))Ymax(mstr,151) = bbmuay(iior) 
      if(bbmuay(iior).lt.Ymin(mstr,151))Ymin(mstr,151) = bbmuay(iior) 
      if(bfhkay(iior).gt.Ymax(mstr,152))Ymax(mstr,152) = bfhkay(iior) 
      if(bfhkay(iior).lt.Ymin(mstr,152))Ymin(mstr,152) = bfhkay(iior) 
      if(bfhgay(iior).gt.Ymax(mstr,153))Ymax(mstr,153) = bfhgay(iior) 
      if(bfhgay(iior).lt.Ymin(mstr,153))Ymin(mstr,153) = bfhgay(iior) 
      if(bfhbay(iior).gt.Ymax(mstr,154))Ymax(mstr,154) = bfhbay(iior) 
      if(bfhbay(iior).lt.Ymin(mstr,154))Ymin(mstr,154) = bfhbay(iior) 
      if(bkray(iior).gt.Ymax(mstr,155))Ymax(mstr,155) = bkray(iior) 
      if(bkray(iior).lt.Ymin(mstr,155))Ymin(mstr,155) = bkray(iior) 
      if(bgray(iior).gt.Ymax(mstr,156))Ymax(mstr,156) = bgray(iior) 
      if(bgray(iior).lt.Ymin(mstr,156))Ymin(mstr,156) = bgray(iior) 
      if(bbray(iior).gt.Ymax(mstr,157))Ymax(mstr,157) = bbray(iior) 
      if(bbray(iior).lt.Ymin(mstr,157))Ymin(mstr,157) = bbray(iior) 
      if(bchlky(iior).gt.Ymax(mstr,158))Ymax(mstr,158) = bchlky(iior) 
      if(bchlky(iior).lt.Ymin(mstr,158))Ymin(mstr,158) = bchlky(iior) 
      if(bchlgy(iior).gt.Ymax(mstr,159))Ymax(mstr,159) = bchlgy(iior) 
      if(bchlgy(iior).lt.Ymin(mstr,159))Ymin(mstr,159) = bchlgy(iior) 
      if(bchlby(iior).gt.Ymax(mstr,160))Ymax(mstr,160) = bchlby(iior) 
      if(bchlby(iior).lt.Ymin(mstr,160))Ymin(mstr,160) = bchlby(iior) 
      if(tau2y(iior).gt.Ymax(mstr,168))Ymax(mstr,168) = tau2y(iior) 
      if(tau2y(iior).lt.Ymin(mstr,168))Ymin(mstr,168) = tau2y(iior) 
      if(btracer(iior).gt.Ymax(mstr,170))Ymax(mstr,170) = btracer(iior) 
      if(btracer(iior).lt.Ymin(mstr,170))Ymin(mstr,170) = btracer(iior) 
      if(bbetNy(iior).gt.Ymax(mstr,173))Ymax(mstr,173) = bbetNy(iior) 
      if(bbetNy(iior).lt.Ymin(mstr,173))Ymin(mstr,173) = bbetNy(iior) 
      if(bJNO3y(iior).gt.Ymax(mstr,176))Ymax(mstr,176) = bJNO3y(iior) 
      if(bJNO3y(iior).lt.Ymin(mstr,176))Ymin(mstr,176) = bJNO3y(iior) 
      if(bJNH4y(iior).gt.Ymax(mstr,178))Ymax(mstr,178) = bJNH4y(iior) 
      if(bJNH4y(iior).lt.Ymin(mstr,178))Ymin(mstr,178) = bJNH4y(iior) 
      if(bJPO4y(iior).gt.Ymax(mstr,180))Ymax(mstr,180) = bJPO4y(iior) 
      if(bJPO4y(iior).lt.Ymin(mstr,180))Ymin(mstr,180) = bJPO4y(iior) 
      if(bJO2y(iior).gt.Ymax(mstr,182))Ymax(mstr,182) = bJO2y(iior) 
      if(bJO2y(iior).lt.Ymin(mstr,182))Ymin(mstr,182) = bJO2y(iior) 
                                                                        
      Ymax(mstr,171) = -1. 
      Ymin(mstr,171) = -1. 
      if(alNO3y(iior).gt.Ymax(mstr,174))Ymax(mstr,174) = alNO3y(iior) 
      if(alNO3y(iior).lt.Ymin(mstr,174))Ymin(mstr,174) = alNO3y(iior) 
      if(JNO3y(iior).gt.Ymax(mstr,175))Ymax(mstr,175) = JNO3y(iior) 
      if(JNO3y(iior).lt.Ymin(mstr,175))Ymin(mstr,175) = JNO3y(iior) 
      if(JNH4y(iior).gt.Ymax(mstr,177))Ymax(mstr,177) = JNH4y(iior) 
      if(JNH4y(iior).lt.Ymin(mstr,177))Ymin(mstr,177) = JNH4y(iior) 
      if(JPO4y(iior).gt.Ymax(mstr,179))Ymax(mstr,179) = JPO4y(iior) 
      if(JPO4y(iior).lt.Ymin(mstr,179))Ymin(mstr,179) = JPO4y(iior) 
      if(JO2y(iior).gt.Ymax(mstr,181))Ymax(mstr,181) = JO2y(iior) 
      if(JO2y(iior).lt.Ymin(mstr,181))Ymin(mstr,181) = JO2y(iior) 
                                                                        
  748 continue 
  734 continue 
                                                                        
      if(maus.eq.1)goto 105 
      goto 9999 
!                                                                       
!                                                                       
! ++++++++Ausgabe der Mittelwerte++++++++++++                           
!                                                                       
  105 continue 
!      itime = itimeh                                                   
      maus = 0 
      ij = 1 
!                                                                       
!....it_h - Anzahl der Zeitschritt in der Hellphase                     
!                                                                       
      hcon = izdt/60. 
      hconit = (SU-SA)/hcon 
      if(ianfan.eq.1.and.uhrs.gt.SA.and.uhrs.lt.SU)                     &
     &hconit = (SU-uhrs)/hcon                                           
      if(iend.eq.1.and.uhren.gt.SA.and.uhren.lt.SU)                     &
     &hconit = (uhren-SA)/hcon                                          
      it_h = int(hconit) 
!      if((hconit-it_h).gt.0.02)it_h = it_h + 1                         
      ianfan = 0 
!                                                                       
 5454 do 578 azStr = 1,azStrs 
      mstr = mstra(azStr) 
      do 110 iior=1,mStas(mstr) 
!                                                                       
      xtempw = sumte(mstr,iior)/itime 
      xCHNF = sCHNF(mstr,iior)/itime 
      xBVHNF = sBVHNF(mstr,iior)/itime 
      xCD1 = sCD(mstr,1,iior)/itime 
      xCD2 = sCD(mstr,2,iior)/itime 
      xCP1 = sCP(mstr,1,iior)/itime 
      xCP2 = sCP(mstr,2,iior)/itime 
      xCM = sCM(mstr,iior)/itime 
      xBAC = sBAC(mstr,iior)/itime 
!                                                                       
      xbsb5 = sumb5(mstr,iior)/itime 
      xcsb = sumcs(mstr,iior)/itime 
      xnh4 = sumn4(mstr,iior)/itime 
      xchla = sumca(mstr,iior)/itime 
      xvkigr = svkigr(mstr,iior)/itime 
      xantbl = santbl(mstr,iior)/itime 
      xaki = sumaki(mstr,iior)/itime 
      xagr = sumagr(mstr,iior)/itime 
      xabl = sumabl(mstr,iior)/itime 
      xchlak = sumcak(mstr,iior)/itime 
      xchlag = sumcag(mstr,iior)/itime 
      xchlab = sumcab(mstr,iior)/itime 
      xo2 = sumo2(mstr,iior)/itime 
      xzooind = sumzo(mstr,iior)/itime 
      xvph = sumvph(mstr,iior)/itime 
      xvno3 = sumno3(mstr,iior)/itime 
      xvno2 = sumno2(mstr,iior)/itime 
      xgelp = sumgp(mstr,iior)/itime 
      xsi = sumsi(mstr,iior)/itime 
      xca = sumcal(mstr,iior)/itime 
      xmw = summw(mstr,iior)/itime 
      xlf = sumlf(mstr,iior)/itime 
      xcoli = scoli(mstr,iior)/itime 
!....Der Grenzwert fr Badegewsser (EG-Richtlinie 76/160)              
      BGGRW = 2000. 
!                                                                       
      xdlarn = sumdln(mstr,iior)/itime 
      xss = sumss(mstr,iior)/itime 
      xpfl = sumpfl(mstr,iior)/itime 
      xgsP = sgsP(mstr,iior)/itime 
      xgsN = sgsN(mstr,iior)/itime 
      do 837 ndr=1,nndr 
      xidras(ndr) = sidras(mstr,iior,ndr)/itime 
      xdrmas(ndr) = sdrmas(mstr,iior,ndr)/itime 
      xdrakr(ndr) = sdrakr(mstr,iior,ndr)/itime 
      xdrbar(ndr) = sdrbar(mstr,iior,ndr)/itime 
      xdrmor(ndr) = sdrmor(mstr,iior,ndr)/itime 
      xdrbio(ndr) = szdrg(mstr,iior,ndr)/itime 
      xdbios(ndr) = szdrsg(mstr,iior,ndr)/itime 
  837 xgewdr(ndr) = sgwdrg(mstr,iior,ndr)/itime 
!                                                                       
      xcorI = scorIg(mstr,iior)/itime 
      xcorIs = scoIsg(mstr,iior)/itime 
!                                                                       
      xbal = sumbal(mstr,iior)/itime 
      xsusn = ssusn(mstr,iior)/itime 
      xbettn = sbettn(mstr,iior)/itime 
      xdon = sdon(mstr,iior)/itime 
      xalgn = salgn(mstr,iior)/itime 
      xalNO3 = salNO3(mstr,iior)/itime 
      xFluN3 = sFluN3(mstr,iior)/itime 
      xvx0 = (svx0(mstr,iior)/itime)*1000. 
      if(xvx0.lt.0.0)xvx0 = -1. 
      xvx02 = (svx02(mstr,iior)/itime)*1000. 
      if(xvx02.lt.0.0)xvx02 = -1. 
      xsedx = ssedx0(mstr,iior)/itime 
      xsedal = ssedal(mstr,iior)/itime 
      xalgzo = salgzo(mstr,iior)/itime 
      xalgdr = salgdr(mstr,iior)/itime 
      xalgco = salgco(mstr,iior)/itime 
      xvoldr = svoldr(mstr,iior)/itime 
      xdrpfe = sdrpfe(mstr,iior)/itime 
      xabeow = sabeow(mstr,iior)/itime 
      xabeor = sabeor(mstr,iior)/itime 
      xdalg = sdalg(mstr,iior)/itime 
      xdalga = sdalga(mstr,iior)/itime 
      xalmor = salmor(mstr,iior)/itime 
      xblmor = sblmor(mstr,iior)/itime 
      xsgo2n = ssgo2n(mstr,iior)/itime 
      xsdbsb = ssdbsb(mstr,iior)/itime 
      xsoein = ssoein(mstr,iior)/itime 
      xsalgo = ssalgo(mstr,iior)/itime 
!                                                                       
!                                                                       
      xo2nit = xsusn*4.33 
      xalgo = s2algo(mstr,iior)/itime 
      xalgao = s2algao(mstr,iior)/itime 
      xbsbt = sbsbt(mstr,iior)/itime 
      xschlr = sschlr(mstr,iior)/itime 
      xbsbbe = sbsbbe(mstr,iior)/itime 
      xo2phy = so2phy(mstr,iior)/itime 
      xro2dr = sro2dr(mstr,iior)/itime 
      xzooro = szooro(mstr,iior)/itime 
      xpo2p = spo2p(mstr,iior)/itime 
      xpo2r = spo2r(mstr,iior)/itime 
      xir = sir(mstr,iior)/itime 
      xrmue = srmue(mstr,iior)/itime 
      xrakr = srakr(mstr,iior)/itime 
      xrbar = srbar(mstr,iior)/itime 
      xffood = sffood(mstr,iior)/itime 
      xfik = sfik(mstr,iior)/it_h 
      xfig = sfig(mstr,iior)/itime 
      xfib = -1. 
      xnaehr = snaehr(mstr,iior)/it_h 
      xakmua = sakmua(mstr,iior)/itime 
      xagmua = sagmua(mstr,iior)/itime 
      xabmua = sabmua(mstr,iior)/itime 
      xfhek = sfheka(mstr,iior)/itime 
      xfheg = sfhega(mstr,iior)/itime 
      xfheb = sfheba(mstr,iior)/itime 
      xakrau = sakrau(mstr,iior)/itime 
      xagrea = sagrea(mstr,iior)/itime 
      xabrea = sabrea(mstr,iior)/itime 
      xHNFmu = sHNFmu(mstr,iior)/itime 
      xHNFre = sHNFre(mstr,iior)/itime 
      xHNFup = sHNFup(mstr,iior)/itime 
      xHNFmo = sHNFmo(mstr,iior)/itime 
      xHNFex = sHNFex(mstr,iior)/itime 
      xHNFdr = sHNFdr(mstr,iior)/itime 
      xHNFz = sHNFz(mstr,iior)/itime 
      xBACmu = sBACmu(mstr,iior)/itime 
      xHNFBA = sHNFBA(mstr,iior)/itime 
      xnl0 = snl0(mstr,iior)/itime 
      xpl0 = spl0(mstr,iior)/itime 
      xJNO3 = sJNO3(mstr,iior)/itime 
      xJNH4 = sJNH4(mstr,iior)/itime 
      xJPO4 = sJPO4(mstr,iior)/itime 
      xJO2 = sJO2(mstr,iior)/itime 
!                                                                       
      if(iwsim.eq.4.or.iwsim.eq.2)goto 891 
      if((xaki+xagr+xabl).le.0.0)then 
      xalgdr = 0.0 
      xalgzo = 0.0 
      xdalg = 0.0 
      xdalga = 0.0 
      xalmor = 0.0 
      xsedal = 0.0 
      xalgco = 0.0 
      goto 892 
      endif 
      xalgdr = xalgdr*(1./tflie)/(xaki+xagr+xabl) 
      xalgzo = xalgzo*(1./tflie)/(xaki+xagr+xabl) 
      xdalg = xdalg*(1./tflie)/(xaki+xagr+xabl) 
      xdalga = xdalga*(1./tflie)/(xaki+xagr+xabl) 
      xalmor = xalmor*(1./tflie)/(xaki+xagr+xabl) 
      xsedal = xsedal*(1./tflie)/(xaki+xagr+xabl) 
      xalgco = xalgco*(1./tflie)/(xaki+xagr+xabl) 
      xakigr = xaki*Caki+xabl*Cabl+xagr*Cagr 
!                                                                       
  892 cbsbab = xbsb5-((xchla*xvkigr*bsbki+xchla*xantbl*bsbbl+           &
     &xchla*(1.-xvkigr-xantbl)*bsbgr)+xzooind*(GRote/1000.)*1.35)       
!                                                                       
!     Berechnung der Abbaubarkeit                                       
!                                                                       
      abbau = xbsb5/xcsb 
!                                                                       
      if(xBVHNF.le.0.0)then 
      xCHNFi = -1. 
      xCHNF = -1. 
      goto 891 
      endif 
!                                                                       
!.....Umrechnung in Zellzahlen                                          
!                                                                       
      xCHNFi = xCHNF*1.e6/(xBVHNF*0.22) 
!.....xCHNF in æg/l                                                     
      xCHNF = xCHNF*1000. 
!                                                                       
!                                                                       
!     Buhnenfelder                                                      
!                                                                       
  891 if(nbuhn(mstr).eq.1)then 
      bxtemp = bste(mstr,iior)/itime 
      bxno3 = bsno3(mstr,iior)/itime 
      bxno2 = bsno2(mstr,iior)/itime 
      bxnh4 = bsn4(mstr,iior)/itime 
      bxgelp = bsgelp(mstr,iior)/itime 
      bxchla = bschla(mstr,iior)/itime 
      bxssal = bsssal(mstr,iior)/itime 
      bxsi = bssi(mstr,iior)/itime 
      bxzooi = bszooi(mstr,iior)/itime 
      bxbsb5 = bsvbsb(mstr,iior)/itime 
      bxcsb = bsvcsb(mstr,iior)/itime 
      bxaki = bsaki(mstr,iior)/itime 
      bxagr = bsagr(mstr,iior)/itime 
      bxabl = bsabl(mstr,iior)/itime 
      bxo2 = bso2(mstr,iior)/itime 
      bxph = bsph(mstr,iior)/itime 
      bxca = bsca(mstr,iior)/itime 
      bxmw = bsmw(mstr,iior)/itime 
      bxlf = bslf(mstr,iior)/itime 
      bxlarn = 0.0 
      bxssal = bsssal(mstr,iior)/itime 
      bxnl0 = bsnl0(mstr,iior)/itime 
      bxpl0 = bspl0(mstr,iior)/itime 
      bxgsP = bsgsP(mstr,iior)/itime 
      bxgsN = bsgsN(mstr,iior)/itime 
!......Raten                                                            
      bxdalg = bsdalg(mstr,iior)/itime 
      bxvkg = bsvkg(mstr,iior)/itime 
      bxantb = bsantb(mstr,iior)/itime 
      bxdaa = bsdaa(mstr,iior)/itime 
      bxamor = bsamor(mstr,iior)/itime 
      bxseda = bsseda(mstr,iior)/itime 
      bxalgz = bsalgz(mstr,iior)/itime 
      bxaldr = bsadr(mstr,iior)/itime 
      bxalco = bsalco(mstr,iior)/itime 
      bxfik = bsfik(mstr,iior)/it_h 
      bxfig = bsfig(mstr,iior)/itime 
      xbnaeh = bnaehr(mstr,iior)/it_h 
      bxkmue = bskmue(mstr,iior)/itime 
      bxgmue = bsgmue(mstr,iior)/itime 
      bxbmue = bsbmue(mstr,iior)/itime 
      bxhek = bshek(mstr,iior)/itime 
      bxheg = bsheg(mstr,iior)/itime 
      bxheb = bsheb(mstr,iior)/itime 
      bxkre = bskre(mstr,iior)/itime 
      bxgre = bsgre(mstr,iior)/itime 
      bxbre = bsbre(mstr,iior)/itime 
      bxchlk = bschlk(mstr,iior)/itime 
      bxchlg = bschlg(mstr,iior)/itime 
      bxchlb = bschlb(mstr,iior)/itime 
      bxFLN3 = bsFlN3(mstr,iior)/itime 
      bxBetN = bsbetN(mstr,iior)/itime 
      bxJNO3 = bsJNO3(mstr,iior)/itime 
      bxJNH4 = bsJNH4(mstr,iior)/itime 
      bxJPO4 = bsJPO4(mstr,iior)/itime 
      bxJO2 = bsJO2(mstr,iior)/itime 
!                                                                       
      bxaldr = bxaldr*24./(bxaki+bxagr+bxabl) 
      bxalco = bxalco*24./(bxaki+bxagr+bxabl) 
      bxalgz = bxalgz*24./(bxaki+bxagr+bxabl) 
      bxdalg = bxdalg*24./(bxaki+bxagr+bxabl) 
      bxdaa = bxdaa*24./(bxaki+bxagr+bxabl) 
      bxamor = bxamor*24./(bxaki+bxagr+bxabl) 
      bxseda = bxseda*24./(bxaki+bxagr+bxabl) 
      bxakg = bxaki*Caki+bxabl*Cabl+bxagr*Cagr 
!                                                                       
      endif 
!                                                                       
      if(nbuhn(mstr).eq.0)then 
      bmibsb(mstr,iior) = -1. 
      bxbsb5 = -1. 
      bmxbsb(mstr,iior) = -1. 
      bmicsb(mstr,iior) = -1. 
      bxcsb = -1. 
      bmxcsb(mstr,iior) = -1. 
      bminh4(mstr,iior) = -1 
      bxnh4 = -1. 
      bmxnh4(mstr,iior) = -1. 
      bmino2(mstr,iior) = -1. 
      bxno2 = -1. 
      bmxno2(mstr,iior) = -1. 
      bmino3(mstr,iior) = -1. 
      bxno3 = -1. 
      bmxno3(mstr,iior) = -1. 
      bmigsN(mstr,iior) = -1. 
      bxgsN = -1. 
      bmxgsN(mstr,iior) = -1. 
      bmiglp(mstr,iior) = -1. 
      bxgelp = -1. 
      bmxglp(mstr,iior) = -1. 
      bmigsP(mstr,iior) = -1. 
      bxgsP = -1. 
      bmxgsP(mstr,iior) = -1. 
      bmisi(mstr,iior) = -1. 
      bxsi = -1. 
      bmxsi(mstr,iior) = -1. 
      bmichl(mstr,iior) = -1. 
      bxchla = -1. 
      bmxchl(mstr,iior) = -1. 
      bmizoo(mstr,iior) = -1. 
      bxzooi = -1. 
      bmxzoo(mstr,iior) = -1. 
      bmiph(mstr,iior) = -1. 
      bxph = -1. 
      bmxph(mstr,iior) = -1. 
      bmimw(mstr,iior) = -1. 
      bxmw = -1. 
      bmxmw(mstr,iior) = -1. 
      bmica(mstr,iior) = -1. 
      bxca = -1. 
      bmxca(mstr,iior) = -1. 
      bmilf(mstr,iior) = -1. 
      bxlf = -1. 
      bmxlf(mstr,iior) = -1. 
      bmissa(mstr,iior) = -1. 
      bxssal = -1. 
      bmxssa(mstr,iior) = -1. 
      bmitem(mstr,iior) = -1. 
      bxtemp = -1. 
      bmxtem(mstr,iior) = -1. 
      bmio2(mstr,iior) = -1. 
      bxo2 = -1. 
        bmxo2(mstr,iior) = -1. 
!                                                                       
!...Raten                                                               
!                                                                       
      bxakg = -1. 
      bxdalg = -1. 
      bxdaa = -1. 
      bxamor = -1. 
      bxseda = -1. 
      bxalgz = -1. 
      bxaldr = -1. 
      bxdrpf = -1. 
      bxvkg = -1. 
      bxantb = -1. 
      bxalco = 0.0 
      bxfik = -1. 
      bxfig = -1. 
      bxfib = -1. 
      bxkmue = -1. 
      bxgmue = -1. 
      bxbmue = -1. 
      bxhek = -1. 
      bxheg = -1. 
      bxheb = -1. 
      bxkre = -1. 
      bxgre = -1. 
      bxbre = -1. 
      bxchlk = -1. 
      bxchlg = -1. 
      bxchlb = -1. 
      bxantb = -1. 
      bxFlN3 = -.1 
      bxBetN = -.1 
      bxJNO3 = -.1 
      bxJNH4 = -.1 
!                                                                       
      endif 
!                                                                       
      bxcoli = -1. 
!                                                                       
!                                                                       
!....Ausgabe Dreissena Bschung                                         
      if(xdrbio(2).eq.0.0.and.xdbios(2).gt.0.0)then 
      xdrbio(1) = xdbios(1) 
      xdrbio(2) = xdbios(2) 
      endif 
!                                                                       
      write(45,4100)itags,monats,Jahrs,mstr,Stakm(mstr,iior)            &
     &,STRID(mstr)                                                      
!                                                                       
      write(45,4103)mib5(mstr,iior),xbsb5,mxb5(mstr,iior)               &
     &,mics(mstr,iior),xcsb,mxcs(mstr,iior),minh4(mstr,iior)            &
     &,xnh4,mxnh4(mstr,iior),mivno2(mstr,iior),xvno2                    &
     &,mxvno2(mstr,iior),mivno3(mstr,iior),xvno3,mxvno3(mstr,iior)      &
     &,migsN(mstr,iior),xgsN,mxgsN(mstr,iior),migP(mstr,iior)           &
     &,xgelp,mxgp(mstr,iior),migsP(mstr,iior),xgsP,mxgsP(mstr,iior)     &
     &,miSi(mstr,iior),xSi,mxSi(mstr,iior),miChla(mstr,iior),xchla      &
     &,mxchla(mstr,iior),mizo(mstr,iior),xzooind,mxzo(mstr,iior)        &
     &,mivph(mstr,iior),xvph,mxvph(mstr,iior),mimw(mstr,iior)           &
     &,xmw,mxmw(mstr,iior),mica(mstr,iior),xca,mxca(mstr,iior)          &
     &,miLf(mstr,iior),xLf,mxLf(mstr,iior),miSS(mstr,iior),xSS          &
     &,mxSS(mstr,iior),mitemp(mstr,iior),xtempw,mxtemp(mstr,iior)       &
     &,miO2(mstr,iior),xO2,mxO2(mstr,iior),miColi(mstr,iior)            &
     &,xColi,mxColi(mstr,iior)                                          
!                                                                       
      write(45,4001)xPfl 
!                                                                       
      write(45,4002)xbal 
!                                                                       
      write(45,4365)xDrBio(1),xgewdr(1),XDrBio(2),xgewdr(2),xdlarn      &
     &,xidras(1),xidras(2),xdrmas(1),xdrmas(2)                          &
     &,xvoldr,xdrakr(1),xdrakr(2),xdrbar(1),xdrbar(2),xdrmor(1)         &
     &,xdrmor(2),xffood                                                 
!                                                                       
      write(45,4004)xCorI,xCorIs 
!                                                                       
      write(45,4010)xakigr,xdalg,xdalga,xalmor,xsedal,xalgzo,xalgdr     &
     &,xdrpfe,xnaehr,xvkigr,xantbl,xalgco,xfik,xfig,xfib                &
     &,xakmua,xagmua,xabmua,xfhek,xfheg,xfheb,xakrau,xagrea             &
     &,xabrea,xchlak,xchlag,xchlab                                      
!                                                                       
      write(45,4265)xir,xRmue,xrakr,xrbar 
!                                                                       
      write(45,4111)cbsbab,abbau,xCM,xBAC,xCD1,xCD2,xCP1,xCP2           &
     &,xBACmu,(xHNFBA*24.)                                              
!                                                                       
      write(45,4215)xCHNFi,xCHNF,xHNFup,xHNFre,xHNFex                   &
     &,xHNFmo,xHNFmu,xHNFz,xHNFdr                                       
!                                                                       
      write(45,4003)xsusn,xbettn,xdon,xalgn,xalNO3                      &
     &,xFluN3,xJNO3,xJNH4,xvx0,xsedx,xvx02                              
!                                                                       
      write(45,4020)xJPO4 
!                                                                       
      write(45,4017)xo2nit,xalgo,xalgao,xbsbt,xschlr,xJO2               &
     &,xbsbbe,xo2phy,xabeow,xabeor,xro2dr,xzooro,xpo2p,xpo2r            
!                                                                       
      write(45,4018)sedhy(mstr,iior) 
!                                                                       
      bxmicl = bxcoli 
      bxmxcl = bxcoli 
      write(45,4103)bmibsb(mstr,iior),bxbsb5,bmxbsb(mstr,iior)          &
     &,bmicsb(mstr,iior),bxcsb,bmxcsb(mstr,iior),bminh4(mstr,iior)      &
     &,bxnh4,bmxnh4(mstr,iior),bmino2(mstr,iior),bxno2                  &
     &,bmxno2(mstr,iior),bmino3(mstr,iior),bxno3,bmxno3(mstr,iior)      &
     &,bmigsN(mstr,iior),bxgsN,bmxgsN(mstr,iior),bmiglp(mstr,iior)      &
     &,bxgelp,bmxglp(mstr,iior),bmigsP(mstr,iior),bxgsP                 &
     &,bmxgsP(mstr,iior),bmisi(mstr,iior),bxsi,bmxsi(mstr,iior)         &
     &,bmichl(mstr,iior),bxchla,bmxchl(mstr,iior),bmizoo(mstr,iior)     &
     &,bxzooi,bmxzoo(mstr,iior),bmiph(mstr,iior),bxph,bmxph(mstr,iior)  &
     &,bmimw(mstr,iior),bxmw,bmxmw(mstr,iior),bmica(mstr,iior),bxca     &
     &,bmxca(mstr,iior),bmilf(mstr,iior),bxlf,bmxlf(mstr,iior)          &
     &,bmissa(mstr,iior),bxssal,bmxssa(mstr,iior),bmitem(mstr,iior)     &
     &,bxtemp,bmxtem(mstr,iior),bmio2(mstr,iior),bxo2,bmxo2(mstr,iior)  &
     &,bxmicl,bxcoli,bxmxcl                                             
!                                                                       
      write(45,4010)bxakg,bxdalg,bxdaa,bxamor                           &
     &,bxseda,bxalgz,bxaldr,bxdrpf,xbnaeh,bxvkg                         &
     &,bxantb,bxalco,bxfik,bxfig,bxfib                                  &
     &,bxkmue,bxgmue,bxbmue,bxhek,bxheg,bxheb,bxkre,bxgre,bxbre         &
     &,bxchlk,bxchlg,bxchlb                                             
!                                                                       
      write(45,4011)bxFlN3,bxJNO3,bxJNH4,bxBetN 
!                                                                       
      write(45,4020)bxJPO4 
!                                                                       
      write(45,4021)bxJO2 
!                                                                       
!                                                                       
 4100 FORMAT(I2,2x,I2,2x,I4,2x,I5,2x,f8.3,2x,I5) 
 4103 FORMAT(3(f6.2,2x),3(f6.2,2x),3(f6.2,2x),3(f6.3,2x),3(f9.6,2x)     &
     &,3(f5.2,2x),3(f6.3,2x),3(f5.2,2x),3(f5.2,2x),3(f6.2,2x)           &
     &,3(f7.1,2x),3(f5.2,2x),3(f5.2,2x),3(f5.1,2x),3(f8.1,2x)           &
     &,3(f6.2,2x),3(f5.2,2x),3(f5.2,2x),2(f8.0,2x),f8.0)                
 4001 FORMAT(F7.2) 
 4002 FORMAT(f7.2) 
 4365 FORMAT(f7.2,2x,f7.2,2x,f7.2,2x,f7.2,2x,f7.2,2x,f6.3,2x,f6.3       &
     &,2x,f6.3,2x,f6.3,2x,f7.3,2x,f7.5,2x,f7.5,2x,f7.5,2x,f7.5          &
     &,2x,f7.5,2x,f7.5,2x,f5.3)                                         
 4004 FORMAT(f8.1,2x,f8.1) 
 4010 FORMAT(f6.2,2x,f8.5,2x,f8.5,2x,f8.5,2x,f8.5,2x,f8.5,2x,f8.5       &
     &,2x,f6.2,2x,f5.2,2x,f5.2,2x,f5.2,2x,f10.8,2x,f5.2                 &
     &,2x,f5.2,2x,f5.2,2x,f6.3,2x,f6.3,2x,f6.3,2x,f6.3                  &
     &,2x,f6.3,2x,f6.3,2x,f6.3,2x,f6.3,2x,f6.3                          &
     &,2x,f6.1,2x,f6.1,2x,f6.1)                                         
 4011 Format(F8.6,2x,F10.8,2x,f10.8,2x,F8.6) 
 4265 FORMAT(f6.3,2x,f6.3,2x,f6.4,2x,f6.4) 
 4111 FORMAT(f6.3,2x,f5.3,2x,f6.3,2x,f6.3,2x,f7.3,2x,f7.3,2x            &
     &,f7.3,2x,f7.3,2x,f6.3,2x,f6.3)                                    
 4215 FORMAT(f8.1,2x,f7.3,2x,f6.3,2x,f6.3,2x,f6.3,2x,f6.3,2x            &
     &,f6.3,2x,f6.3,2x,f6.3)                                            
 4003 FORMAT(f7.5,2x,f10.8,2x,f7.5,2x,f7.5,2x,F7.5                      &
     &,2x,f10.8,2x,f10.8,2x,f10.8,2x,f8.5,2x,f6.3,2x,f8.5)              
 4017 FORMAT(f7.4,2x,f7.4,2x,f7.4,2x,f7.4,2x,f10.8,2x,f10.8             &
     &,2x,f7.4,2x,f7.4,2x,f7.4,2x,f7.4,2x,f7.4,2x,f7.4                  &
     &,2x,f7.4,2x,f7.4)                                                 
 4018 FORMAT(F12.6) 
 4020 FORMAT(F10.8) 
 4021 FORMAT(F10.8) 
!                                                                       
!                                                                       
  110 continue 
  578 continue 
!                                                                       
!                                                                       
      if(iend.eq.1)goto 999 

      itime = itimeh
      goto 9999 
                                                                        
!                                                                       
  999 continue 
!...Ausschreiben der Min/Max-Blöcke zur grafischen Darstellung in Gerris
!                                                                       
      do 211 azStr = 1,azStrs 
      mstr = mstra(azStr) 
!                                                                       
      if(Ymin(mstr,20).gt.0.0)Ymin(mstr,20) = Ymin(mstr,20)*1000. 
!                                                                       
      do 210 iior=1,mStas(mstr) 
!                                                                       
      write(155,'(a7,14x,I5,2x,F8.3,2x,i5)')cmin,mstr                   &
     &,Stakm(mstr,iior),STRID(mstr)                                     
      write(155,5105)Ymin(mstr,1),Ymin(mstr,2),Ymin(mstr,3)             &
     &,Ymin(mstr,4),Ymin(mstr,5),Ymin(mstr,6)                           &
     &,Ymin(mstr,7),Ymin(mstr,8),Ymin(mstr,9)                           &
     &,Ymin(mstr,10),Ymin(mstr,11),Ymin(mstr,12)                        &
     &,Ymin(mstr,13),Ymin(mstr,14),Ymin(mstr,15)                        &
     &,Ymin(mstr,16),Ymin(mstr,17),Ymin(mstr,18)                        &
     &,Ymin(mstr,20),Ymin(mstr,19),Ymin(mstr,21),Ymin(mstr,22)          &
     &,Ymin(mstr,169)                                                   
!                                                                       
      write(155,5205)(Ymin(mstr,104)*hcUmt)                             &
     &,(Ymin(mstr,93)*4.33*hcUmt)                                       &
     &,(Ymin(mstr,108)*hcUmt),(Ymin(mstr,102)*hcUmt)                    &
     &,(Ymin(mstr,112)*hcUmt),(Ymin(mstr,105)*hcUmt)                    &
     &,(Ymin(mstr,94)*hcUmt)                                            
!                                                                       
      write(155,5115)Ymin(mstr,115),Ymin(mstr,116),Ymin(mstr,117)       &
     &,Ymin(mstr,118),Ymin(mstr,119),Ymin(mstr,120)                     &
     &,Ymin(mstr,121),Ymin(mstr,122),Ymin(mstr,123)                     &
     &,Ymin(mstr,124),Ymin(mstr,125),Ymin(mstr,126)                     &
     &,Ymin(mstr,127),Ymin(mstr,128),Ymin(mstr,129)                     &
     &,Ymin(mstr,130),Ymin(mstr,131),Ymin(mstr,132)                     &
     &,Ymin(mstr,133),Ymin(mstr,171),Ymin(mstr,168)                     &
     &,Ymin(mstr,170)                                                   
!                                                                       
      write(45,'(a7,7x,I5,2x,F8.3,2x,i5)')cmin,mstr                     &
     &,Stakm(mstr,iior),STRID(mstr)                                     
      write(45,4103)Ymin(mstr,1),Ymin(mstr,1),Ymin(mstr,1)              &
     &,Ymin(mstr,2),Ymin(mstr,2),Ymin(mstr,2)                           &
     &,Ymin(mstr,3),Ymin(mstr,3),Ymin(mstr,3)                           &
     &,Ymin(mstr,4),Ymin(mstr,4),Ymin(mstr,4)                           &
     &,Ymin(mstr,5),Ymin(mstr,5),Ymin(mstr,5)                           &
     &,Ymin(mstr,6),Ymin(mstr,6),Ymin(mstr,6)                           &
     &,Ymin(mstr,7),Ymin(mstr,7),Ymin(mstr,7)                           &
     &,Ymin(mstr,8),Ymin(mstr,8),Ymin(mstr,8)                           &
     &,Ymin(mstr,9),Ymin(mstr,9),Ymin(mstr,9)                           &
     &,Ymin(mstr,10),Ymin(mstr,10),Ymin(mstr,10)                        &
     &,Ymin(mstr,11),Ymin(mstr,11),Ymin(mstr,11)                        &
     &,Ymin(mstr,12),Ymin(mstr,12),Ymin(mstr,12)                        &
     &,Ymin(mstr,13),Ymin(mstr,13),Ymin(mstr,13)                        &
     &,Ymin(mstr,14),Ymin(mstr,14),Ymin(mstr,14)                        &
     &,Ymin(mstr,15),Ymin(mstr,15),Ymin(mstr,15)                        &
     &,Ymin(mstr,16),Ymin(mstr,16),Ymin(mstr,16)                        &
     &,Ymin(mstr,17),Ymin(mstr,17),Ymin(mstr,17)                        &
     &,Ymin(mstr,18),Ymin(mstr,18),Ymin(mstr,18)                        &
     &,Ymin(mstr,19),Ymin(mstr,19),Ymin(mstr,19)                        
!                                                                       
      write(45,4001)Ymin(mstr,23) 
!                                                                       
      write(45,4002)Ymin(mstr,24) 
!                                                                       
      write(45,4365)Ymin(mstr,25),Ymin(mstr,26),Ymin(mstr,27)           &
     &,Ymin(mstr,28),Ymin(mstr,29),Ymin(mstr,30)                        &
     &,Ymin(mstr,31),Ymin(mstr,32),Ymin(mstr,33)                        &
     &,Ymin(mstr,34),Ymin(mstr,35),Ymin(mstr,36)                        &
     &,Ymin(mstr,37),Ymin(mstr,38),Ymin(mstr,39)                        &
     &,Ymin(mstr,40),Ymin(mstr,41)                                      
!                                                                       
      write(45,4004)Ymin(mstr,42),Ymin(mstr,43) 
!                                                                       
      write(45,4010)Ymin(mstr,44),Ymin(mstr,45),Ymin(mstr,46)           &
     &,Ymin(mstr,47),Ymin(mstr,48),Ymin(mstr,49)                        &
     &,Ymin(mstr,50),Ymin(mstr,51),Ymin(mstr,52)                        &
     &,Ymin(mstr,53),Ymin(mstr,54),Ymin(mstr,55)                        &
     &,Ymin(mstr,56),Ymin(mstr,57),Ymin(mstr,58)                        &
     &,Ymin(mstr,59),Ymin(mstr,60),Ymin(mstr,61)                        &
     &,Ymin(mstr,62),Ymin(mstr,63),Ymin(mstr,64)                        &
     &,Ymin(mstr,65),Ymin(mstr,66),Ymin(mstr,67)                        &
     &,Ymin(mstr,68),Ymin(mstr,69),Ymin(mstr,70)                        
!                                                                       
      write(45,4265)Ymin(mstr,71),Ymin(mstr,72),Ymin(mstr,73)           &
     &,Ymin(mstr,74)                                                    
!                                                                       
      write(45,4111)Ymin(mstr,75),Ymin(mstr,76),Ymin(mstr,77)           &
     &,Ymin(mstr,78),Ymin(mstr,79),Ymin(mstr,80)                        &
     &,Ymin(mstr,81),Ymin(mstr,82),Ymin(mstr,83)                        &
     &,(Ymin(mstr,84)*24.)                                              
!                                                                       
      write(45,4215)Ymin(mstr,85),Ymin(mstr,20),Ymin(mstr,86)           &
     &,Ymin(mstr,87),Ymin(mstr,88),Ymin(mstr,89)                        &
     &,Ymin(mstr,90),Ymin(mstr,91),Ymin(mstr,92)                        
!                                                                       
      write(45,4003)Ymin(mstr,93),Ymin(mstr,94),Ymin(mstr,95)           &
     &,Ymin(mstr,96),Ymin(mstr,174),Ymin(mstr,97),Ymin(mstr,175)        &
     &,Ymin(mstr,177),Ymin(mstr,98),Ymin(mstr,99),Ymin(mstr,100)        
!                                                                       
      write(45,4020)Ymin(mstr,179) 
!                                                                       
      write(45,4017)Ymin(mstr,101),Ymin(mstr,102),Ymin(mstr,103)        &
     &,Ymin(mstr,104),Ymin(mstr,105),Ymin(mstr,181)                     &
     &,Ymin(mstr,107),Ymin(mstr,108),Ymin(mstr,109)                     &
     &,Ymin(mstr,110),Ymin(mstr,111),Ymin(mstr,112)                     &
     &,Ymin(mstr,113),Ymin(mstr,114)                                    
!                                                                       
      write(45,4018)Ymin(mstr,22) 
!                                                                       
      write(45,4103)Ymin(mstr,115),Ymin(mstr,115),Ymin(mstr,115)        &
     &,Ymin(mstr,116),Ymin(mstr,116),Ymin(mstr,116)                     &
     &,Ymin(mstr,117),Ymin(mstr,117),Ymin(mstr,117)                     &
     &,Ymin(mstr,118),Ymin(mstr,118),Ymin(mstr,118)                     &
     &,Ymin(mstr,119),Ymin(mstr,119),Ymin(mstr,119)                     &
     &,Ymin(mstr,120),Ymin(mstr,120),Ymin(mstr,120)                     &
     &,Ymin(mstr,121),Ymin(mstr,121),Ymin(mstr,121)                     &
     &,Ymin(mstr,122),Ymin(mstr,122),Ymin(mstr,122)                     &
     &,Ymin(mstr,123),Ymin(mstr,123),Ymin(mstr,123)                     &
     &,Ymin(mstr,124),Ymin(mstr,124),Ymin(mstr,124)                     &
     &,Ymin(mstr,125),Ymin(mstr,125),Ymin(mstr,125)                     &
     &,Ymin(mstr,126),Ymin(mstr,126),Ymin(mstr,126)                     &
     &,Ymin(mstr,127),Ymin(mstr,127),Ymin(mstr,127)                     &
     &,Ymin(mstr,128),Ymin(mstr,128),Ymin(mstr,128)                     &
     &,Ymin(mstr,129),Ymin(mstr,129),Ymin(mstr,129)                     &
     &,Ymin(mstr,130),Ymin(mstr,130),Ymin(mstr,130)                     &
     &,Ymin(mstr,131),Ymin(mstr,131),Ymin(mstr,131)                     &
     &,Ymin(mstr,132),Ymin(mstr,132),Ymin(mstr,132)                     &
     &,Ymin(mstr,133),Ymin(mstr,133),Ymin(mstr,133)                     
!                                                                       
      write(45,4010)Ymin(mstr,134),Ymin(mstr,135),Ymin(mstr,136)        &
     &,Ymin(mstr,137),Ymin(mstr,138),Ymin(mstr,139)                     &
     &,Ymin(mstr,140),Ymin(mstr,141),Ymin(mstr,142)                     &
     &,Ymin(mstr,143),Ymin(mstr,144),Ymin(mstr,145)                     &
     &,Ymin(mstr,146),Ymin(mstr,147),Ymin(mstr,148)                     &
     &,Ymin(mstr,149),Ymin(mstr,150),Ymin(mstr,151)                     &
     &,Ymin(mstr,152),Ymin(mstr,153),Ymin(mstr,154)                     &
     &,Ymin(mstr,155),Ymin(mstr,156),Ymin(mstr,157)                     &
     &,Ymin(mstr,158),Ymin(mstr,159),Ymin(mstr,160)                     
!                                                                       
      write(45,4011)Ymin(mstr,106),Ymin(mstr,176),Ymin(mstr,178)        &
     &,Ymin(mstr,173)                                                   
!                                                                       
      write(45,4020)Ymin(mstr,180) 
      write(45,4021)Ymin(mstr,182) 
!                                                                       
!                                                                       
  210 continue 
  211 continue 
      do 312 azStr = 1,azStrs 
      mstr = mstra(azStr) 
!                                                                       
      if(Ymax(mstr,20).gt.0.0)Ymax(mstr,20) = Ymax(mstr,20)*1000. 
!                                                                       
      do 313 iior=1,mStas(mstr) 
!                                                                       
      write(155,'(a7,14x,I5,2x,F8.3,2x,i5)')cmax,mstr                   &
     &,Stakm(mstr,iior),STRID(mstr)                                     
      write(155,5105)Ymax(mstr,1),Ymax(mstr,2),Ymax(mstr,3)             &
     &,Ymax(mstr,4),Ymax(mstr,5),Ymax(mstr,6)                           &
     &,Ymax(mstr,7),Ymax(mstr,8),Ymax(mstr,9)                           &
     &,Ymax(mstr,10),Ymax(mstr,11),Ymax(mstr,12)                        &
     &,Ymax(mstr,13),Ymax(mstr,14),Ymax(mstr,15)                        &
     &,Ymax(mstr,16),Ymax(mstr,17),Ymax(mstr,18)                        &
     &,Ymax(mstr,20),Ymax(mstr,19),Ymax(mstr,21),Ymax(mstr,22)          &
     &,Ymax(mstr,169)                                                   
!                                                                       
      write(155,5205)(Ymax(mstr,104)*hcUmt)                             &
     &,(Ymax(mstr,93)*4.33*hcUmt)                                       &
     &,(Ymax(mstr,108)*hcUmt),(Ymax(mstr,102)*hcUmt)                    &
     &,(Ymax(mstr,112)*hcUmt),(Ymax(mstr,105)*hcUmt)                    &
     &,(Ymax(mstr,94)*hcUmt)                                            
!                                                                       
      write(155,5115)Ymax(mstr,115),Ymax(mstr,116),Ymax(mstr,117)       &
     &,Ymax(mstr,118),Ymax(mstr,119),Ymax(mstr,120)                     &
     &,Ymax(mstr,121),Ymax(mstr,122),Ymax(mstr,123)                     &
     &,Ymax(mstr,124),Ymax(mstr,125),Ymax(mstr,126)                     &
     &,Ymax(mstr,127),Ymax(mstr,128),Ymax(mstr,129)                     &
     &,Ymax(mstr,130),Ymax(mstr,131),Ymax(mstr,132)                     &
     &,Ymax(mstr,133),Ymax(mstr,171),Ymax(mstr,168)                     &
     &,Ymax(mstr,170)                                                   
!                                                                       
      write(45,'(a7,7x,I5,2x,F8.3,2x,i5)')cmax,mstr                     &
     &,Stakm(mstr,iior),STRID(mstr)                                     
      write(45,4103)Ymax(mstr,1),Ymax(mstr,1),Ymax(mstr,1)              &
     &,Ymax(mstr,2),Ymax(mstr,2),Ymax(mstr,2)                           &
     &,Ymax(mstr,3),Ymax(mstr,3),Ymax(mstr,3)                           &
     &,Ymax(mstr,4),Ymax(mstr,4),Ymax(mstr,4)                           &
     &,Ymax(mstr,5),Ymax(mstr,5),Ymax(mstr,5)                           &
     &,Ymax(mstr,6),Ymax(mstr,6),Ymax(mstr,6)                           &
     &,Ymax(mstr,7),Ymax(mstr,7),Ymax(mstr,7)                           &
     &,Ymax(mstr,8),Ymax(mstr,8),Ymax(mstr,8)                           &
     &,Ymax(mstr,9),Ymax(mstr,9),Ymax(mstr,9)                           &
     &,Ymax(mstr,10),Ymax(mstr,10),Ymax(mstr,10)                        &
     &,Ymax(mstr,11),Ymax(mstr,11),Ymax(mstr,11)                        &
     &,Ymax(mstr,12),Ymax(mstr,12),Ymax(mstr,12)                        &
     &,Ymax(mstr,13),Ymax(mstr,13),Ymax(mstr,13)                        &
     &,Ymax(mstr,14),Ymax(mstr,14),Ymax(mstr,14)                        &
     &,Ymax(mstr,15),Ymax(mstr,15),Ymax(mstr,15)                        &
     &,Ymax(mstr,16),Ymax(mstr,16),Ymax(mstr,16)                        &
     &,Ymax(mstr,17),Ymax(mstr,17),Ymax(mstr,17)                        &
     &,Ymax(mstr,18),Ymax(mstr,18),Ymax(mstr,18)                        &
     &,Ymax(mstr,19),Ymax(mstr,19),Ymax(mstr,19)                        
!                                                                       
      write(45,4001)Ymax(mstr,23) 
!                                                                       
      write(45,4002)Ymax(mstr,24) 
!                                                                       
      write(45,4365)Ymax(mstr,25),Ymax(mstr,26),Ymax(mstr,27)           &
     &,Ymax(mstr,28),Ymax(mstr,29),Ymax(mstr,30)                        &
     &,Ymax(mstr,31),Ymax(mstr,32),Ymax(mstr,33)                        &
     &,Ymax(mstr,34),Ymax(mstr,35),Ymax(mstr,36)                        &
     &,Ymax(mstr,37),Ymax(mstr,38),Ymax(mstr,39)                        &
     &,Ymax(mstr,40),Ymax(mstr,41)                                      
!                                                                       
      write(45,4004)Ymax(mstr,42),Ymax(mstr,43) 
!                                                                       
      write(45,4010)Ymax(mstr,44),Ymax(mstr,45),Ymax(mstr,46)           &
     &,Ymax(mstr,47),Ymax(mstr,48),Ymax(mstr,49)                        &
     &,Ymax(mstr,50),Ymax(mstr,51),Ymax(mstr,52)                        &
     &,Ymax(mstr,53),Ymax(mstr,54),Ymax(mstr,55)                        &
     &,Ymax(mstr,56),Ymax(mstr,57),Ymax(mstr,58)                        &
     &,Ymax(mstr,59),Ymax(mstr,60),Ymax(mstr,61)                        &
     &,Ymax(mstr,62),Ymax(mstr,63),Ymax(mstr,64)                        &
     &,Ymax(mstr,65),Ymax(mstr,66),Ymax(mstr,67)                        &
     &,Ymax(mstr,68),Ymax(mstr,69),Ymax(mstr,70)                        
!                                                                       
      write(45,4265)Ymax(mstr,71),Ymax(mstr,72),Ymax(mstr,73)           &
     &,Ymax(mstr,74)                                                    
!                                                                       
      write(45,4111)Ymax(mstr,75),Ymax(mstr,76),Ymax(mstr,77)           &
     &,Ymax(mstr,78),Ymax(mstr,79),Ymax(mstr,80)                        &
     &,Ymax(mstr,81),Ymax(mstr,82),Ymax(mstr,83)                        &
     &,(Ymax(mstr,84)*24.)                                              
!                                                                       
      write(45,4215)Ymax(mstr,85),Ymax(mstr,20),Ymax(mstr,86)           &
     &,Ymax(mstr,87),Ymax(mstr,88),Ymax(mstr,89)                        &
     &,Ymax(mstr,90),Ymax(mstr,91),Ymax(mstr,92)                        
!                                                                       
      write(45,4003)Ymax(mstr,93),Ymax(mstr,94),Ymax(mstr,95)           &
     &,Ymax(mstr,96),Ymax(mstr,174),Ymax(mstr,97),Ymax(mstr,175)        &
     &,Ymax(mstr,177),Ymax(mstr,98),Ymax(mstr,99),Ymax(mstr,100)        
!                                                                       
      write(45,4020)Ymax(mstr,179) 
!                                                                       
      write(45,4017)Ymax(mstr,101),Ymax(mstr,102),Ymax(mstr,103)        &
     &,Ymax(mstr,104),Ymax(mstr,105),Ymax(mstr,181)                     &
     &,Ymax(mstr,107),Ymax(mstr,108),Ymax(mstr,109)                     &
     &,Ymax(mstr,110),Ymax(mstr,111),Ymax(mstr,112)                     &
     &,Ymax(mstr,113),Ymax(mstr,114)                                    
!                                                                       
      write(45,4018)Ymax(mstr,22) 
!                                                                       
      write(45,4103)Ymax(mstr,115),Ymax(mstr,115),Ymax(mstr,115)        &
     &,Ymax(mstr,116),Ymax(mstr,116),Ymax(mstr,116)                     &
     &,Ymax(mstr,117),Ymax(mstr,117),Ymax(mstr,117)                     &
     &,Ymax(mstr,118),Ymax(mstr,118),Ymax(mstr,118)                     &
     &,Ymax(mstr,119),Ymax(mstr,119),Ymax(mstr,119)                     &
     &,Ymax(mstr,120),Ymax(mstr,120),Ymax(mstr,120)                     &
     &,Ymax(mstr,121),Ymax(mstr,121),Ymax(mstr,121)                     &
     &,Ymax(mstr,122),Ymax(mstr,122),Ymax(mstr,122)                     &
     &,Ymax(mstr,123),Ymax(mstr,123),Ymax(mstr,123)                     &
     &,Ymax(mstr,124),Ymax(mstr,124),Ymax(mstr,124)                     &
     &,Ymax(mstr,125),Ymax(mstr,125),Ymax(mstr,125)                     &
     &,Ymax(mstr,126),Ymax(mstr,126),Ymax(mstr,126)                     &
     &,Ymax(mstr,127),Ymax(mstr,127),Ymax(mstr,127)                     &
     &,Ymax(mstr,128),Ymax(mstr,128),Ymax(mstr,128)                     &
     &,Ymax(mstr,129),Ymax(mstr,129),Ymax(mstr,129)                     &
     &,Ymax(mstr,130),Ymax(mstr,130),Ymax(mstr,130)                     &
     &,Ymax(mstr,131),Ymax(mstr,131),Ymax(mstr,131)                     &
     &,Ymax(mstr,132),Ymax(mstr,132),Ymax(mstr,132)                     &
     &,Ymax(mstr,133),Ymax(mstr,133),Ymax(mstr,133)                     
!                                                                       
      write(45,4010)Ymax(mstr,134),Ymax(mstr,135),Ymax(mstr,136)        &
     &,Ymax(mstr,137),Ymax(mstr,138),Ymax(mstr,139)                     &
     &,Ymax(mstr,140),Ymax(mstr,141),Ymax(mstr,142)                     &
     &,Ymax(mstr,143),Ymax(mstr,144),Ymax(mstr,145)                     &
     &,Ymax(mstr,146),Ymax(mstr,147),Ymax(mstr,148)                     &
     &,Ymax(mstr,149),Ymax(mstr,150),Ymax(mstr,151)                     &
     &,Ymax(mstr,152),Ymax(mstr,153),Ymax(mstr,154)                     &
     &,Ymax(mstr,155),Ymax(mstr,156),Ymax(mstr,157)                     &
     &,Ymax(mstr,158),Ymax(mstr,159),Ymax(mstr,160)                     
!                                                                       
      write(45,4011)Ymax(mstr,106),Ymax(mstr,176),Ymax(mstr,178)        &
     &,Ymax(mstr,173)                                                   
!                                                                       
      write(45,4020)Ymax(mstr,180) 
      write(45,4021)Ymax(mstr,182) 
!                                                                       
  313 continue 
  312 continue 
!                                                                       
      if(i2Daus.eq.0)goto 989 
!                                                                       
!   Ausgabe der min/max-Werte bei 2D-Modellierung                       
!                                                                       
      ztiefa = -1. 
      do 511 azStr = 1,azStrs 
      mstr = mstra(azStr) 
!                                                                       
      do 512 iior=1,mStas(mstr) 
      write(255,'(a7,14x,I5,2x,f8.3,2x,I2,2x,I2,2x,i5)')cmin,mstr       &
     &,Stakm(mstr,iior),nkzmx(mstr,iior),nkzmx(mstr,iior)               &
     &,STRID(mstr)                                                      
      do 513 nkz = 1,nkzmx(mstr,iior) 
      write(255,5107)ztiefa,Ymin(mstr,161),Ymin(mstr,162)               &
     &,Ymin(mstr,163),Ymin(mstr,164),Ymin(mstr,165)                     &
     &,Ymin(mstr,166),Ymin(mstr,167),Ymin(mstr,172)                     
  513 continue 
!                                                                       
  512 continue 
  511 continue 
!                                                                       
!                                                                       
      do 514 azStr = 1,azStrs 
      mstr = mstra(azStr) 
!                                                                       
      do 515 iior=1,mStas(mstr) 
      write(255,'(a7,14x,I5,2x,f8.3,2x,I2,2x,I2,2x,I5)')cmax,mstr       &
     &,Stakm(mstr,iior),nkzmx(mstr,iior),nkzmx(mstr,iior)               &
     &,STRID(mstr)                                                      
      do 516 nkz = 1,nkzmx(mstr,iior) 
      write(255,5107)ztiefa,Ymax(mstr,161),Ymax(mstr,162)               &
     &,Ymax(mstr,163),Ymax(mstr,164),Ymax(mstr,165)                     &
     &,Ymax(mstr,166),Ymax(mstr,167),Ymax(mstr,172)                     
  516 continue 
!                                                                       
  515 continue 
  514 continue 
!                                                                       
!                                                                       
!*****************                                                      
!   Fehlerausgabe                                                       
!*****************                                                      
  989 continue 
      if(ifehl.eq.0)goto 990 
      i = 0 
      open(unit=599, DEFAULTFILE='/GERRIS/QSIM/',                       &
     &file='Fehlermeldungen.txt')                                       
       rewind(599) 
  991 i =i+1 
      read(599,'(a120)')cfehlr 
      if(i.ne.ifehl)goto 991 
      if(ifhStr.gt.0.and.fhprof.gt.0.0)then 
         write(199,'(a120,2x,i3,5x,f8.2)')cfehlr,ifhStr,fhprof 
          goto 990 
      endif 
      if(ifhStr.gt.0.and.fhprof.eq.0.0)then 
         write(199,'(a120,2x,i3)')cfehlr,ifhStr 
          goto 990 
      endif 
      write(199,'(120a)')cfehlr 
!                                                                       
  990 close (45) 
      close (155) 
      close (255) 
      close (199) 
      if(iRHKW.eq.1)close (177) 
      if(ifehl.ne.0)then 
      stop 1 
        else 
         stop 0 
      endif 
!                                                                       
      END                                           
